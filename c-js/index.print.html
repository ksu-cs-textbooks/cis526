<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Bringing interaction to web pages since 1995."><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="JavaScript :: CIS 526 Textbook"><meta name=twitter:description content="Bringing interaction to web pages since 1995."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/c-js/"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="JavaScript :: CIS 526 Textbook"><meta property="og:description" content="Bringing interaction to web pages since 1995."><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta itemprop=name content="JavaScript :: CIS 526 Textbook"><meta itemprop=description content="Bringing interaction to web pages since 1995."><meta itemprop=datePublished content="2018-08-24T10:53:05-05:00"><meta itemprop=dateModified content="2023-08-10T16:48:12-05:00"><meta itemprop=wordCount content="7"><title>JavaScript :: CIS 526 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis526/c-js/ rel=canonical type=text/html title="JavaScript :: CIS 526 Textbook"><link href=/cis526/c-js/index.xml rel=alternate type=application/rss+xml title="JavaScript :: CIS 526 Textbook"><link href=/cis526/c-js/tele.html rel=alternate type=text/html title="JavaScript :: CIS 526 Textbook"><link href=/cis526/c-js/embed.html rel=alternate type=text/html title="JavaScript :: CIS 526 Textbook"><link href=/cis526/css/fontawesome-all.min.css?1739565344 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fontawesome-all.min.css?1739565344 rel=stylesheet></noscript><link href=/cis526/css/nucleus.css?1739565344 rel=stylesheet><link href=/cis526/css/auto-complete.css?1739565344 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/auto-complete.css?1739565344 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar.min.css?1739565344 rel=stylesheet><link href=/cis526/css/fonts.css?1739565344 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fonts.css?1739565344 rel=stylesheet></noscript><link href=/cis526/css/theme.css?1739565344 rel=stylesheet><link href=/cis526/css/theme-auto.css?1739565344 rel=stylesheet id=R-variant-style><link href=/cis526/css/chroma-auto.css?1739565344 rel=stylesheet id=R-variant-chroma-style><link href=/cis526/css/variant.css?1739565344 rel=stylesheet><link href=/cis526/css/print.css?1739565344 rel=stylesheet media=print><link href=/cis526/css/format-print.css?1739565344 rel=stylesheet><script src=/cis526/js/variant.js?1739565344></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="..",window.relearn.relBaseUri="../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.index_js_url="/cis526/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis526/css/custom.css?1739565344 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis526/c-js/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>JavaScript</span><meta itemprop=position content="1"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/b-css/14-responsive-web-design/ title="Responsive Web Design (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/c-js/01-introduction/ title="Introduction (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable chapter narrow" tabindex=-1><div class=flex-block-wrapper><article class=chapter><header class=headline></header><div class=article-subheading>Chapter C</div><h1 id=javascript>JavaScript</h1><p>Bringing interaction to web pages since 1995.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of JavaScript</h1><article class=default><header class=headline></header><h1 id=introduction>Introduction</h1><p>As the World Wide Web was gaining popularity in the mid-nineties, browser manufacturers started experimenting with interpreting program scripts embedded within webpages. By far the most successful of these was JavaScript, initally developed by Brandon Eich for Netscape.</p><p><a href=#R-image-0c130d8607f630558f3911b1c5ea3f81 class=lightbox-link><img alt="Brandon Eich" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis526/images/Brendan_Eich.jpg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0c130d8607f630558f3911b1c5ea3f81><img alt="Brandon Eich" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis526/images/Brendan_Eich.jpg></a></p><p>Brandon Eich was hired to integrate the <a href=https://en.wikipedia.org/wiki/Scheme_(programming_language) rel=external target=_blank>Scheme programming langauge</a> into the Netscape browser. But when Netscape cut a deal with Sun Microsystems to bring Java Applets to their browser, his mission was altered to create a more Java-like langauge. He developed a prototype in only ten days, that blended <a href=https://en.wikipedia.org/wiki/Java_(programming_language) rel=external target=_blank>Java</a> syntax, the <a href=https://en.wikipedia.org/wiki/Self_(programming_language) rel=external target=_blank>Self</a> object-orientation approach, and <a href=https://en.wikipedia.org/wiki/Scheme_(programming_language) rel=external target=_blank>Scheme</a> functionality.</p><p>Netscape eventually submitted JavaScript to <a href=https://en.wikipedia.org/wiki/Ecma_International rel=external target=_blank>ECMA International</a>, resulting in the ECMAScript standard, and opening the door for other browsers to adopt JavaScript. Currently all major browsers support the full ECMAScript 5 standard, and large chunks of ECMAScript 6 and some parts of later versions as well. Moreover, <em>transpilation</em> can be utilized to make newer ECMAScript-compliant code run on older browser versions.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>The ECMA standard is maintained by <a href=https://www.ecma-international.org/ rel=external target=_blank>ECMA International</a>, not the W3C. However, its development process is very similar, involving stakeholders developing proposals for new and improved features.</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=basic-syntax>Basic Syntax</h1><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><p>Because Netscape was adopting Java at the same time they were developing what would become JavaScript, there was a push to make the syntax stay somewhat consistent between the two languages. As a result, JavaScript has much of the look and feel of an imperative language like C, C#, or Java.</p><p>However, this similarity can be deceptive, because how JavaScript operates can be quite different than those languages. This can lead to frustration for imperative programmers learning JavaScript. As we go over the basics of the language, I will strive to call out these tricky differences.</p><p>To assist you in learning JavaScript syntax, we&rsquo;ve added an interactive console to this textbook where you can type in arbitrary JavaScript code and see the result of its execution, much like the console that Developer Tools provide. You can click the word &ldquo;Console&rdquo; on the purple tab below to expand it, and click it again to minimize it.</p><h2 id=interpreted-language>Interpreted Language</h2><p>JavaScript is an interpreted language, which means instead of being compiled into machine code, it is interpreted by a special program - an interpreter. Each browser has its own interpreter implementation.</p><p>Let&rsquo;s start with a traditional example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;hello world&#34;</span><span class=p>);</span></span></span></code></pre></div><p>Copy/paste or type this code into the console provided at the bottom of the page. What is the output?</p><p>As you might expect, this prints the string &ldquo;hello world&rdquo; to standard output. Notice we didn&rsquo;t need to put this code into a <code>main</code> function - JavaScript code is executed as it is encountered by the interpreter.</p><h2 id=terminating-lines-of-code>Terminating Lines of Code</h2><p>Also, the semicolon is an optional way to end an expression. A new line is other way to do so, so these two programs:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Hello&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;World&#34;</span><span class=p>)</span></span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Hello&#34;</span><span class=p>);</span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;World&#34;</span><span class=p>);</span></span></span></code></pre></div><p>are equivalent. We can also use both a semicolon and a new line (as in the first example). A common technique for making JavaScript files smaller, known as <em>minifying</em> takes advantage of this fact to write an entire program in a single line! We&rsquo;ll discuss how and when to do so later.</p><h2 id=data-types>Data Types</h2><p>Like any programming language, JavaScript has a number of predefined data types. We can also query the data type of a value at runtime, using the <code>typeof</code> keyword. Try typing some of these lines into the console:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>typeof</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typeof</span> <span class=mf>1.3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typeof</span> <span class=s2>&#34;Hello&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>typeof</span> <span class=kc>true</span><span class=p>;</span></span></span></code></pre></div><h3 id=numbers>Numbers</h3><p>Numbers include integers and floats, though JavaScript mostly uses the distinction for how a value is stored in memory and presents the programmer with the <code>number</code> type. This category also includes some special values, like <code>NaN</code> (not a number) and <code>Infinity</code>. We can perform all the standard arithmetic operations on any number (<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>).<br>These operations are also &ldquo;safe&rdquo; in the sense that they will not throw an error. For example, try typing <code>4/0</code> in the terminal below. The value you see as a result is still a number!</p><p>The JavaScript interpreter will switch between an integer and float representation internally as it makes sense to. For example, type <code>4.0</code> and you&rsquo;ll see the console echoes <code>4</code> to you, showing it is storing the number as an integer. Try typing <code>4.1</code>, and you&rsquo;ll see it stores it as a float.</p><h3 id=strings>Strings</h3><p>The <code>string</code> type in JavaScript can be declared literally using single (<code>'</code>) or double (<code>"</code>) quotes, and as of ES6, tick marks (<code>`</code>).</p><p>Double and single-quoted strings work exactly the same. They must be on the same line, though you can add newline characters to both using <code>\n</code>. The backslash is used as an escape character, so to include it in a string you must use a double-backslash instead <code>\\</code>. Finally, in a single-quoted string you can escape a single quote, i.e. <code>'Bob\'s Diner'</code>, and similarly for double-quotes: <code>"\"That's funny,\" she said."</code> Judicious choices of single-or double-quoted strings can avoid much of this complication.</p><p>You can also directly reference unicode characters with <code>\u[ref number]</code>. Try typing the sequence <code>"\u1F63C"</code>.</p><p>Finally, strings enclosed with tick marks (<code>`</code>) are <em>template literals</em> that have a few special properties. First, they can span multiple lines, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sb>`This is a 
</span></span></span><span class=line><span class=cl><span class=sb>multiline string
</span></span></span><span class=line><span class=cl><span class=sb>example`</span></span></span></code></pre></div><p>The line breaks will be interpreted as new line characters. Secondly, you can embed arbitrary JavaScript inside of them using <code>${}</code>. Give it a try:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sb>`The sum of 2 and 3 is </span><span class=si>${</span><span class=mi>2</span> <span class=o>+</span> <span class=mi>3</span><span class=si>}</span><span class=sb>`</span></span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>In JavaScript there is no character type. In practice, the role characters normally play in programs is filled by strings of length one.</p></div></div><h3 id=booleans>Booleans</h3><p>JavaScript also has the boolean literals <code>true</code> and <code>false</code>. It also implements the boolean logical operators <code>&&</code> (logical and) <code>||</code> (logical or), and <code>!</code> (logical not).</p><h3 id=undefined>Undefined</h3><p>JavaScript has a special value <code>undefined</code> that means a value hasn&rsquo;t been set. You probably saw it when you entered the <code>console.log("Hello World")</code> example above, which spit out:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-tex data-lang=tex><span class=line><span class=cl>&gt; Hello World!
</span></span><span class=line><span class=cl>&gt; undefined</span></span></code></pre></div><p>As the console echoes the value of the prior line, it was printing the return value of <code>console.log()</code>. Since <code>console.log()</code> doesn&rsquo;t return a value, this results in <code>undefined</code>.</p><h3 id=null>Null</h3><p>JavaScript also defines a <code>null</code> type, even though <code>undefined</code> fills many of the roles <code>null</code> fills in other languages. However, the programmer must explicitly supply a <code>null</code> value. So if a variable is <code>null</code>, you know it was done <em>intentionally</em>, if it is <code>undefined</code>, it may be that it was accidentally not initialized.</p><h3 id=objects>Objects</h3><p>The <code>object</code> type is used to store more than one value, and functions much like a dictionary in other languages. Objects can be declared literally with curly braces, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>first</span><span class=o>:</span> <span class=s2>&#34;Jim&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>last</span><span class=o>:</span> <span class=s2>&#34;Hawkins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>An object is essentially a collection of key/value pairs, known as <strong>properties</strong>. We&rsquo;ll discuss objects in more depth in the <a href=https://textbooks.cs.ksu.edu/cis526/c-js/05-objects-and-classes/ rel=external target=_blank>Objects and Classes</a> section.</p><h3 id=symbols>Symbols</h3><p>Finally, the <code>symbol</code> type is a kind of identifier. We&rsquo;ll discuss it more later.</p><h2 id=variables>Variables</h2><p>JavaScript uses <em>dynamic typing</em>. This means the type of a variable is not declared in source code, rather it is determined at runtime. Thus, all variables in JavaScript are declared with the <code>var</code> keyword, regardless of type:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=s2>&#34;A string&#34;</span><span class=p>;</span>  <span class=c1>// A string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>           <span class=c1>// A number
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=nx>c</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>        <span class=c1>// A boolean
</span></span></span></code></pre></div><p>In addition, the type of a variable can be changed at any point in the code, i.e. the statements:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=s2>&#34;A string&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>a</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span> 
</span></span></code></pre></div><p>is perfectly legal and workable. The type of <code>a</code>, changes from a string to a float when its value is changed.</p><p>In addition to the <code>var</code> keyword, constants are declared with <code>const</code>. Constants must have a value assigned with their declaration and cannot be changed.</p><p>Finally, ECMA6 introduced the <code>let</code> keyword, which operates similar to <code>var</code> but is locally scoped (see the discussion of functional scope for details).</p><h2 id=type-conversions>Type Conversions</h2><p>JavaScript does its best to use the specified variable, which may result in a type conversion. For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;foo&#34;</span> <span class=o>+</span> <span class=mi>3</span></span></span></code></pre></div><p>Will result in the string <code>'foo3'</code>, as the <code>+</code> operator means concatenation for strings. However, <code>/</code> has no override for strings, so</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;foo&#34;</span> <span class=o>/</span> <span class=mi>3</span></span></span></code></pre></div><p>Will result in <code>NaN</code> (not a number).</p><p>Additionally, when you attempt to use a different data type as a boolean, JavaScript will interpret its &rsquo;truthiness&rsquo;. The values <code>null</code>, <code>undefined</code>, and <code>0</code> are considered <code>false</code>. All other values will be interpreted as <code>true</code>.</p><h2 id=control-structures>Control Structures</h2><p>JavaScript implements many of the familiar control structures of conditionals and loops.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>Be aware that variables declared within a block of code using <code>var</code> are subject to function scope, and exist outside of the conditional branch/loop body. This can lead to unexpected behavior.</p></div></div><h3 id=if-else-statements>If Else Statements</h3><p>The JavaScript <code>if</code> and <code>if else</code> statements look just like their Java counterparts:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=o>&lt;</span><span class=nx>logical</span> <span class=nx>test</span><span class=o>&gt;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=kc>true</span> <span class=nx>branch</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=o>&lt;</span><span class=nx>logical</span> <span class=nx>test</span><span class=o>&gt;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=kc>true</span> <span class=nx>branch</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span>  <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=kc>false</span> <span class=nx>branch</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h3 id=loops>Loops</h3><p>As do <code>while</code> and <code>do while</code> loops:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>while</span><span class=p>(</span><span class=o>&lt;</span><span class=nx>logical</span> <span class=nx>test</span><span class=o>&gt;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=nx>loop</span> <span class=nx>body</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=nx>loop</span> <span class=nx>body</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}(</span><span class=o>&lt;</span><span class=nx>logical</span> <span class=nx>test</span><span class=o>&gt;</span><span class=p>);</span></span></span></code></pre></div><p>And <code>for</code> loops:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=o>&lt;</span><span class=nx>loop</span> <span class=nx>body</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>JavaScript also introduces a <code>for ... in</code> loop, which loops over properties within an object. I.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>jim</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>first</span><span class=o>:</span> <span class=s2>&#34;Jim&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>last</span><span class=o>:</span> <span class=s2>&#34;Hawkins&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nx>key</span> <span class=k>in</span> <span class=nx>jim</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`The property </span><span class=si>${</span><span class=nx>key</span><span class=si>}</span><span class=sb> has value </span><span class=si>${</span><span class=nx>jim</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>and the <code>for ... of</code> which does the same for arrays and other iterables:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fruits</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;apple&#34;</span><span class=p>,</span> <span class=s2>&#34;orange&#34;</span><span class=p>,</span> <span class=s2>&#34;pear&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nx>value</span> <span class=k>of</span> <span class=nx>fruits</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`The fruit is a </span><span class=si>${</span><span class=nx>value</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Try writing some control structures.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=javascript-functions>JavaScript Functions</h1><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><p>While JavaScript may look like an imperative language on the surface, much of how it behaves is based on <em>functional</em> languages like Scheme. This leads to some of the common sources of confusion for programmers new to the language. Let&rsquo;s explore just what its functional roots mean.</p><p>JavaScript implements <a href=https://en.wikipedia.org/wiki/First-class_function rel=external target=_blank>first-class functions</a>, which means they can be assigned to a variable, passed as function arguments, returned from other functions, and even nested inside other functions. Most of these uses are not possible in a traditional imperative language, though C# and Java have been adding more functional-type behavior.</p><h2 id=defining-functions>Defining Functions</h2><p>Functions in JavaScript are traditionally declared using the <code>function</code> keyword, followed by an identifier, followed by parenthesized arguments, and a body enclosed in curly braces, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>doSomething</span><span class=p>(</span><span class=nx>arg1</span><span class=p>,</span> <span class=nx>arg2</span><span class=p>,</span> <span class=nx>arg3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Do something here...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></div><p>Alternatively, the name can be omitted, resulting in an <em>anonymous</em> function:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=p>(</span><span class=nx>arg1</span><span class=p>,</span> <span class=nx>arg2</span><span class=p>,</span> <span class=nx>arg3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Do something here...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></div><p>Finally ES6 introduced the arrow function syntax, a more compact way of writing anonymous functions, similar to the lambda syntax of C#:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>(</span><span class=nx>arg1</span><span class=p>,</span> <span class=nx>arg2</span><span class=p>,</span> <span class=nx>arg3</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Do something here...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></div><p>However, arrow function syntax also has special implications for scope, which we will discuss shortly.</p><h2 id=invoking-functions>Invoking Functions</h2><p>Functions are invoked with a parenthetical set of arguments, i.e.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>sayHello</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Hello, </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Go ahead and define this function by typing the definition into your console.</p><p>Once you&rsquo;ve done so, it can be invoked with <code>sayHello("Bob")</code>, and would print <code>Hello, Bob</code> to the console. Give it a try:</p><iframe src=https://jsconsole.com/ style=width:100%></iframe><p>Functions can also be invoked using two methods defined for all functions, <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call rel=external target=_blank>call()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply rel=external target=_blank>apply()</a>.</p><h2 id=function-arguments>Function Arguments</h2><p>One of the bigger differences between JavaScript and imperative languages is in how JavaScript handles arguments. Consider the <code>hello()</code> function we defined above. What happens if we invoke it with no arguments? Or if we invoke it with two arguments?</p><p>Give it a try:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>sayHello</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nx>sayHello</span><span class=p>(</span><span class=s2>&#34;Mary&#34;</span><span class=p>,</span> <span class=s2>&#34;Bob&#34;</span><span class=p>);</span></span></span></code></pre></div><p>What are we seeing here? In JavaScript, the number of arguments supplied to a function when it is invoked is <em>irrelevant</em>. The same function will be invoked regardless of the <em>arity</em> (number) or <em>type</em> of arguments. The supplied arguments will be assigned to the defined argument names within the function&rsquo;s scope, according to the order. If there are less supplied arguments than defined ones, the missing ones are assigned the value <code>undefined</code>. And if there are extra arguments supplied, they are not assigned to a value.</p><p>Can we access those extra arguments? Yes, because JavaScript places them in a variable <code>arguments</code> accessible within the function body. Let&rsquo;s modify our <code>sayHello()</code> method to take advantage of this knowledge, using the <code>for .. of</code> loop we saw in the last section:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>sayHello</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=nx>name</span> <span class=k>of</span> <span class=nx>arguments</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Hello, </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>And try invoking it with an arbtrary number of names:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>sayHello</span><span class=p>(</span><span class=s2>&#34;Mike&#34;</span><span class=p>,</span> <span class=s2>&#34;Mary&#34;</span><span class=p>,</span> <span class=s2>&#34;Bob&#34;</span><span class=p>,</span> <span class=s2>&#34;Sue&#34;</span><span class=p>);</span></span></span></code></pre></div><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>JavaScript does not have a mechanism for <a href=https://en.wikipedia.org/wiki/Function_overloading rel=external target=_blank>function overloading</a> like C# and Java do. In JavaScript, if you declare a second &ldquo;version&rdquo; of a function that has different named arguments, you are not creating an overloaded version - you&rsquo;re replacing the original function!</p></div></div><p>Thus, when we entered our second <code>sayHello()</code> definition in the console, we overwrote the original one. Each function name will <em>only</em> reference a single definition at a time within a single scope, and just like with variables, we can change its value at any point.</p><p>Finally, because JavaScript has first-order functions, we can pass a function as an argument. For example, we could create a new function, <code>greet()</code> that takes the greeter&rsquo;s name, a function to use to greet others, and uses the arguments to greet an arbitrary number of people:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>greet</span><span class=p>(</span><span class=nx>name</span><span class=p>,</span> <span class=nx>greetingFn</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=nx>arguments</span><span class=p>.</span><span class=nx>length</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>greetingFn</span><span class=p>(</span><span class=nx>arguments</span><span class=p>[</span><span class=nx>i</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`It&#39;s good to meet you.  I&#39;m </span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>We can then use it by passing our <code>sayHello()</code> function as the second argument:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>greet</span><span class=p>(</span><span class=s2>&#34;Mark&#34;</span><span class=p>,</span> <span class=nx>sayHello</span><span class=p>,</span> <span class=s2>&#34;Joe&#34;</span><span class=p>,</span> <span class=s2>&#34;Jill&#34;</span><span class=p>,</span> <span class=s2>&#34;Jack&#34;</span><span class=p>,</span> <span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=s2>&#34;Jenny&#34;</span><span class=p>);</span></span></span></code></pre></div><p>Note that we don&rsquo;t follow the function name with the parenthesis (<code>()</code>) when we pass it. If we did, we&rsquo;d inovke the function <em>at that point</em> and what we&rsquo;d pass was the return value of the function, not the function itself.</p><h2 id=return-values>Return Values</h2><p>Just like the functions you&rsquo;re used to, JavaScript functions can return a value with the <code>return</code> statement, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>We can also return nothing, which is <code>undefined</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>bar</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This is useful when we want to stop execution immediately, but don&rsquo;t have a real return value. Also, if we don&rsquo;t specify a return value, we <em>implicity</em> return <code>undefined</code>.</p><p>And, because JavaScript has first-order functions, we can return a function:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>giveMeAFunction</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Here I am!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=function-variables>Function Variables</h2><p>Because JavaScript has first-order functions, we can also assign a function to a variable, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>myFn</span> <span class=o>=</span> <span class=kd>function</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>{</span><span class=k>return</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span><span class=p>;}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>greetFn</span> <span class=o>=</span> <span class=nx>greet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>otherFn</span> <span class=o>=</span> <span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=k>return</span> <span class=nx>a</span> <span class=o>-</span> <span class=nx>b</span><span class=p>;}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>oneMoreFn</span> <span class=o>=</span> <span class=nx>giveMeAFunction</span><span class=p>();</span></span></span></code></pre></div><h2 id=functional-scope>Functional Scope</h2><p>We&rsquo;ve mentioned scope several times now. Remember, <a href=https://en.wikipedia.org/wiki/Scope_(computer_science) rel=external target=_blank>scope</a> simply refers to where a binding between a symbol and a value is valid (here the symbol could be a <code>var</code> or <code>function</code> name). JavaScript uses <em>functional scope</em>, which means a new scope is created within the body of every function. Moreover, the parent scope of that function remains accessible as well.</p><p>Consider the JavaScript code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=s2>&#34;foo&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>b</span> <span class=o>=</span> <span class=s2>&#34;bar&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;before coolStuff&#34;</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>coolStuff</span><span class=p>(</span><span class=nx>c</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>b</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;in coolStuff&#34;</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>coolStuff</span><span class=p>(</span><span class=nx>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;after coolStuff&#34;</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>);</span></span></span></code></pre></div><p>What gets printed before, in, and after <code>coolStuff()</code>?</p><ol><li>Before we invoke <code>coolStuff()</code> the values of <code>a</code> and <code>b</code> are <code>"foo"</code> and <code>"bar"</code> respectively.</li><li>Inside the body of <code>coolStuff()</code>:</li></ol><ul><li>The named argument <code>c</code> is assigned the value passed when <code>coolStuff()</code> is invoked - in this case, the value of <code>b</code> at the time, <code>"bar"</code>.</li><li>A new variable <code>a</code> is declared, and set to a value of <code>1</code>. This <code>a</code> only exists within <code>coolStuff()</code>, the old <code>a</code> remains unchanged outside of the function body.</li><li>The value of <code>4</code> is assigned to the variable <code>b</code>. Note that we did not declare a new <code>var</code>, so this is the same <code>b</code> as outside the body of the function.</li></ul><ol start=3><li>After the function is invoked, we go back to our original <code>a</code> which kept the value <code>"foo"</code> but our <code>b</code> was changed to <code>4</code>.</li></ol><p>That may not seem to bad. But let&rsquo;s try another example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>one</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>two</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nx>three</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>var</span> <span class=nx>a</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>three</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Here we have nested functions, each with its own scope, and its own variable <code>a</code> that exists for that scope.</p><h2 id=block-scope>Block Scope</h2><p>Most imperative programming langauges use <em>block scope</em>, which creates a new scope within any block of code. This includes function bodies, but also loop bodies and conditional blocks. Consider this snippet:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kd>var</span> <span class=nx>j</span> <span class=o>=</span> <span class=nx>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>j</span><span class=p>);</span></span></span></code></pre></div><p>What will be printed for the value of <code>j</code> after the loop runs?</p><p>You might think it should have been <code>undefined</code>, and it certainly would have been a null exception in an imperative language like Java, as the variable <code>j</code> was defined within the block of the <code>for</code> loop. Because those languages have <em>block scope</em>, anything declared within that scope only exists there.</p><p>However, with JavaScript&rsquo;s <em>functional</em> scope, a new scope is only created within the body of a function - not loop and conditional blocks! So anything created within a conditional block actually exists <em>in the scope of the function it appears in</em>. This can cause some headaches.</p><p>Try running this (admittedly contrived) example in the console:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>var</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>The <a href=https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout rel=external target=_blank>setTimeout()</a> will trigger the supplied function body 10 ms in the future.</p><p>Notice how all the values are 10? That&rsquo;s because we were accessing the same variable <code>i</code>, because it was in the same scope each time!</p><p>The keyword <code>let</code> was introduced in ES6 to bring block scope to JavaScript. If we use it instead, we see the behavior we&rsquo;re more used to:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=kd>let</span> <span class=nx>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>setTimeout</span><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=arrays---lists-by-another-name>Arrays - Lists by Another Name</h1><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><p>You might have noticed we used an array in discussing the <code>for .. in</code> loop, but didn&rsquo;t talk about it in our data type discussion. This is because in JavaScript, an <code>array</code> is not a primitive data type. Rather, it&rsquo;s a special kind of <code>object</code>.</p><p>This is one of those aspects of JavaScript that breaks strongly with imperative languages. Brandon Eich drew heavily from Scheme, which is a functional language that focuses heavily on list processing&mldr; and the JavaScript array actually has more to do with lists than it does arrays.</p><h2 id=declaring-arrays>Declaring Arrays</h2><p>JavaScript arrays can be declared using literal syntax:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>arr</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=mf>3.2</span><span class=p>,</span> <span class=kc>null</span><span class=p>];</span></span></span></code></pre></div><p>Notice how we can put any kind of data type into our array? We can also put an array in an array:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>arr2</span> <span class=o>=</span> <span class=p>[</span><span class=nx>arr</span><span class=p>,</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>],</span> <span class=p>[</span><span class=s2>&#34;foo&#34;</span><span class=p>,</span><span class=s2>&#34;bar&#34;</span><span class=p>]];</span></span></span></code></pre></div><p>We can create the effect of an n-dimensional array, though in practice we&rsquo;re creating what we call <a href=https://en.wikipedia.org/wiki/Jagged_array rel=external target=_blank>jagged arrays</a> in computer science.</p><p>Clearly if we can do this, the JavaScript array is a very different beast than a Java or C# one.</p><h2 id=accessing-array-values>Accessing Array Values</h2><p>We can access an element in an array with bracket notation, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>arr</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span> <span class=kc>true</span><span class=p>,</span> <span class=mf>3.2</span><span class=p>,</span> <span class=kc>null</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>arr</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span></span></span></code></pre></div><p>will print <code>true</code>. We index arrays starting at 0, just as we are used to .<br>But what if we try accessing an index that is &ldquo;out of bounds&rdquo;? Try it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>arr</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>arr</span><span class=p>[</span><span class=mi>80</span><span class=p>]);</span></span></span></code></pre></div><p>We don&rsquo;t get an exception, just an <code>undefined</code>, because that value doesn&rsquo;t exist yet. Let&rsquo;s take the same array and give it a value there:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>arr</span><span class=p>[</span><span class=mi>80</span><span class=p>]</span> <span class=o>=</span> <span class=mi>5</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>arr</span><span class=p>[</span><span class=mi>80</span><span class=p>]);</span></span></span></code></pre></div><p>Now we see our value. But what about the values between <code>arr[3]</code> and <code>arr[80]</code>? If we try printing them, we&rsquo;ll see a value of <code>undefined</code>. But remember how we said an array is a special kind of object? Let&rsquo;s iterate over its keys and values with a <code>for .. in</code> loop:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nx>key</span> <span class=k>in</span> <span class=nx>arr</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`The index </span><span class=si>${</span><span class=nx>key</span><span class=si>}</span><span class=sb> has value </span><span class=si>${</span><span class=nx>arr</span><span class=p>[</span><span class=nx>key</span><span class=p>]</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Notice how we only print values for indices 0,1,2,3, and 80? The array is really just a special case of the <code>object</code>, using indices as property keys to store values. Everything in the array is effectively stored by reference&mldr; which means all the rules we learned about optimizing array algorithms won&rsquo;t apply here.</p><h2 id=arrays-as-special-purpose-data-structures>Arrays as Special-Purpose Data Structures</h2><p>You&rsquo;ve also learned about a lot of specialty data structures in prior courses - stacks, queues, etc. Before you write one in JavaScript though, you may be interested to know that JavaScript arrays can emulate these with their built-in methods.</p><p><strong>Stacks</strong> We push new elements to the top of the stack, and pop them off. The array methods <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push rel=external target=_blank>push()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop rel=external target=_blank>pop()</a> duplicate this behavior by pushing and popping items from the end of the array.</p><p><strong>FIFO queues</strong> A first-in-first-out queue can be mimicked with the array methods <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/push rel=external target=_blank>push()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/shift rel=external target=_blank>shift()</a> which push new items to the end of the array and remove the first item, respectively.</p><p>Another useful method is <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/unshift rel=external target=_blank>unshift()</a>, which adds a new element to the front of the array.</p><p>Most data types you&rsquo;ve learned about in prior courses can be emulated with some combination of JavaScript arrays and objects, including various flavors of trees, priority queues, and tries. Granted, these will not be as performant as their equivalents written in C, but they will serve for most web app needs.</p><h2 id=map-reduce>Map Reduce</h2><p>One of the most powerful patterns JavaScript adopted from list-processing languages is the map and reduce patterns. You may have heard of <a href=https://en.wikipedia.org/wiki/MapReduce rel=external target=_blank>MapReduce</a> in terms of Big Data - that is exactly these two patterns used in combination. Let&rsquo;s examine how they are used in JavaScript.</p><h3 id=map>Map</h3><p>The basic idea of mapping is to process a list one element at a time, returning a new list containing the processed elements. In JavaScript, we implement it with the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map rel=external target=_blank>map()</a> method of the array. It takes a function as an argument, which is invoked on each item in the array, and returns the newly processed array (the old array stays the same).</p><p>The function supplied to <em>map()</em> is supplied with three arguments - the item currently iterated, the index of the item in the array, and a reference to the original array. Of course, you don&rsquo;t have to define your function with the second or third arguments.</p><p>Let&rsquo;s try a simple example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>squares</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>].</span><span class=nx>map</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=k>return</span> <span class=nx>item</span> <span class=o>*</span> <span class=nx>item</span><span class=p>})</span></span></span></code></pre></div><p>This code squares each of the numbers in the array, and sets <code>squares</code> to have as a value the array of newly-created squares.</p><p>Notice too how by passing a function into the map function, we create a new scope for each iteration? This is how JavaScript has long dealt with the challenge of functional scope - by using functions!</p><h3 id=reduce>Reduce</h3><p>The reduce pattern also operates on a list, but it <em>reduces</em> the list to a single result. In JavaScript, it is implemented with the array&rsquo;s <a href=/cis526/c-js/04-arrays-and-lists/>reduce()</a> method. The method takes two arguments - a reducer function and an initial accumulator value. Each time the reduce function iterates, it performs an operation on the currently iterated item and the accumulator. The accumulator is then passed forward to the next iteration, until it is returned at the end.</p><p>The function supplied to <em>reduce</em> has four arguments - the current accumulator value, the current iterated item, the item&rsquo;s index, and the original array. As with <code>map()</code>, we can leave out the last two arguments if we don&rsquo;t need to use them.</p><p>A common example of <code>reduce()</code> in action is to sum an array:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>sum</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>].</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=k>return</span> <span class=nx>acc</span> <span class=o>+</span> <span class=nx>item</span><span class=p>},</span> <span class=mi>0</span><span class=p>);</span></span></span></code></pre></div><p>We supply the initial value of the accumulator as identity for addition, <code>0</code>, and each iteration the current item in the array is added to it. At the end, the final value is returned.</p><h3 id=mapreduce>MapReduce</h3><p>And as we said before, MapReduce is a combination of the two, i.e. we can calculate the sum of squares by combining our two examples:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>sumOfSquares</span> <span class=o>=</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>].</span><span class=nx>map</span><span class=p>((</span><span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>item</span> <span class=o>*</span> <span class=nx>item</span>
</span></span><span class=line><span class=cl><span class=p>}).</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span> <span class=nx>item</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>acc</span> <span class=o>+</span> <span class=nx>item</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Notice how we invoked the <code>map()</code> function on the original array, and then invoked <code>reduce()</code> on the returned array? This is a syntax known as <a href=https://en.wikipedia.org/wiki/Method_chaining rel=external target=_blank>method chaining</a>, which can make for concise code. We could also have assigned each result to a variable, and then invoked the next method on that variable.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=objects-and-classes>Objects and Classes</h1><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><p>JavaScript is also an object-oriented language, but the way it implements objects is derived from the ideas of the Self programming language, rather than the C++ origins of Java and C#&rsquo;s object-oriented approaches.</p><h2 id=object-properties>Object Properties</h2><p>Let&rsquo;s start with what an object <em>is</em> in JavaScript. It&rsquo;s basically a collection of properties - key/value pairs, similar to the concept of a Dictionary in other languages. The properties play both the role of fields and methods of the object, as a property can be assigned a primitive value or a function.</p><p>We&rsquo;ve already seen how to create an object with literal syntax, but let&rsquo;s see another example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>bob</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Bob&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>29</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>mother</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Mary&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>age</span><span class=o>:</span> <span class=mi>53</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Look at the property <code>mother</code> - it is its own object, nested within <code>bob</code>. Objects can nest as deep as we need them to (or at least, until we run out of memory).</p><p>We can then access properties with either dot notation or bracket notation, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// dot notation
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>bob</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>bob</span><span class=p>.</span><span class=nx>mother</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>bob</span><span class=p>.</span><span class=nx>father</span> <span class=o>=</span> <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Mark&#34;</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// bracket notation
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>bob</span><span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>bob</span><span class=p>[</span><span class=s2>&#34;mother&#34;</span><span class=p>][</span><span class=s2>&#34;name&#34;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=nx>bob</span><span class=p>[</span><span class=s2>&#34;father&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Mark&#34;</span><span class=p>}</span></span></span></code></pre></div><p>Property names should conform to JavaScript variable naming rules (start with a letter, <code>$</code>, or <code>_</code>, be composed of letters, numbers, <code>$</code>, and <code>_</code>, and contain no spaces) though we can use bracket notation to sidestep this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>bob</span><span class=p>[</span><span class=s2>&#34;favorite thing&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;macaroni&#34;</span><span class=p>;</span></span></span></code></pre></div><p>However, if a property set with bracket notation does not conform to the naming rules, it cannot be accessed with dot notation. Other than that, you&rsquo;re free to mix and match.</p><p>You can also use the value of a variable as a property name:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>field</span> <span class=o>=</span> <span class=s2>&#34;key&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>tricky</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=nx>field</span><span class=p>]</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>lo</span><span class=p>(</span><span class=nx>tricky</span><span class=p>.</span><span class=nx>key</span><span class=p>);</span></span></span></code></pre></div><p>This is a handy trick when you need to set property names at runtime.</p><h2 id=constructors>Constructors</h2><p>A constructor in JavaScript is simply a function that is invoked with the keyword <code>new</code>. Inside the body of the function, we have access to a variable named <code>this</code>, which can have values assigned to it. Here is an example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>Bear</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>pooh</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Bear</span><span class=p>(</span><span class=s2>&#34;pooh&#34;</span><span class=p>);</span></span></span></code></pre></div><p>There is nothing that inherently distinguishes a constructor from any other function; we can use the <code>new</code> keyword with any function. However, it only makes sense to do so with functions intended to be used as constructors, and therefore JavaScript programmers have adopted the convention of starting function names intended to be used as constructors with a capital letter, and other functions with a lowercase one.</p><h2 id=object-methods>Object Methods</h2><p>Methods are simply functions attached to the object as a property, which have access to the <code>this</code> (which refers back to the object) i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>pooh</span><span class=p>.</span><span class=nx>greet</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`My name is </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>We can also attach a method to all objects created with a constructor by attaching them to its prototype, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>Bear</span><span class=p>.</span><span class=nx>prototype</span><span class=p>.</span><span class=nx>growl</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Grrr.  My name is </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb> and I&#39;ll eat you up!`</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Now we can invoke <code>pooh.growl()</code> and see the same message. If we create a few new Bear instances:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>smokey</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Bear</span><span class=p>(</span><span class=s2>&#34;Smokey&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>shardik</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Bear</span><span class=p>(</span><span class=s2>&#34;Shardik&#34;</span><span class=p>);</span></span></span></code></pre></div><p>They also has access to the <code>growl()</code> method, but not <code>greet()</code>, because that was declared on the <code>pooh</code> instance, <em>not</em> the prototype.</p><p>Of course, it doesn&rsquo;t seem appropriate for Smokey the Bear to threaten to eat you. Let&rsquo;s tweak his behavior:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>smokey</span><span class=p>.</span><span class=nx>growl</span> <span class=o>=</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Only you can prevent forest fires!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Now try invoking:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>smokey</span><span class=p>.</span><span class=nx>growl</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>shardik</span><span class=p>.</span><span class=nx>growl</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>pooh</span><span class=p>.</span><span class=nx>growl</span><span class=p>();</span></span></span></code></pre></div><p>Pooh and Shardick continue to growl menacingly, but Smokey warns us about the dangers of forest fires. This leads us to the topic of prototypes.</p><h2 id=object-prototypes>Object Prototypes</h2><p>JavaScript adopts an approach to inheritance known as <a href=https://en.wikipedia.org/wiki/Prototype-based_programming rel=external target=_blank>prototype-based programming</a>, which works a bit differently than you&rsquo;re used to.</p><p>In JavaScript, each object keeps a reference to its constructor (in fact, you can see this for our bears with <code>pooh.constructor</code>, <code>smokey.constructor</code>, etc.). Each constructor in turn has a <code>prototype</code> property, which is an <code>object</code> with methods and properties attached to it.</p><p>When we invoke <code>pooh.growl()</code>, JavaScript first checks to see if the <code>growl</code> property is defined on the Bear instance we know as <code>pooh</code>. If not, then it checks the constructor&rsquo;s prototype for the same property. If it exists, then it invokes it.</p><p>Inheritance in JavaScript takes the form of a prototype chain - as each prototype is an <code>object</code>, each prototype can have its own prototype in turn. Thus, when we invoke a method, the interpreter walks down this chain and invokes the first matching property found.</p><h2 id=ecma-script-2015-class-syntax>ECMA Script 2015 Class Syntax</h2><p>If you find this all confusing, don&rsquo;t worry, you&rsquo;re not alone. ECMAScript decided to introduce a new class syntax in the 2015 version (ES6). It will look a lot more familiar:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Bear</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>growl</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>growl</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nx>growl</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Grrr! My name is </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb> and I&#39;ll eat you!`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Here we&rsquo;ve recreated our Bear class using the new syntax. We can construct a bear the same way, and invoke its <code>growl()</code> method:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>yogi</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Bear</span><span class=p>(</span><span class=s2>&#34;Yogi&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>yogi</span><span class=p>.</span><span class=nx>growl</span><span class=p>();</span></span></span></code></pre></div><h3 id=method-binding>Method Binding</h3><p>Under the hood we&rsquo;re still using the same prototypical inheritance, which throws a slight wrench in the works. Notice the line:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>this</span><span class=p>.</span><span class=nx>growl</span> <span class=o>=</span> <span class=k>this</span><span class=p>.</span><span class=nx>growl</span><span class=p>.</span><span class=nx>bind</span><span class=p>(</span><span class=k>this</span><span class=p>);</span></span></span></code></pre></div><p>in the constructor? This uses the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind rel=external target=_blank>function.prototype.bind</a> method to bind the scope of the growl function to the <code>this</code> object of our class (remember, functions start a new scope, and a new scope means a new <code>this</code> object).</p><p>So remember when using ES6 class syntax, you need to bind your methods, or declare them in the constructor itself as arrow functions, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Bear</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>name</span> <span class=o>=</span> <span class=nx>name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>growl</span> <span class=o>=</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Grrr! My name is </span><span class=si>${</span><span class=k>this</span><span class=p>.</span><span class=nx>name</span><span class=si>}</span><span class=sb> and I&#39;ll eat you!`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>As the arrow function declaration does not open a new scope, the this object doesn&rsquo;t change, and refers to the bear instance.</p><h3 id=inheritance>Inheritance</h3><p>Specifying inheritance is also simplified. For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Mammal</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>hasFur</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>givesMilk</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=p>.</span><span class=nx>heartChambers</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>class</span> <span class=nx>Bear</span> <span class=kr>extends</span> <span class=nx>Mammal</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>constructor</span><span class=p>(</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>super</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>Remember to always invoke the parent constructor with <code>super()</code> as the first thing in your child class constructor.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=attaching-scripts>Attaching Scripts</h1><p>Much like there are multiple ways to apply CSS to a web app, there are multiple ways to bring JavaScript into one. We can use a <code>&lt;script></code> tag with a specified <code>src</code> attribute to load a separate document, put our code into the <code>&lt;script></code> tag directly, or even add code to attributes of an HTML element. Let&rsquo;s look at each option.</p><h2 id=script-tag-with-source>Script Tag with Source</h2><p>We can add a <code>&lt;script></code> tag with a <code>src</code> attribute that gives a url pointing to a JavaScript file. This is similar to how we used the <code>&lt;link></code> element for CSS:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>JS Example<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;example.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span></span></span></code></pre></div><p>A couple of important differences though. First, the <code>&lt;script></code> element is not a void tag, so we a closing <code>&lt;/script></code>. Also, while traditionally we would also place <code>&lt;script></code> elements in the <code>&lt;head></code>, current best practice is to place them as the last children of the <code>&lt;body></code> element.</p><h2 id=script-tag-with-content>Script Tag with Content</h2><p>The reason the <code>&lt;script></code> element isn&rsquo;t a void element is that you can place JavaScript code directly into it - similar to how we used the <code>&lt;style></code> element for CSS. Typically we would also place this tag at the end of the body:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>JS Example<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=mi>1</span> <span class=o>+</span> <span class=mi>3</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span></span></span></code></pre></div><h2 id=why-at-the-end-of-the-body>Why at the End of the Body?</h2><p>The reason for placing <code>&lt;script></code> tags at the end of the body is twofold. First, JavaScript files have grown increasingly large as web applications have become more sophisticated. And as they are parsed, there is no visible sign of this in the browser - so it can make your website appear to load more slowly when they are encountered in the <code>&lt;head></code> section. Second, JavaScript is interpreted as it is loaded - so if your code modifies part of the web page, and tries to do so before the webpage is fully loaded, it may fail.</p><p>A good trick is to place any code that should not be run until all the web pages&rsquo; assets have been downloaded within the body of an event handler tied to the <code>'load'</code> event, i.e.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>window</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1>// Put any JavaScript that should not be
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// run until the page has finished loading 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=c1>// here..
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><h2 id=as-an-attribute>As an Attribute</h2><p>A third alternative is to define our JavaScript as an <a href=https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Event_handlers rel=external target=_blank>on-event handler</a> directly on an element. For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span> <span class=na>onclick</span><span class=o>=</span><span class=s>&#34;console.log(1+3)&#34;</span><span class=p>&gt;</span>click me<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span></span></span></code></pre></div><p>This once-common strategy has fallen out of favor as it does not provide for good separation of concerns, and can be difficult to maintain in large HTML files. Also, only one event handler can be set using this approach; we&rsquo;ll see an alternative method, <a href=https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener rel=external target=_blank>Element.addEventListener()</a> in the next section that is more powerful.</p><p>However, component-based development approaches like React&rsquo;s JSX make this approach more sensible, so it has seen some resurgence in interest.</p><h2 id=mix-and-match>Mix-and-Match</h2><p>It is important to understand that all JavaScript on a page is interpreted within the same scope, regardless of what file it was loaded from. Thus, you can invoke a function in one file that was defined in a separate file - this is commonly done when incorporating JavaScript libraries like JQuery.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>There is one aspect you need to be aware of though. Before you reference code artifacts like functions and variables, they must have been loaded in the interpreter. If you are using external files, these have to be retrieved by the browser as a separate request, and even though they may be declared in order in your HTML, they may be received out of order, and they will be interpreted <em>in the order they are received</em></p><p>There are a couple of strategies that can help here. First, you can use the window&rsquo;s <code>load</code> event as we discussed above to avoid triggering any JavaScript execution until all the script files have been loaded. And second, we can combine all of our script files into one single file (a process known as <em>concatenation</em>). This is often done with a build tool that also <em>minifies</em> the resulting code. We&rsquo;ll explore this strategy later in the course.</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=the-document-object-model>The Document Object Model</h1><p>Now that we&rsquo;ve reviewed the basic syntax and structure of the JavaScript language, and how to load it into a page, we can turn our attention to what it was created for - to interact with web pages in the browser. This leads us to the <em>Document Object Model (DOM)</em>.</p><p>The DOM is a tree-like structure that is created by the browser when it parses the HTML page. Then, as CSS rules are interpreted and applied, they are attached to the individual nodes of the tree. Finally, as the page&rsquo;s JavaScript executes, it may modify the tree structure and node properties. The browser uses this structure and properties as part of its rendering process.</p><h2 id=the-document-instance>The Document Instance</h2><p>The DOM is exposed to JavaScript through an instance of the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document rel=external target=_blank>Document</a> class, which is attached to the <code>document</code> property of the window (in the browser, the window is the top-level, a.k.a global scope. Its properties can be accessed with our without referencing the <code>window</code> object, i.e. <code>window.document</code> and <code>document</code> refer to the same object).</p><p>This document instance serves as the entry point for working with the DOM.</p><h2 id=the-dom-tree>The Dom Tree</h2><p>The DOM tree nodes are instances of the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element rel=external target=_blank>Element</a> class, which extends from the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Node rel=external target=_blank>Node</a> class, which in turn extends the <a href=https://developer.mozilla.org/en-US/docs/Web/API/EventTarget rel=external target=_blank>EventTarget</a> class. This inheritance chain reflects the <a href=https://en.wikipedia.org/wiki/Separation_of_concerns rel=external target=_blank>Separation of Concerns</a> design principle: the EventTarget class provides the functionality for responding to events, the Node class provides for managing and traversing the tree structure, and the Element class maintains the element&rsquo;s appearance and properties.</p><div id=interfaceDiagram style=display:inline-block;position:relative;width:100%;padding-bottom:11.666666666666666%;vertical-align:middle;overflow:hidden><svg style="display:inline-block;position:absolute;top:0;left:0" viewBox="-50 0 600 70" preserveAspectRatio="xMinYMin meet"><a xlink:href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget" target="_top"><rect x="1" y="1" width="110" height="50" fill="#fff" stroke="#d4dde4" stroke-width="2"/><text x="56" y="30" font-size="12" font-family="Consolas,Monaco,Andale Mono,monospace" fill="#4d4e53" text-anchor="middle" alignment-baseline="middle">EventTarget</text></a><polyline points="111,25 121,20 121,30 111,25" stroke="#d4dde4" fill="none"/><line x1="121" y1="25" x2="151" y2="25" stroke="#d4dde4"/><a xlink:href="https://developer.mozilla.org/en-US/docs/Web/API/Node" target="_top"><rect x="151" y="1" width="75" height="50" fill="#fff" stroke="#d4dde4" stroke-width="2"/><text x="188.5" y="30" font-size="12" font-family="Consolas,Monaco,Andale Mono,monospace" fill="#4d4e53" text-anchor="middle" alignment-baseline="middle">Node</text></a><polyline points="226,25 236,20 236,30 226,25" stroke="#d4dde4" fill="none"/><line x1="236" y1="25" x2="266" y2="25" stroke="#d4dde4"/><a xlink:href="https://developer.mozilla.org/en-US/docs/Web/API/Element" target="_top"><rect x="266" y="1" width="75" height="50" fill="#f4f7f8" stroke="#d4dde4" stroke-width="2"/><text x="303.5" y="30" font-size="12" font-family="Consolas,Monaco,Andale Mono,monospace" fill="#4d4e53" text-anchor="middle" alignment-baseline="middle">Element</text></a></svg></div><h3 id=the-dom-playground>The DOM Playground</h3><p>The panels opposite show a simple web app where we can experiment with the DOM. Specifically, we&rsquo;re going to use JavaScript code we write in <em>playground.js</em> to interact with the page <em>index.html</em>. The page already has a couple of elements defined in it - a button with <code>id="some-button"</code>, and a text input with <code>id="some-input"</code>.</p><p>Additionally, the JavaScript code in <em>page-console.js</em> hijacks the <code>console.log()</code> method so that instead of printing to the regular console, it injects the output to a <code>div</code> element on the page. This will help make the console more accessible in Codio. Also, it demonstrates just how <em>dynamic</em> a language JavaScript is - we just altered the behavior of a core function!</p><h3 id=selecting-elements-on-the-page>Selecting Elements on the Page</h3><p>One of the most important skills in working with the DOM is understanding how to get a reference to an element on the page. There are many approaches, but some of the most common are:</p><h4 id=selecting-an-element-by-its-id>Selecting an Element by its ID</h4><p>If an element has an <code>id</code> attribute, we can select it with the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementById rel=external target=_blank>Document.getElementByID()</a> method. Let&rsquo;s select our button this way. Add this code to your <em>playground.js</em> file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>button</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-button&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>button</span><span class=p>);</span></span></span></code></pre></div><p>You should see the line <code>[object HTMLButtonElement]</code> - the actual instance of the DOM node representing our button (the class HTMLButtonElement is an extension of Element representing a button).</p><h4 id=selecting-a-single-element-by-css-selector>Selecting a Single Element by CSS Selector</h4><p>While there are additional selectors for selecting by tag name, class name(s), and other attributes, in practice these have largely been displaced by functions that select elements using a CSS selector.</p><p><a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelector rel=external target=_blank>Document.querySelector()</a> will return the <em>first</em> element matching the CSS selector, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>button</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;#some-button&#39;</span><span class=p>);</span></span></span></code></pre></div><p>Works exactly like the <code>document.getElementById()</code> example. But we could also do:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>input</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;input[type=text]&#39;</span><span class=p>);</span></span></span></code></pre></div><p>Which would grab the first <code>&lt;input></code> with attribute <code>type=text</code>.</p><h4 id=selecting-multiple-elements-by-css-selector>Selecting Multiple Elements by CSS Selector</h4><p>But what if we wanted to select more than one element at a time? Enter <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll rel=external target=_blank>document.querySelectorAll()</a>. It returns a <a href=https://developer.mozilla.org/en-US/docs/Web/API/NodeList rel=external target=_blank>NodeList</a> containing all matching nodes. So the code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>paras</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;p.highlight&#39;</span><span class=p>);</span></span></span></code></pre></div><p>Will populate the variable <code>paras</code> with a <code>NodeList</code> containing all <code>&lt;p></code> elements on the page with the highlight class.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>While a <code>NodeList</code> is an iterable object that behaves much like an array, it is not an array. Its items can also be directly accessed with bracket notation (<code>[]</code>) or <a href=https://developer.mozilla.org/en-US/docs/Web/API/NodeList/item rel=external target=_blank>NodeList.item()</a>. It can be iterated over with a <code>for .. of</code> loop, and in newer browsers, <a href=https://developer.mozilla.org/en-US/docs/Web/API/NodeList/forEach rel=external target=_blank>NodeList.forEach()</a>. Alternatively, it can be converted into an array with <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/from rel=external target=_blank>Array.from()</a>.</p></div></div><h4 id=elementqueryselector-and-elementqueryselectorall>Element.querySelector() and Element.querySelectorAll()</h4><p>The query selector methods are also implemented on the element class, with <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector rel=external target=_blank>Element.querySelector()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelectorAll rel=external target=_blank>Element.querySelectorAll()</a>. Instead of searching the entire document, these only search their descendants for matching elements.</p><h3 id=events>Events</h3><p>Once we have a reference to an element, we can add an event listener with <a href=https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener rel=external target=_blank>EventTarget.addEventListener()</a>. This takes as its first argument, the name of the event to listen for, and as the second, a method to invoke when the event occurs. There are additional optional arguments as well (such as limiting an event listener to firing only once), see the MDN documentation for more details.</p><p>For example, if we wanted to log when the user clicks our button, we could use the code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-button&#34;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>event</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Button was clicked!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Notice we are once again using method chaining - we could also assign the element to a <code>var</code> and invoke <code>addEventListener()</code> on the variable. The event we want to listen for is identified by its name - the string <code>'click'</code>. Finally, our event handler function will be invoked with an event object as its first argument.</p><p>Also, note the use of <code>event.preventDefault()</code>. Invoking this method on the event tells it that we are taking care of its responsibilities, so no need to trigger the default action. If we don&rsquo;t do this, the event will continue to bubble up the DOM, triggering any additional event handlers. For example, if we added a <code>'click'</code> event to an <code>&lt;a></code> element and did not invoke <code>event.preventDefault()</code>, when we clicked the <code>&lt;a></code> tag we would run our custom event handler and then the browser would load the page that the <code>&lt;a></code> element&rsquo;s <code>href</code> attribute pointed to.</p><h4 id=common-event-names>Common Event Names</h4><p>The most common events you&rsquo;ll likely use are</p><ul><li><code>"click"</code> triggered when an item is clicked on</li><li><code>"input"</code> triggered when an input element receives input</li><li><code>"change"</code> triggered when an input&rsquo;s value changes</li><li><code>"load"</code> triggered when the source of a image or other media has finished loading</li><li><code>"mouseover"</code> and <code>"mouseout"</code> triggered when the mouse moves over an element or moves off an element</li><li><code>"mousedown"</code> and <code>"mouseup"</code> triggered when the mouse button is initially pressed and when it is released (primarily used for drawing and drag-and-drop)</li><li><code>"mousemove"</code> triggered when the mouse moves (used primarily for drawing and drag-and-drop)</li><li><code>"keydown"</code>, <code>"keyup"</code>, and <code>"keypressed"</code> triggered when a key is first pushed down, released, and held.</li></ul><p>Note that the mouse and key events are only passed to elements when they have <em>focus</em>. If you want to always catch these events, attach them to the <code>window</code> object.</p><p>There are many more events - refer to the MDN documentation of the specific element you are interested in to see the full list that applies to that element.</p><h4 id=event-objects>Event Objects</h4><p>The function used as the event handler is invoked with an object representing the event. In most cases, this is a descendant class of <a href=https://developer.mozilla.org/en-US/docs/Web/API/Event rel=external target=_blank>Event</a> that has additional properties specific to the event type. Let&rsquo;s explore this a bit with our text input. Add this code to your <em>playground.js</em>, reload the page, and type something into the text input:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-input&#34;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;input&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Here we access the event&rsquo;s <code>target</code> property, which gives us the target element for the event, the original <code>&lt;input></code>. The input element has the <code>value</code> property, which corresponds to the <code>value</code> attribute of the HTML that was parsed to create it, and it changes as text is entered into the <code>&lt;input></code>.</p><h3 id=modifying-dom-element-properties>Modifying DOM Element Properties</h3><p>One of the primary uses of the DOM is to alter properties of <a href=https://developer.mozilla.org/en/docs/Web/API/Element rel=external target=_blank>element</a> objects in the page. Any changes to the DOM structure and properties are almost immediately applied to the appearance of the web page. Thus, we use this approach to alter the document in various ways.</p><h4 id=attributes>Attributes</h4><p>The attributes of an HTML element can be accessed and changed through the DOM, with the methods <a href=https://developer.mozilla.org/en/docs/Web/API/Element/getAttribute rel=external target=_blank>element.getAttribute()</a>, <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/hasAttribute rel=external target=_blank>element.hasAttribute()</a> and <a href=https://developer.mozilla.org/en/docs/Web/API/Element/setAttribute rel=external target=_blank>element.setAttribute()</a>.</p><p>Let&rsquo;s revisit the button in our playground, and add an event listener to change the input element&rsquo;s <code>value</code> attribute:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-button&#34;</span><span class=p>).</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;click&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-input&#34;</span><span class=p>).</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;value&#34;</span><span class=p>,</span> <span class=s2>&#34;Hello World!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Notice too that <em>both</em> event handlers we have assigned to the button trigger when you click it. We can add as many event handlers as we like to a project.</p><h4 id=styles>Styles</h4><p>The <a href=https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style rel=external target=_blank>style</a> property provides access to the element&rsquo;s inline styles. Thus, we can set style properties on the element:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&#34;some-button&#34;</span><span class=p>).</span><span class=nx>style</span> <span class=o>=</span> <span class=s2>&#34;background-color: yellow&#34;</span><span class=p>;</span></span></span></code></pre></div><p>Remember from our discussion of the CSS cascade that inline styles have the highest priority.</p><h4 id=class-names>Class Names</h4><p>Alternatively, we can change the CSS classes applied to the element by changing its <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/classList rel=external target=_blank>element.classList</a> property, which is an instance of a DOMTokensList, which exposes the methods:</p><ul><li><code>add()</code> which takes one or more string arguments which are class names added to the class list</li><li><code>remove()</code> which takes one or more string arguments which are class names removed from the class list</li><li><code>toggle()</code> which takes one or more strings as arguments and toggles the class name in the list (i.e. if the class name is there, it is removed, and if not, it is added)</li></ul><p>By adding, removing, or toggling class names on an element, we can alter what CSS rules apply to it based on its CSS selector.</p><h3 id=altering-the-document-structure>Altering the Document Structure</h3><p>Another common use for the DOM is to add, remove, or relocate elements in the DOM tree. This in turn alters the page that is rendered. For example, let&rsquo;s add a paragraph element to the page just after the <code>&lt;h1></code> element:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>p</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>createElement</span><span class=p>(</span><span class=s1>&#39;p&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>p</span><span class=p>.</span><span class=nx>innerHTML</span> <span class=o>=</span> <span class=s2>&#34;Now I see you&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>insertBefore</span><span class=p>(</span><span class=nx>p</span><span class=p>,</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelector</span><span class=p>(</span><span class=s1>&#39;h1&#39;</span><span class=p>).</span><span class=nx>nextSibling</span><span class=p>);</span></span></span></code></pre></div><p>Let&rsquo;s walk through this code line-by-line.</p><ol><li>Here we use <a href=https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement rel=external target=_blank>Document.createElement()</a> to create a new element for the DOM. At this point, the element is <em>unattached</em> to the document, which means it will not be rendered.</li><li>Now we alter the new <code>&lt;p></code> tag, adding the words <code>"Now I see you"</code> with the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML rel=external target=_blank>Element.innerHTML</a> property.</li><li>Then we attach the new <code>&lt;p></code> tag to the DOM tree, using <a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore rel=external target=_blank>Node.insertBefore()</a> method and <a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/nextSibling rel=external target=_blank>Node.nextSibling</a> property.</li></ol><p>The <a href=https://developer.mozilla.org/en-US/docs/Web/API/Node rel=external target=_blank>Node</a> interface provides a host of properties and methods for traversing, adding to, and removing from, the DOM tree. Some of the most commonly used are:</p><ul><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/parentNode rel=external target=_blank>Node.parent</a> the parent of this Node</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/childNodes rel=external target=_blank>Node.childNodes</a> a <a href=https://developer.mozilla.org/en-US/docs/Web/API/NodeList rel=external target=_blank>NodeList</a> of this node&rsquo;s children</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/nextSibling rel=external target=_blank>Node.nextSibling</a> returns the node following this one at the same level in the DOM tree</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/previousSibling rel=external target=_blank>Node.previousSibling</a> returns the node proceeding this one in the DOM tree at the same level</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild rel=external target=_blank>Node.appendChild()</a> adds the an element as the last child of the node</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/removeChild rel=external target=_blank>Node.removeChild()</a> removes a child from the node and returns it (this means the element becomes <em>unattached</em>)</li><li><a href=https://developer.mozilla.org/en-US/docs/Web/API/Node/replaceChild rel=external target=_blank>Node.replaceChild()</a> replaces a child element with another</li></ul><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=strict-mode>Strict Mode</h1><p>JavaScript has been around a long time, and a lot of JavaScript code has been written by inexperienced programmers. Browser manufacturers compensated for this by allowing lenient interpretation of JavaScript programs, and by ignoring many errors as they occurred.</p><p>While this made poorly-written scripts run, arguably they didn&rsquo;t run well. In ECMA5, <em>strict mode</em> was introduced to solve the problems of lenient interpretation.</p><p>Strict mode <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode rel=external target=_blank>according to the Mozilla Developer Network</a>:</p><ol><li>Eliminates some JavaScript silent errors by changing them to throw errors.</li><li>Fixes mistakes that make it difficult for JavaScript engines to perform optimizations: strict mode code can sometimes be made to run faster than identical code that&rsquo;s not strict mode.</li><li>Prohibits some syntax likely to be defined in future versions of ECMAScript.</li></ol><p>You can place the interpreter in strict mode by including this line at the start of your JavaScript file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;use strict&#34;</span><span class=p>;</span></span></span></code></pre></div><p>In interpreters that don&rsquo;t support strict mode, this expression will be interpreted as a string and do nothing.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=regular-expressions>Regular Expressions</h1><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><p>The JavaScript <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String rel=external target=_blank>String</a> prototype has some very powerful methods, such as <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes rel=external target=_blank>String.prototype.includes()</a> which recognizes when a string contains a substring - i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=s2>&#34;foobarwhen&#34;</span><span class=p>.</span><span class=nx>includes</span><span class=p>(</span><span class=s2>&#34;bar&#34;</span><span class=p>)</span></span></span></code></pre></div><p>would evaluate to true. But what if you needed a more general solution? Say, to see if the text matched a phone number pattern like XXX-XXX-XXXX? That&rsquo;s where <a href=https://en.wikipedia.org/wiki/Regular_expression rel=external target=_blank>Regular Expressions</a> come in.</p><p>Regular Expressions are a sequence of characters that define a <em>pattern</em> that can be searched for within a string. Unlike substrings, these patterns can have a <em>lot</em> of flexibility. For example, the phone number pattern above can be expressed as a JavaScript <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp rel=external target=_blank>RegExp</a> like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/\d{3}-\d{3}-\d{4}/</span></span></span></code></pre></div><p>Let&rsquo;s break down what each part means. First, the enclosing forward slashes (<code>/</code>) indicate this is a RegExp literal, the same way single or double quotes indicate a string literal. The backslash d (<code>\d</code>) indicates a decimal character, and will match a 0,1,2,3,4,5,6,7,8, or 9. The three in brackets <code>{3}</code> is a quantifier, indicating there should be three of the proceeding character - so three decimal characters. And the dash (<code>-</code>) matches the actual dash character.</p><h2 id=writing-regular-expressions-and-scriptular>Writing Regular Expressions and Scriptular</h2><p>As you can see, regular expressions make use of a decent number of special characters, and can be tricky to write. One of the greatest tools in your arsenal when dealing with Regular Expressions are web apps such as <a href=https://scriptular.com/ target=_blank>Scriptular.com</a> or <a href=https://regex101.com/ target=_blank>Regex101</a>(click the link to open it in a new tab). It lists characters with special meanings for regular expressions on the right, and provides an interactive editor on the left, where you can try out regular expressions against target text.</p><p>You can, of course, do the same thing on the console, but I find that using Scriptular to prototype regular expressions is faster. You can also clone the <a href=https://github.com/jonmagic/scriptular rel=external target=_blank>Scriptular Github repo</a> and use it locally rather than on the internet. A word of warning, however, always test your regular expressions in the context you are going to use them - sometimes something that works in Scriptular doesn&rsquo;t quite in the field (especially with older browsers and Node versions).</p><h2 id=regular-expressions-and-input-validation>Regular Expressions and Input Validation</h2><p>So how are regular expressions used in Web Development? One common use is to <em>validate</em> user input - to make sure the user has entered values in the format we want. To see if a user entered string matches the phone format we declared above, for example, we can use the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test rel=external target=_blank>RegExp.prototype.test()</a> method. It returns the boolean <code>true</code> if a match is found, <code>false</code> otherwise:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=sr>/\d{3}-\d{3}-\d{4}/</span><span class=p>.</span><span class=nx>test</span><span class=p>(</span><span class=nx>userEnteredString</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;String was valid&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;String was Invalid&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>But what if we wanted to allow phone numbers in more than one format? Say X-XXX-XXX-XXXX, (XXX)XXX-XXXX, and X(XXX)XXX-XXXX)?</p><p>We can do this as well:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/\d?-?\d{3}-\d{3}-\d{4}|\d?\s?\(\d{3}\)\s?\d{3}-\d{4}/</span></span></span></code></pre></div><p>The pipe (<code>|</code>) in the middle of the RexExp acts like an OR; we can match against the pattern before OR the pattern after. The first pattern is almost the same as the one we started with, but with a new leading <code>\d</code> and <code>-</code>. These use the quantifier <code>?</code>, which indicates 0 or 1 instances of the character.</p><p>The second pattern is similar, except we use a backslash s (<code>/s</code>) to match whitespace characters (we could also use the literal space <code></code>, <code>\s</code> also matches tabs and newlines). And we look for parenthesis, but as parenthesis have special meaning for RegExp syntax, we must escape them with a backslash: (<code>\(</code> and <code>\)</code>).</p><h2 id=regular-expressions-and-form-validation>Regular Expressions and Form Validation</h2><p>In fact, the use of Regular Expressions to validate user input is such a common use-case that when HTML5 introduced <a href=https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Form_validation rel=external target=_blank>form data validation</a> it included the <code>pattern</code> attribute for HTML5 forms. It instructs the browser to mark a form field as invalid unless input matching the pattern is entered. Thus, the HTML:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>label</span> <span class=na>for</span><span class=o>=</span><span class=s>&#34;phone&#34;</span><span class=p>&gt;</span>Please enter a phone number
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>input</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;phone&#34;</span> <span class=na>pattern</span><span class=o>=</span><span class=s>&#34;\d{3}-\d{3}-\d{4}&#34;</span> <span class=na>placeholder</span><span class=o>=</span><span class=s>&#34;xxx-xxx-xxxx&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>label</span><span class=p>&gt;</span></span></span></code></pre></div><p>Will ensure that only validly formatted phone numbers can be submitted. Also, note that we omitted the leading and trailing forward slashes (<code>/</code>) with the <code>pattern</code> attribute.</p><p>However, be aware that older browsers may not have support for <a href=https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Form_validation rel=external target=_blank>HTML5 form data validation</a> (though all modern ones do), and that a savvy user can easily disable HTML5 form validation with the Developer Tools. Thus, you should aways validate on both the client-side (for good user experience) <em>and</em> the server-side (to ensure clean data). We&rsquo;ll discuss data validation more in our chapter on persisting data on the server.</p><h2 id=constructing-regexp>Constructing RegExp</h2><p>Besides using literal notation, We can also <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp rel=external target=_blank>construct regular expressions</a> from a string of characters:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>regexp</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>RegExp</span><span class=p>(</span><span class=s2>&#34;\d{3}-\d{3}-\d{4}&#34;</span><span class=p>)</span></span></span></code></pre></div><p>This is especially useful if we won&rsquo;t know the pattern until runtime, as we can create our regular expression &ldquo;on the fly.&rdquo;</p><h2 id=regexp-flags>RegExp flags</h2><p>You can also specify one or more flags when defining a JavaScript Regular Expression, by listing the flag after the literal, i.e. in the RegExp:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/\d{3}-\d{3}-\d{4}/g</span> 
</span></span></code></pre></div><p>The flag <code>g</code> means <em>global</em>, and will find <em>all</em> matches, not just the first. So if we wanted to find all phone numbers in a body of text, we could do:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/\d{3}-\d{3}-\d{4}/g</span><span class=p>.</span><span class=nx>match</span><span class=p>(</span><span class=nx>bodyOfText</span><span class=p>);</span></span></span></code></pre></div><p>Here the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/match rel=external target=_blank>RegExp.prototype.match()</a> function returns an array of phone numbers that matched the pattern and were found in <code>bodyOfText</code>.</p><p>The flags defined for JavaScript regular expressions are:</p><ul><li><code>g</code> global match - normally RegExp execution stops after the first match.</li><li><code>i</code> ignore case - upper and lowercase versions of a letter are treated equivalently</li><li><code>m</code> multiline - makes the beginning end operators (<code>^</code> and <code>$</code>) operate on lines rather than the whole string.</li><li><code>s</code> dotAll - allows <code>.</code> to match newlines (normally <code>.</code> is a wildcard matching everything <em>but</em> newline characters)</li><li><code>u</code> unicode - treat pattern as a sequence of unicode code points</li><li><code>y</code>sticky - matches only from the <code>lastIndex</code> property of the Regular Expression</li></ul><h2 id=capture-groups>Capture Groups</h2><p>We saw above how we can retrieve the strings that matched our regular expression patterns
Matching patterns represents only <em>part</em> of the power of regular expressions. One of the most useful features is the ability to <em>capture</em> pieces of the pattern, and expose them to the programmer.</p><p>Consider, for example, the common case where we have a comma delimited value (CSV) file where we need to tweak some values. Say perhaps we have one like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Name,weight,height
</span></span><span class=line><span class=cl>John Doe,150,6&#39;2&#34;
</span></span><span class=line><span class=cl>Sara Smith,102,5&#39;8&#34;
</span></span><span class=line><span class=cl>&#34;Mark Zed, the Third&#34;,250,5&#39;11&#34;
</span></span><span class=line><span class=cl>... 100&#39;s more values....</span></span></code></pre></div><p>which is part of a scientific study where they need the weight in Kg and the height in meters. We could make the changes by hand - but who wants to do that? We could also do the changes by opening the file in Excel, but that would also involve a lot of copy/paste and deletion, opening the door to human error. Or we can tweak the values with JavaScript.</p><p>Notice how the Mark Zed entry, because it has a comma in the name, is wrapped in double quotes, while the other names aren&rsquo;t? This would make using something like <a href=/cis526/c-js/09-regexp/>String.prototype.split()</a> impossible to use without a ton of additional logic, because it splits on the supplied delimiter (in this case, a comma), and would catch these additional commas. However, because a RegExp matches a <em>pattern</em>, we can account for this issue.</p><p>But we want to go one step farther, and <em>capture</em> the weight and height values. We can create a <em>capture group</em> by surrounding part of our pattern with parenthesis, i.e. the RegExp:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=sr>/^([\d\s\w]+|&#34;[\d\s\w,]+&#34;),(\d+),(\d+&#39;\d+)&#34;$/gm</span></span></span></code></pre></div><p>Will match each line in the file. Let&rsquo;s take a look at each part:</p><p><code>/^ ... $/mg</code> the <code>m</code> flag indicates that <code>^</code> and <code>$</code> should mark the start and end of each line. This makes sure we only capture values from the same line as par to a match, and the <code>g</code> flag means we want to find all matching lines in the file.</p><p><code>([\d\s\w]+|"[\d\s\w,]+")</code> is our first capture group, and we see it has two options (separated by <code>|</code>). The square brackets (<code>[]</code>) represent a set of characters, and we&rsquo;ll match any character(s) listed inside. So <code>[\d\s\w]</code> means any decimal (<code>\d</code>), whitespace (<code>\s</code>), or word (<code>\w</code>) character, and the <code>+</code> means one or more of these. The second option is <em>almost</em> the same as the first, but surrounded by double quotes (<code>"</code>) and includes commas (<code>,</code>) in the set of matching characters. This means the first group will always match our name field, even if it has commas.</p><p><code>,(\d+),</code> is pretty simple - we match the comma between name and weight columns, capture the weight value, and then the comma between weight and height.</p><p><code>(\d+'\d+)"</code> is a bit more interesting. We capture the feet value (<code>\d+</code>), the apostrophe (<code>'</code>) indicating the unit of feet, and the inches value (<code>\d+</code>). While we match the units for inches (<code>"</code>), it is not part of the capture group.</p><p>So our line-by-line captures would be:</p><pre>
Line 0: No match
Line 1: John Doe, 150, 6'2
Line 2: Sara Smith, 102, 5'8
Line 3: "Mark Zed, the Third", 250, 5'11
</pre><p>We can use this knowledge with <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace rel=external target=_blank>String.prototype.replace()</a> to reformat the values in our file. The <code>replace()</code> can work as you are probably used to - taking two strings - one to search for and one to use as a replacement. But it can also take a RegExp as a <em>pattern</em> to search for and replace. And the replacement value can also be a <em>function</em>, which receives as its parameters 1) the full match to the pattern, and 2) the capture group values, as subsequent parameters.</p><p>Thus, for the Line 1 match, it would be invoked with parameters: <code>("John Doe,150,6'2\"", "John Doe", "150", "6'2\"")</code>. We can use this understanding to write our conversion function:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>convertRow</span><span class=p>(</span><span class=nx>match</span><span class=p>,</span> <span class=nx>name</span><span class=p>,</span> <span class=nx>weight</span><span class=p>,</span> <span class=nx>height</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>   <span class=c1>// Convert weight from lbs to Kgs 
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=kd>var</span> <span class=nx>lbs</span> <span class=o>=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>weight</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>kgs</span> <span class=o>=</span> <span class=nx>lbs</span> <span class=o>/</span> <span class=mf>2.205</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>   <span class=c1>// Convert height from feet and inches to meters 
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=kd>var</span> <span class=nx>parts</span> <span class=o>=</span> <span class=nx>height</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s2>&#34;&#39;&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>feet</span> <span class=o>=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>inches</span> <span class=o>=</span> <span class=nb>parseInt</span><span class=p>(</span><span class=nx>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>totalInches</span> <span class=o>=</span> <span class=nx>inches</span> <span class=o>+</span> <span class=mi>12</span> <span class=o>*</span> <span class=nx>feet</span><span class=p>;</span>
</span></span><span class=line><span class=cl>   <span class=kd>var</span> <span class=nx>meters</span> <span class=o>=</span> <span class=nx>totalInches</span> <span class=o>*</span> <span class=mf>1.094</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>   <span class=c1>// Return the new line values:
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=k>return</span> <span class=sb>`</span><span class=si>${</span><span class=nx>name</span><span class=si>}</span><span class=sb>,</span><span class=si>${</span><span class=nx>kgs</span><span class=si>}</span><span class=sb>,</span><span class=si>${</span><span class=nx>meters</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>And now we can invoke that function as part of <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replace rel=external target=_blank>String.prototype.replace()</a> on the body of the file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>newBody</span> <span class=o>=</span> <span class=nx>oldBody</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=sr>/^([\d\s\w]+|&#34;[\d\s\w,]+&#34;),(\d+),(\d+&#39;\d+)&#34;$/gm</span><span class=p>,</span> <span class=nx>convertRow</span><span class=p>);</span></span></span></code></pre></div><p>And our <code>newBody</code> variable contains the revised file body (we&rsquo;ll talk about how to <em>get</em> the file body in the first place, either in the browser or with Node, later on).</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=json>JSON</h1><p>JSON is an acronym for <em>JavaScript Object Notation</em>, a serialization format that was developed in conjunction with ECMAScript 3. It is a standard format, as set by <a href=http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf rel=external target=_blank>ECMA-404</a>.</p><h2 id=json-format>JSON Format</h2><p>Essentially, it is a format for transmitting JavaScript objects. Consider the JavaScript object literal notation:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>wilma</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Wilma Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>relationship</span><span class=o>:</span> <span class=s2>&#34;wife&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>pebbles</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Pebbles Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>relationship</span><span class=o>:</span> <span class=s2>&#34;daughter&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>fred</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Fred Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>job</span><span class=o>:</span> <span class=s2>&#34;Quarry Worker&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>payRate</span><span class=o>:</span> <span class=mi>8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>dependents</span><span class=o>:</span> <span class=p>[</span><span class=nx>wilma</span><span class=p>,</span> <span class=nx>pebbles</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>If we were to express the same object in JSON:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Fred Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;job&#34;</span><span class=p>:</span> <span class=s2>&#34;Quarry Worker&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;payRate&#34;</span><span class=p>:</span> <span class=mi>8</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dependents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Wilma Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;relationship&#34;</span><span class=p>:</span> <span class=s2>&#34;wife&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Pebbles Flintstone&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;age&#34;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;relationship&#34;</span><span class=p>:</span> <span class=s2>&#34;daughter&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>As you probably notice, the two are very similar. Two differences probably stand out: First, references (like wilma and pebbles) are replaced with a JSON representation of their values. And second, all property names (the keys) are expressed as strings, not JavaScript symbols.</p><p>A discussion of the full syntax can be found in the <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON rel=external target=_blank>MDN Documentation</a> and also at <a href=https://json.org/ rel=external target=_blank>json.org</a>.</p><h2 id=the-json-object>The JSON Object</h2><p>The JavaScript language provides a JSON object with two very useful functions: <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify rel=external target=_blank>JSON.stringify()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse rel=external target=_blank>JSON.parse()</a>. The first converts any JavaScript variable into a JSON string. Similarly, the second method parses a JSON string and returns what it represents.</p><p>The <code>JSON</code> object is available in browsers and in Node. Open the console and try converting objects and primitives to JSON strings with <code>JSON.stringify()</code> and back with <code>JSON.parse()</code>.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>While JSON was developed in conjunction with JavaScript, it has become a popular exchange format for other languages as well. There are parsing libraries for most major programming languages that can convert JSON strings into native objects:</p><ul><li><a href=https://www.oracle.com/technetwork/articles/java/json-1973242.html rel=external target=_blank>Java</a></li><li><a href=https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/how-to-serialize-and-deserialize-json-data rel=external target=_blank>C#</a></li><li><a href=https://docs.python.org/3/library/json.html rel=external target=_blank>Python</a></li><li><a href=https://github.com/json-c/json-c rel=external target=_blank>C</a></li><li><a href=https://github.com/nlohmann/json rel=external target=_blank>C++</a></li></ul><p>Some (like the Python one) are core language features. Others are open-source projects. There are many more available, just search the web!</p></div></div><h2 id=json-nesting-and-circular-references>JSON Nesting and Circular References</h2><p>While <code>JSON.parse()</code> will handle almost anything you throw at it. Consider this object:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>guy</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Guy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>25</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>hobbies</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;Reading&#34;</span><span class=p>,</span> <span class=s2>&#34;Dancing&#34;</span><span class=p>,</span> <span class=s2>&#34;Fly fishing&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></div><p>It converts just fine - you can see for yourself by pasting this code into the console. But what if we add reference to another object?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>guyMom</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span><span class=o>:</span> <span class=s2>&#34;Guy&#39;s Mom&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>age</span><span class=o>:</span> <span class=mi>52</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>hobbies</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;Knitting&#34;</span><span class=p>,</span> <span class=s2>&#34;Needlework&#34;</span><span class=p>,</span> <span class=s2>&#34;International Espionage&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=nx>guy</span><span class=p>.</span><span class=nx>mother</span> <span class=o>=</span> <span class=nx>guyMom</span><span class=p>;</span></span></span></code></pre></div><p>Try running <code>JSON.stringify()</code> on <code>guy</code> now:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>guy</span><span class=p>);</span></span></span></code></pre></div><p>Notice it works just fine, with Guy&rsquo;s mother now serialized as a part of the <code>guy</code> object. But what if we add a reference from <code>guyMother</code> back to her son?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>guyMom</span><span class=p>.</span><span class=nx>son</span> <span class=o>=</span> <span class=nx>guy</span><span class=p>;</span></span></span></code></pre></div><p>And try <code>JSON.stringify()</code> on <code>guy</code> now&mldr;</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>guy</span><span class=p>);</span></span></span></code></pre></div><p>We get a <code>TypeError: Converting circular structure to JSON</code>. The <code>JSON.stringify</code> algorithm cannot handle this sort of circular reference - it wants to serialize <code>guy</code>, and thus needs to serialize <code>guyMom</code> to represent <code>guy.mother</code>, but in doing so it needs to serialize <code>guy</code> <em>again</em> as <code>guyMother.son</code> references it. This is a potentially infinitely recursive process&mldr; so the algorithm stops and throws an exception as soon as it detects the existence of a circular reference.</p><p>Is there a way around this in practice? Yes - substitute direct references for keys, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>people</span> <span class=o>=</span> <span class=p>{</span><span class=nx>guy</span><span class=o>:</span> <span class=nx>guy</span><span class=p>,</span> <span class=nx>guyMom</span><span class=o>:</span> <span class=nx>guyMom</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nx>guy</span><span class=p>.</span><span class=nx>mother</span> <span class=o>=</span> <span class=s2>&#34;guyMom&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>guyMom</span><span class=p>.</span><span class=nx>son</span> <span class=o>=</span> <span class=s2>&#34;guy&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>peopleJSON</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>people</span><span class=p>);</span></span></span></code></pre></div><p>Now when you deserialize <code>people</code>, you can rebuild the references:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>newPeople</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>peopleJSON</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>newPeople</span><span class=p>[</span><span class=s2>&#34;guy&#34;</span><span class=p>].</span><span class=nx>mother</span> <span class=o>=</span> <span class=nx>newPeople</span><span class=p>[</span><span class=nx>newPeople</span><span class=p>[</span><span class=s2>&#34;guy&#34;</span><span class=p>].</span><span class=nx>mother</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nx>newPeople</span><span class=p>[</span><span class=s2>&#34;guyMom&#34;</span><span class=p>].</span><span class=nx>son</span> <span class=o>=</span> <span class=nx>newPeople</span><span class=p>[</span><span class=nx>newPeople</span><span class=p>[</span><span class=s2>&#34;guyMother&#34;</span><span class=p>].</span><span class=nx>son</span><span class=p>];</span></span></span></code></pre></div><p>Given a standardized format, you can write a helper method to automate this kind of approach.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>The fact that JSON serializes references into objects makes it possible to create deep clones (copies of an object where the references are also clones) using JSON, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>function</span> <span class=nx>deepClone</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>obj</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>If we were to use this method on <code>guy</code> from the above example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>guyClone</span> <span class=o>=</span> <span class=nx>deepClone</span><span class=p>(</span><span class=nx>guy</span><span class=p>);</span></span></span></code></pre></div><p>And then alter some aspect of his mother:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>guyClone</span><span class=p>.</span><span class=nx>mother</span><span class=p>.</span><span class=nx>hobbies</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=s2>&#34;Skydiving&#34;</span><span class=p>);</span></span></span></code></pre></div><p>The original <code>guy</code>&rsquo;s mother will be unchanged, i.e. it will <em>not</em> include Skydiving in her hobbies.</p></div></div><style>.console{position:fixed;bottom:0;left:300px;box-sizing:border-box;z-index:1000;width:calc(100% - 300px);height:30vh;background-color:#8451a1;padding:1rem;transform:translateY(calc(30vh - 5px));transition:transform 1s}.console iframe{width:100%;height:100%;background-color:#fff}.console>.console-tab{position:absolute;top:-1.2rem;right:0;color:#fff;background-color:#8451a1;padding:0 2rem;border-radius:5px;cursor:pointer}.console.active{transform:none}</style><div class=console><div class=console-tab>CONSOLE</div><iframe src=https://jsconsole.com/></iframe></div><script>document.querySelector(".console-tab").addEventListener("click",e=>{console.log(e),e.target.parentElement.classList.toggle("active")})</script><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=ajax>AJAX</h1><p>Asynchronous JavaScript and XML (AJAX) is a term coined by Jesse James Garrett to describe a technique of using the <a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest rel=external target=_blank>XMLHttpRequest</a> object to request resources directly from JavaScript. As the name implies, this was originally used to request XML content, but the technique can be used with any kind of data.</p><h3 id=the-xmlhttprequest>The XMLHttpRequest</h3><p>The <code>XMLHttpRequest</code> object is modeled after how the <code>window</code> object makes web requests. You can think of it as a state machine that can be in one of several possible states, defined by both a constant and an unsigned short value:</p><ul><li><strong>UNSENT</strong> or <strong>0</strong> The client has been created, but no request has been made. Analogous to a just-opened browser before you type an address in the address bar.</li><li><strong>OPENED</strong> or <strong>1</strong> The request has been made, but the response has not been received. The browser analogue would be you have just pressed enter after typing the address.</li><li><strong>HEADERS_RECEIVED</strong> or <strong>2</strong> The first part of the response has been processed. We&rsquo;ll talk about headers in the next chapter.</li><li><strong>LOADING</strong> or <strong>3</strong> The content of the response is being downloaded. In the browser, this would be the stage where the HTML is being received and parsed into the DOM.</li><li><strong>DONE</strong> or <strong>4</strong> The resource is fully loaded. In the DOM, this would be equivalent to the <code>'load'</code> event.</li></ul><p><a href=#R-image-2218affecab46157127aecc1c2404343 class=lightbox-link><img alt="The XMLHttpRequest ready states" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis526/images/3.8.1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2218affecab46157127aecc1c2404343><img alt="The XMLHttpRequest ready states" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis526/images/3.8.1.png></a></p><h4 id=xmlhttprequest-properties>XMLHttpRequest Properties</h4><p>The XMLHttpRequest object also has a number of properties that are helpful:</p><ul><li><code>readyState</code> - the current state of the property</li><li><code>response</code> - the body of the response, an <code>ArrayBuffer</code>, <code>Blob</code>, <code>Document</code>, or <code>DOMString</code> based on the value of the <code>responseType</code></li><li><code>responseType</code> - the mime type of response</li><li><code>status</code> - returns an unsigned short with the HTTP response status (or 0 if the response has not been received)</li><li><code>statusText</code> - returns a string containing the response string fro the server, i.e. <code>"200 OK"</code></li><li><code>timeout</code> - the number of milliseconds the request can take before being terminated</li></ul><h4 id=xmlhttprequest-events>XMLHttpRequest Events</h4><p>The XMLHttpRequest object implements the <code>EventTarget</code> interface, just like the <code>Element</code> and <code>Node</code> of the DOM, so we can attach event listeners with <code>addEventListener()</code>. The specific events we can listen for are:</p><ul><li><code>abort</code> - fired when the request has been aborted (you can abort a request with the <a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/abort rel=external target=_blank>XMLHttpRequest.abort()</a> method)</li><li><code>error</code> - fired when the request encountered an error</li><li><code>load</code> - fired when the request completes successfully</li><li><code>loadend</code> - fired when the request has completed, either because of success or after an abort or error.</li><li><code>loadstart</code> - fired when the request has started to load data</li><li><code>progress</code> - fired periodically as the request receives data</li><li><code>timeout</code> - fired when the progress is expired due to taking too long</li></ul><p>Several of these events have properties you can assign a function to directly to capture the event:</p><ul><li><code>onerror</code> - corresponds to the <code>error</code> event</li><li><code>onload</code> - corresponds to the <code>load</code> event</li><li><code>onloadend</code> - corresponds to the <code>loadend</code> event</li><li><code>onloadstart</code> - corresponds to the <code>loadstart</code> event</li><li><code>onprogress</code> - corresponds to the <code>progress</code> event</li><li><code>ontimeout</code> - corresponds to the <code>timeout</code> event</li></ul><p>In addition, there is an <code>onreadystatechange</code> property which acts like one of these properties and is fired every time the state of the request changes. In older code, you may see it used instead of the <code>load</code> event, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>onreadystatechange</span><span class=p>(</span><span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=nx>xhr</span><span class=p>.</span><span class=nx>readyState</span> <span class=o>===</span> <span class=mi>4</span> <span class=o>&amp;&amp;</span> <span class=nx>xhr</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Request has finished successfully, do logic
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><h3 id=using-ajax>Using AJAX</h3><p>Of course the point of learning about the XMLHttpRequest object is to perform AJAX requests. So let&rsquo;s turn our attention to that task.</p><h4 id=creating-the-xmlhttprequest>Creating the XMLHttpRequest</h4><p>The first step in using AJAX is creating the XMLHttpRequest object. To do so, we simply call its constructor, and assign it to a variable:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>xhr</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>XMLHttpRequest</span><span class=p>();</span></span></span></code></pre></div><p>We can create as many of these requests as we want, so if we have multiple requests to make, we&rsquo;ll usually create a new XMLHttpRequest object for each.</p><h4 id=attaching-the-event-listeners>Attaching the Event Listeners</h4><p>Usually, we&rsquo;ll want to attach our event listener(s) before doing anything else with the <code>XMLHttpRequest</code> object. The reason is simple - because the request happens asynchronously, it is entirely possible the request will be finished <em>before</em> we add the event listener to listen for the <code>load</code> event. In that case, our listener will <em>never</em> trigger.</p><p>At a minimum, you probably want to listen to <code>load</code> events, i.e.:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do something with xhr object
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span></span></span></code></pre></div><p>But it is also a good idea to listen for the <code>error</code> event as well:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// report the error
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span></span></span></code></pre></div><h4 id=opening-the-xmlhttprequest>Opening the XMLHttpRequest</h4><p>Much like when we manually made requests, we first need to open the connection to the server. We do this with the <a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/open rel=external target=_blank>XMLHttpRequest.open()</a> method:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;https://imgs.xkcd.com/comics/blogofractal.png&#39;</span><span class=p>);</span></span></span></code></pre></div><p>The first argument is the <a href=https://textbooks.cs.ksu.edu/cis526/02-http/04-request-methods/ rel=external target=_blank>HTTP request method</a> to use, and the second is the <a href=https://textbooks.cs.ksu.edu/cis526/02-http/05-uris-and-urls/ rel=external target=_blank>URL</a> to open.</p><p>There are also three optional parameters that can be used to follow - a boolean determining if the request should be made asynchronously (default <code>true</code>) and a user and password for HTTP authentication. Since AJAX requests are normally made asynchronously, and HTTP authentication has largely been displaced by more secure authentication approaches, these are rarely used.</p><h4 id=setting-headers>Setting Headers</h4><p>After the <code>XMLHttpRequest</code> has been opened, but before it is sent, you can use <a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/setRequestHeader rel=external target=_blank>XMLHttpRequest.setRequestHeader()</a> to set any <a href=https://textbooks.cs.ksu.edu/cis526/02-http/06-request-headers/ rel=external target=_blank>request headers</a> you need. For example, we might set an <code>Accept</code> header to <code>image/png</code> to indicate we would like image data as our response:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>setRequestHeader</span><span class=p>(</span><span class=s1>&#39;Accept&#39;</span><span class=p>,</span> <span class=s1>&#39;image/png&#39;</span><span class=p>);</span></span></span></code></pre></div><h4 id=sending-the-xmlhttprequest>Sending the XMLHttpRequest</h4><p>Finally, the <a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/send rel=external target=_blank>XMLHttpRequest.send()</a> method will send the request asynchronously (unless the <code>async</code> parameter in <code>XMLHttpRequest.open()</code> was set to <code>false</code>). As the response is received (or fails) the appropriate event handlers will be triggered. To finish our example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>send</span><span class=p>();</span></span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>A second major benefit of the JQuery library (after simplifying DOM querying and manipulation) was its effort to simplify AJAX. It provides a robust wrapper around the <code>XMLHttpRequest</code> object with the <a href=https://api.jquery.com/jquery.ajax/ rel=external target=_blank>jQuery.ajax()</a> method. Consider the AJAX request we defined in this chapter:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kd>var</span> <span class=nx>xhr</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>XMLHttpRequest</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;load&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// do something with xhr object
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// report the error
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s1>&#39;GET&#39;</span><span class=p>,</span> <span class=s1>&#39;https://imgs.xkcd.com/comics/blogofractal.png&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>setRequestHeader</span><span class=p>(</span><span class=s1>&#39;Accept&#39;</span><span class=p>,</span> <span class=s1>&#39;image/png&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>xhr</span><span class=p>.</span><span class=nx>send</span><span class=p>();</span></span></span></code></pre></div><p>The equivalent jQuery code would be:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>jQuery</span><span class=p>.</span><span class=nx>ajax</span><span class=p>(</span><span class=s2>&#34;https://imgs.xkcd.com/comics/blogofractal.png&#34;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;GET&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>Accept</span><span class=o>:</span> <span class=s1>&#39;image/png&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>success</span><span class=o>:</span> <span class=p>(</span><span class=nx>data</span><span class=p>,</span> <span class=nx>status</span><span class=p>,</span> <span class=nx>xhr</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// do something with data
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>error</span><span class=o>:</span> <span class=p>(</span><span class=nx>xhr</span><span class=p>,</span> <span class=nx>status</span><span class=p>,</span> <span class=nx>error</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>        <span class=c1>// report the error 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div><p>Many developers found this all-in-one approach simpler than working directly with <code>XMLHttpRequest</code> objects. The W3C adopted some of these ideas into the Fetch API.</p></div></div><footer class=footline></footer></article></section></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Russell Feldhausen
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis526/commit/41163dc548a00400a9f1d4962b4227b9a8ee4d20>Aug 10, 2023</a></p></div></div><script src=/cis526/js/clipboard.min.js?1739565344 defer></script><script src=/cis526/js/perfect-scrollbar.min.js?1739565344 defer></script><script src=/cis526/js/theme.js?1739565344 defer></script></body></html>