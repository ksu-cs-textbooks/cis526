<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=generator content="Relearn 8.0.0"><meta name=description content="YouTube Video Props So far, we’ve mostly been dealing with data in our Vue components in one of two ways:
It is requested directly from the RESTful API for the component (as in the UsersList and UserEdit components) It is passed in from a parent component, especially if it is a small helper component (as in the RoleChip and TextField components) The only exception is the user’s JSON Web Token (JWT), which we have stored in a Pinia store. However, we didn’t spend much time talking about why we stored that token in a Pinia store instead of just making it a global reactive state component and passing that state down the component tree using props."><meta name=author content="Nathan Bean & Russell Feldhausen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta name=twitter:title content="Pinia :: CIS 526 Textbook"><meta name=twitter:description content="YouTube Video Props So far, we’ve mostly been dealing with data in our Vue components in one of two ways:
It is requested directly from the RESTful API for the component (as in the UsersList and UserEdit components) It is passed in from a parent component, especially if it is a small helper component (as in the RoleChip and TextField components) The only exception is the user’s JSON Web Token (JWT), which we have stored in a Pinia store. However, we didn’t spend much time talking about why we stored that token in a Pinia store instead of just making it a global reactive state component and passing that state down the component tree using props."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/07-advanced-topics/01-pinia/index.html"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Pinia :: CIS 526 Textbook"><meta property="og:description" content="YouTube Video Props So far, we’ve mostly been dealing with data in our Vue components in one of two ways:
It is requested directly from the RESTful API for the component (as in the UsersList and UserEdit components) It is passed in from a parent component, especially if it is a small helper component (as in the RoleChip and TextField components) The only exception is the user’s JSON Web Token (JWT), which we have stored in a Pinia store. However, we didn’t spend much time talking about why we stored that token in a Pinia store instead of just making it a global reactive state component and passing that state down the component tree using props."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-04-26T15:56:55-05:00"><meta property="og:image" content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta itemprop=name content="Pinia :: CIS 526 Textbook"><meta itemprop=description content="YouTube Video Props So far, we’ve mostly been dealing with data in our Vue components in one of two ways:
It is requested directly from the RESTful API for the component (as in the UsersList and UserEdit components) It is passed in from a parent component, especially if it is a small helper component (as in the RoleChip and TextField components) The only exception is the user’s JSON Web Token (JWT), which we have stored in a Pinia store. However, we didn’t spend much time talking about why we stored that token in a Pinia store instead of just making it a global reactive state component and passing that state down the component tree using props."><meta itemprop=dateModified content="2025-04-26T15:56:55-05:00"><meta itemprop=wordCount content="2365"><meta itemprop=image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><title>Pinia :: CIS 526 Textbook</title><link href=https://textbooks.cs.ksu.edu/cis526/x-examples/07-advanced-topics/01-pinia/index.html rel=canonical type=text/html title="Pinia :: CIS 526 Textbook"><link href=/cis526/x-examples/07-advanced-topics/01-pinia/index.xml rel=alternate type=application/rss+xml title="Pinia :: CIS 526 Textbook"><link href=/cis526/x-examples/07-advanced-topics/01-pinia/index.print.html rel=alternate type=text/html title="Pinia :: CIS 526 Textbook"><link href=/cis526/x-examples/07-advanced-topics/01-pinia/embed.html rel=alternate type=text/html title="Pinia :: CIS 526 Textbook"><link href=/cis526/css/auto-complete/auto-complete.min.css?1769117712 rel=stylesheet><script src=/cis526/js/auto-complete/auto-complete.min.js?1769117712 defer></script><script src=/cis526/js/search-lunr.min.js?1769117712 defer></script><script src=/cis526/js/search.min.js?1769117712 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/cis526/searchindex.en.js?1769117712"</script><script src=/cis526/js/lunr/lunr.min.js?1769117712 defer></script><script src=/cis526/js/lunr/lunr.stemmer.support.min.js?1769117712 defer></script><script src=/cis526/js/lunr/lunr.multi.min.js?1769117712 defer></script><script src=/cis526/js/lunr/lunr.en.min.js?1769117712 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1769117712 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1769117712 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar/perfect-scrollbar.min.css?1769117712 rel=stylesheet><link href=/cis526/css/theme.min.css?1769117712 rel=stylesheet><link href=/cis526/css/format-html.min.css?1769117712 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/x-examples/07-advanced-topics/01-pinia/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!1,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["light-theme"],window.relearn.customvariantname="my-custom-variant",window.relearn.writeVariant=!1,window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.writeVariant&&window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=/cis526/css/custom.css?1769117712 rel=stylesheet></head><body class="mobile-support html" data-url=/cis526/x-examples/07-advanced-topics/01-pinia/index.html><div id=tele class="tele mirror"><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable x-examples" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=pinia>Pinia</h1><a href="https://www.youtube.com/watch?v=YioSayQjW70">YouTube Video</a><h2 id=props>Props</h2><p>So far, we&rsquo;ve mostly been dealing with data in our Vue components in one of two ways:</p><ol><li>It is requested directly from the RESTful API for the component (as in the <code>UsersList</code> and <code>UserEdit</code> components)</li><li>It is passed in from a parent component, especially if it is a small helper component (as in the <code>RoleChip</code> and <code>TextField</code> components)</li></ol><p>The only exception is the user&rsquo;s JSON Web Token (JWT), which we have stored in a Pinia store. However, we didn&rsquo;t spend much time talking about <em>why</em> we stored that token in a Pinia store instead of just making it a global reactive state component and passing that state down the component tree using props.</p><p>The concept of passing props down through components, especially between many layers of components, is known as <a href=https://vuejs.org/guide/components/provide-inject rel=external target=_blank>Prop Drilling</a></p><p><a href=#R-image-82e7195f1c9d8dd6d79d85027df99d85 class=lightbox-link><img alt="Prop Drilling" class="border lazy lightbox figure-image" loading=lazy src=/cis526/images/examples/07/prop-drilling.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-82e7195f1c9d8dd6d79d85027df99d85><img alt="Prop Drilling" class="border lazy lightbox lightbox-image" loading=lazy src=/cis526/images/examples/07/prop-drilling.png></a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>While this method can work well, it can also make an application very complicated with the sheer number of props that must be passed through each component. For example, imagine if each page and component needed access to the user&rsquo;s JWT to determine which actions to allow (a very real example from the project we are working). In that case, each component may need to be aware of the token as an incoming prop, and may also need to pass it along to any child components that may need it, even if it is three or four layers deep.</p><h2 id=provide--inject>Provide / Inject</h2><p>The Vue framework itself does have a solution to this problem, which is the <a href=https://vuejs.org/guide/components/provide-inject rel=external target=_blank>Provide / Inject</a> interface. In effect, a component can declare a reactive state item and add it to a global dictionary of state items that are available using the <code>provide</code> method along with a unique key for that item, and any other component can receive a reference to that state item using the <code>inject</code> method with the same key.</p><p><a href=#R-image-b0bcce424a0eeeb67abbc0c9c6cdc7d9 class=lightbox-link><img alt="Provide Inject" class="border lazy lightbox figure-image" loading=lazy src=/cis526/images/examples/07/provide-inject.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0bcce424a0eeeb67abbc0c9c6cdc7d9><img alt="Provide Inject" class="border lazy lightbox lightbox-image" loading=lazy src=/cis526/images/examples/07/provide-inject.png></a><sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>This is a bit of an improvement, but still has many issues that are discussed in the documentation. For example, it is best to only modify the state at the top-level component that is providing the state, so an additional function may need to be provided to enable proper editing of the state. In addition, for large apps it can be very difficult to ensure that each key is unique, and having hundreds or thousands of keys to keep track of can be a huge burden for programmers.</p><h2 id=pinia>Pinia</h2><p>The <a href=https://pinia.vuejs.org/ rel=external target=_blank>Pinia</a> library tries to solve all of these issues by providing convenient <em>stores</em> for different types of information in the application. Each store is typically oriented toward a specific type of data (such as users or documents), and it contains all the methods needed to read and modify the state as needed. Then, each component that needs access to the state can simply request a reference to the stores it needs, and everything is nicely compartmentalized and easy to maintain.</p><p>To see how this can help simplify our application, let&rsquo;s look at how we can create a <code>Users</code> store to interface with our RESTful API and maintain a globally-accessible store for data about our users.</p><h2 id=creating-a-pinia-store>Creating a Pinia Store</h2><p>To create a Pinia store, we can create a new file <code>src/stores/User.js</code> with the following initial content:</p><div class=tab-panel data-tab-group=ce611a26408e18573169c86cf2fa2192><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcstoresuserjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ce611a26408e18573169c86cf2fa2192","srcstoresuserjs")'>
<span class=tab-nav-text>src/stores/User.js</span></button></div><div class=tab-content-container><div data-tab-item=srcstoresuserjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @file User Store
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Libraries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ref</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>defineStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;pinia&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>api</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/configs/api&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define Store
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useUserStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>defineStore</span>(<span style=color:#e6db74>&#39;user&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// State Properties
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Getters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Return all state, getters, and actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> { }
</span></span><span style=display:flex><span>})</span></span></code></pre></div></div></div></div></div><p>This is a nice starting structure for a store. At the bare minimum, we use the <a href=https://pinia.vuejs.org/core-concepts/ rel=external target=_blank>defineStore</a> method from Pinia to create the store. Inside of that method is a lambda function that actually defines the contents of the store itself, which we&rsquo;ll iteratively build over time. We&rsquo;ve also imported a few useful library functions, including our pre-built Axios API interface to make it easy to send requests to our API.</p><h2 id=properties>Properties</h2><p>The first items we should add to our Pinia store are the state properties that we&rsquo;ll be tracking. These can be anything from simple values all the way up to entire arrays of objects full of data. In most cases, it makes sense to have each Pinia store track data in a format similar to what our application will need. For this example, we&rsquo;ll use this store to track both the <code>users</code> and <code>roles</code> that are available in our system. So, we&rsquo;ll need to create two reactive state variables using the <code>ref()</code> function from Vue to store that data as state in our Pinia store:</p><div class=tab-panel data-tab-group=3493e16ba8695225298546d4b70878bd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcstoresuserjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3493e16ba8695225298546d4b70878bd","srcstoresuserjs")'>
<span class=tab-nav-text>src/stores/User.js</span></button></div><div class=tab-content-container><div data-tab-item=srcstoresuserjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define Store
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useUserStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>defineStore</span>(<span style=color:#e6db74>&#39;user&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// State Properties
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>users</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>([])
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>roles</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>([])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Getters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Return all state, getters, and actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>roles</span> }
</span></span><span style=display:flex><span>})</span></span></code></pre></div></div></div></div></div><p>Each state property in Pinia is just a reactive state variable from Vue that can be shared across our entire application. So, we&rsquo;ll just initialize each one to an empty array for now.</p><h2 id=actions---hydrate>Actions - Hydrate</h2><p>Before we tackle any getters, let&rsquo;s look at how we can actually get this data from our RESTful API. In many web development frameworks, the process of loading data from the AI is sometimes referred to as <a href=https://en.wikipedia.org/wiki/Hydration_(web_development) rel=external target=_blank>Hydration</a>. So, let&rsquo;s write a method we can use the <em>hydrate</em> these two state variables by making a request to our RESTful API. Most of this code is lifted directly from our existing <code>UsersList</code> component:</p><div class=tab-panel data-tab-group=05c5eb9268c9975ccf524d87fdc22db0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcstoresuserjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("05c5eb9268c9975ccf524d87fdc22db0","srcstoresuserjs")'>
<span class=tab-nav-text>src/stores/User.js</span></button></div><div class=tab-content-container><div data-tab-item=srcstoresuserjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define Store
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useUserStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>defineStore</span>(<span style=color:#e6db74>&#39;user&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * Load users and roles from the API
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>hydrate</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>api</span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/v1/users&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>api</span>
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;/api/v1/roles&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>roles</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Return all state, getters, and actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>roles</span>, <span style=color:#a6e22e>hydrate</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>})</span></span></code></pre></div></div></div></div></div><p>As we can see, this function will make two asynchronous requests to the RESTful API to load both the users and roles, and when those requests are resolved it will store the data in the appropriate state variable.</p><h2 id=getters>Getters</h2><p>For this Pinia store, we won&rsquo;t need any individual getters. Instead, we&rsquo;ll just use some functions in the component as needed to extract data from the store.</p><h2 id=actions---save--delete>Actions - Save & Delete</h2><p>Finally, let&rsquo;s add two more actions to allow us to both save and delete a user through our RESTful API. The code for the <code>save</code> function is mostly taken from our <code>UserEdit</code> component, while the code to delete a user comes from the <code>UserList</code> component, both with minor changes.</p><div class=tab-panel data-tab-group=0edc88da20dec312927ddd712f6787c5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcstoresuserjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("0edc88da20dec312927ddd712f6787c5","srcstoresuserjs")'>
<span class=tab-nav-text>src/stores/User.js</span></button></div><div class=tab-content-container><div data-tab-item=srcstoresuserjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Define Store
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>useUserStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>defineStore</span>(<span style=color:#e6db74>&#39;user&#39;</span>, () =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * Save a user
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>saveUser</span>(<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>user</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>method</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;post&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/api/v1/users&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>id</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;put&#39;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>id</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>api</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>method</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>method</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>url</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>url</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>value</span>,
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// rehydrate data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>hydrate</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Error saving user!&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e>   * Delete a user
</span></span></span><span style=display:flex><span><span style=color:#75715e>   */</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>deleteUser</span>(<span style=color:#a6e22e>id</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>api</span>
</span></span><span style=display:flex><span>      .<span style=color:#66d9ef>delete</span>(<span style=color:#e6db74>&#39;/api/v1/users/&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>id</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// rehydrate data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>hydrate</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>response</span>
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>      .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Error deleting user!&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>throw</span> <span style=color:#a6e22e>error</span>;
</span></span><span style=display:flex><span>      })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Return all state, getters, and actions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>roles</span>, <span style=color:#a6e22e>hydrate</span>, <span style=color:#a6e22e>saveUser</span>, <span style=color:#a6e22e>deleteUser</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>})</span></span></code></pre></div></div></div></div></div><p>As we can see in the code above, after each successful API call, we immediately call the <code>hydrate</code> method to update the contents of our <code>users</code> and <code>roles</code> list before passing the response back to the calling method. This ensures that our data is always in sync with the RESTful API backend anytime we make a change. In addition, we are carefully logging any errors we receive here, but we are still throwing the errors back to the calling method so they can be handled there as well.</p><p>That is the basic contents of our <code>Users</code> store, which we can use throughout our application.</p><h2 id=using-a-store---userslist>Using a Store - UsersList</h2><p>Now, let&rsquo;s look at how we can use our store in our various components that require data from the <code>Users</code> and <code>Roles</code> APIs. First, we can take a look at our existing <code>UsersList</code> component - there are many lines that we&rsquo;ll remove or change within the component. Each change is highlighted and described below, with removed lines commented out.</p><div class=tab-panel data-tab-group=283ee609f5aa171dc558f04174da5ab5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersuserslistvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("283ee609f5aa171dc558f04174da5ab5","srccomponentsusersuserslistvue")'>
<span class=tab-nav-text>src/components/users/UsersList.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersuserslistvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Create Reactive State
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// const users = ref([])
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// const roles = ref([])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Stores
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>storeToRefs</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;pinia&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useUserStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/stores/User&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>userStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useUserStore</span>();
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>roles</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>storeToRefs</span>(<span style=color:#a6e22e>userStore</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>First, we replace the two reactive state variables for <code>users</code> and <code>roles</code> with the same state variables that are extracted from the Pinia store using the <code>storeToRefs()</code> function, which will <a href=https://pinia.vuejs.org/core-concepts/#Destructuring-from-a-Store rel=external target=_blank>Destructure the Store</a> and make the variables directly available to our code.</p><div class=tab-panel data-tab-group=064c606525334771fa8dd81c245a995f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersuserslistvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("064c606525334771fa8dd81c245a995f","srccomponentsusersuserslistvue")'>
<span class=tab-nav-text>src/components/users/UsersList.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersuserslistvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Load Users
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//api
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .get(&#39;/api/v1/users&#39;)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .then(function (response) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//    users.value = response.data
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  })
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .catch(function (error) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//    console.log(error)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  })
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Load Roles
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//api
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .get(&#39;/api/v1/roles&#39;)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .then(function (response) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//    roles.value = response.data
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  })
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  .catch(function (error) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//    console.log(error)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//  })
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Hydrate Store
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#a6e22e>userStore</span>.<span style=color:#a6e22e>hydrate</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>Next, we can replace all of the code used to load the users and roles on the page to a simple call to the <code>hydrate</code> method in the store itself.</p><div class=tab-panel data-tab-group=fb36d863d73cf1b08ef2644797db8b06><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersuserslistvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("fb36d863d73cf1b08ef2644797db8b06","srccomponentsusersuserslistvue")'>
<span class=tab-nav-text>src/components/users/UsersList.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersuserslistvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Delete User
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>deleteUser</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>id</span>) {
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#75715e>// api
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  <span style=color:#75715e>//   .delete(&#39;/api/v1/users/&#39; + id)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  <span style=color:#a6e22e>userStore</span>.<span style=color:#a6e22e>deleteUser</span>(<span style=color:#a6e22e>id</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>200</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>toast</span>.<span style=color:#a6e22e>add</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;success&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Success&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>message</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>life</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex;background-color:#3c3d38><span>        <span style=color:#75715e>// Remove that element from the reactive array
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>        <span style=color:#75715e>// users.value.splice(
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>        <span style=color:#75715e>//   users.value.findIndex((u) =&gt; u.id == id),
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>        <span style=color:#75715e>//   1,
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>        <span style=color:#75715e>// )
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>toast</span>.<span style=color:#a6e22e>add</span>({ <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Error&#39;</span>, <span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>error</span>, <span style=color:#a6e22e>life</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span> })
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>Finally, in the method to delete a user, we can replace the API call with a call to the <code>deleteUser</code> method inside of the Pinia store to handle deleting the user with the selected ID. We can also remove the code that will remove the user from the list, since we no longer need to do that here; instead, the Pinia store will query the updated data from the RESTful API, and the user should no longer be present in that data when it is received.</p><p>Those are all of the changes needed to switch the <code>UsersList</code> component to use the store. The template itself remains exactly the same.</p><h2 id=using-a-store---useredit>Using a Store - UserEdit</h2><p>We can also update our <code>UserEdit</code> component in a similar way:</p><div class=tab-panel data-tab-group=45c08b0db92439d25efec23fece4b5c6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersusereditvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("45c08b0db92439d25efec23fece4b5c6","srccomponentsusersusereditvue")'>
<span class=tab-nav-text>src/components/users/UserEdit.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersusereditvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Libraries
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ref</span>, <span style=color:#a6e22e>computed</span>, <span style=color:#a6e22e>inject</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Declare State
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// const user = ref({})
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// const roles = ref([])
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>errors</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ref</span>([])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Stores
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>storeToRefs</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;pinia&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useUserStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/stores/User&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>userStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useUserStore</span>();
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>users</span>, <span style=color:#a6e22e>roles</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>storeToRefs</span>(<span style=color:#a6e22e>userStore</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Find single user or a blank user
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>user</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>computed</span>(() =&gt; {
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>users</span>.<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>find</span>((<span style=color:#a6e22e>u</span>) =&gt; <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>id</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>id</span>) <span style=color:#f92672>||</span> { <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#a6e22e>roles</span><span style=color:#f92672>:</span> [] })
</span></span><span style=display:flex;background-color:#3c3d38><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>First, we can replace the reactive state variables with the same variables from the Users store. To get a single user, we can create a computed state variable that will find the user in the list that matches the incoming <code>props.id</code>. If a user can&rsquo;t be found, it will generate a blank <code>User</code> object that can be used to create a new user.</p><p>Likewise, we can remove all of the code that loads users and roles and replace that with a <code>hydrate</code> function call in our Pinia store:</p><div class=tab-panel data-tab-group=8ea34d97dc0a0b23eae5beb60c02e167><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersusereditvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8ea34d97dc0a0b23eae5beb60c02e167","srccomponentsusersusereditvue")'>
<span class=tab-nav-text>src/components/users/UserEdit.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersusereditvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Load Users
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// if (props.id) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   api
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     .get(&#39;/api/v1/users/&#39; + props.id)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     .then(function (response) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//       user.value = response.data
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     })
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     .catch(function (error) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//       console.log(error)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     })
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// } else {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   // Empty Value for User Object
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   user.value = {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     username: &#39;&#39;,
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     roles: [],
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   }
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Load Roles
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// api
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   .get(&#39;/api/v1/roles&#39;)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   .then(function (response) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     roles.value = response.data
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   })
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   .catch(function (error) {
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//     console.log(error)
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//   })
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#a6e22e>userStore</span>.<span style=color:#a6e22e>hydrate</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>Finally, we can replace the call to the <code>api</code> library to save the user with a call to the <code>saveUser</code> method in the <code>UserStore</code>:</p><div class=tab-panel data-tab-group=7981d6ca8f09584c2ecd9f928c76cf03><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsusersusereditvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("7981d6ca8f09584c2ecd9f928c76cf03","srccomponentsusersusereditvue")'>
<span class=tab-nav-text>src/components/users/UserEdit.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsusersusereditvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Save User
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>save</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>userStore</span>.<span style=color:#a6e22e>saveUser</span>(<span style=color:#a6e22e>props</span>.<span style=color:#a6e22e>id</span>, <span style=color:#a6e22e>user</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>then</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>201</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>toast</span>.<span style=color:#a6e22e>add</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;success&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Success&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>message</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>life</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>push</span>({ <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;users&#39;</span> })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#66d9ef>catch</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>422</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>toast</span>.<span style=color:#a6e22e>add</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;warn&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Warning&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>error</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>life</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>,
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>errors</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>errors</span>
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>toast</span>.<span style=color:#a6e22e>add</span>({ <span style=color:#a6e22e>severity</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#a6e22e>summary</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Error&#39;</span>, <span style=color:#a6e22e>detail</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>error</span>, <span style=color:#a6e22e>life</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span> })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>With those changes in place, we can also edit our users and create new users.</p><h2 id=using-a-store---roles>Using a Store - Roles</h2><p>Finally, we can update our <code>RolesList</code> to also use the store:</p><div class=tab-panel data-tab-group=a285aeabb8bd7dc75c4b96f31d14786e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentsrolesroleslistvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("a285aeabb8bd7dc75c4b96f31d14786e","srccomponentsrolesroleslistvue")'>
<span class=tab-nav-text>src/components/roles/RolesList.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentsrolesroleslistvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-vue data-lang=vue><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>setup</span>&gt;
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Stores
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>storeToRefs</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;pinia&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useUserStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/stores/User&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>userStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useUserStore</span>();
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>roles</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>storeToRefs</span>(<span style=color:#a6e22e>userStore</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Hydrate Store
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#a6e22e>userStore</span>.<span style=color:#a6e22e>hydrate</span>()
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;</span></span></code></pre></div></div></div></div></div><p>At this point, all API calls to the <code>users</code> and <code>roles</code> endpoints should now be routed through our <code>User</code> Pinia store.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Image Source: <a href=https://vuejs.org/guide/components/provide-inject rel=external target=_blank>Pinia Documentation</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article></div></main></div><script src=/cis526/js/clipboard/clipboard.min.js?1769117712 defer></script><script src=/cis526/js/perfect-scrollbar/perfect-scrollbar.min.js?1769117712 defer></script><script src=/cis526/js/theme.min.js?1769117712 defer></script></div><script src=/cis526/js/tele-scroll.min.js?1769117712 defer></script></body></html>