<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=generator content="Relearn 8.0.0"><meta name=description content="YouTube Video Warning In this video, the new api.js file was accidentally created in the router folder. It should be moved to the configs folder, which is shown in the next video.
Automatically Logging In One thing we may quickly realize as we use our application as it currently stands is that the user has to click the â€œLoginâ€ button twice to actually get logged into the system. That seems a bit counterintuitive, so we should take a minute to try and fix that."><meta name=author content="Nathan Bean & Russell Feldhausen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta name=twitter:title content="Route Guards :: CIS 526 Textbook"><meta name=twitter:description content="YouTube Video Warning In this video, the new api.js file was accidentally created in the router folder. It should be moved to the configs folder, which is shown in the next video.
Automatically Logging In One thing we may quickly realize as we use our application as it currently stands is that the user has to click the â€œLoginâ€ button twice to actually get logged into the system. That seems a bit counterintuitive, so we should take a minute to try and fix that."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/05-vue-starter/10-routeguard/index.html"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Route Guards :: CIS 526 Textbook"><meta property="og:description" content="YouTube Video Warning In this video, the new api.js file was accidentally created in the router folder. It should be moved to the configs folder, which is shown in the next video.
Automatically Logging In One thing we may quickly realize as we use our application as it currently stands is that the user has to click the â€œLoginâ€ button twice to actually get logged into the system. That seems a bit counterintuitive, so we should take a minute to try and fix that."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-04-05T18:31:19-05:00"><meta property="og:image" content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta itemprop=name content="Route Guards :: CIS 526 Textbook"><meta itemprop=description content="YouTube Video Warning In this video, the new api.js file was accidentally created in the router folder. It should be moved to the configs folder, which is shown in the next video.
Automatically Logging In One thing we may quickly realize as we use our application as it currently stands is that the user has to click the â€œLoginâ€ button twice to actually get logged into the system. That seems a bit counterintuitive, so we should take a minute to try and fix that."><meta itemprop=dateModified content="2025-04-05T18:31:19-05:00"><meta itemprop=wordCount content="1237"><meta itemprop=image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><title>Route Guards :: CIS 526 Textbook</title><link href=https://textbooks.cs.ksu.edu/cis526/x-examples/05-vue-starter/10-routeguard/index.html rel=canonical type=text/html title="Route Guards :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/10-routeguard/index.xml rel=alternate type=application/rss+xml title="Route Guards :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/10-routeguard/tele.html rel=alternate type=text/html title="Route Guards :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/10-routeguard/embed.html rel=alternate type=text/html title="Route Guards :: CIS 526 Textbook"><link href=/cis526/css/auto-complete/auto-complete.min.css?1768424848 rel=stylesheet><script src=/cis526/js/auto-complete/auto-complete.min.js?1768424848 defer></script><script src=/cis526/js/search-lunr.min.js?1768424848 defer></script><script src=/cis526/js/search.min.js?1768424848 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/cis526/searchindex.en.js?1768424848"</script><script src=/cis526/js/lunr/lunr.min.js?1768424848 defer></script><script src=/cis526/js/lunr/lunr.stemmer.support.min.js?1768424848 defer></script><script src=/cis526/js/lunr/lunr.multi.min.js?1768424848 defer></script><script src=/cis526/js/lunr/lunr.en.min.js?1768424848 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1768424848 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1768424848 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar/perfect-scrollbar.min.css?1768424848 rel=stylesheet><link href=/cis526/css/theme.min.css?1768424848 rel=stylesheet><link href=/cis526/css/format-print.min.css?1768424848 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/x-examples/05-vue-starter/10-routeguard/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!1,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["light-theme"],window.relearn.customvariantname="my-custom-variant",window.relearn.writeVariant=!1,window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.writeVariant&&window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=/cis526/css/custom.css?1768424848 rel=stylesheet></head><body class="mobile-support print" data-url=/cis526/x-examples/05-vue-starter/10-routeguard/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#automatically-logging-in>Automatically Logging In</a></li><li><a href=#router-navigation-guards>Router Navigation Guards</a></li><li><a href=#axios-interceptors>Axios Interceptors</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement class=a11y-only><a itemprop=item href=/cis526/index.html><span itemprop=name>Web Application Development</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis526/x-examples/index.html><span itemprop=name>Example Projects</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis526/x-examples/05-vue-starter/index.html><span itemprop=name>Vue.js Starter Project</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Route Guards</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-edit" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=https://github.com/ksu-cs-textbooks/cis526/edit/main/content/x-examples/05-vue-starter/10-routeguard.md rel=external target=_blank title="Edit (CTRL+ALT+w)"><i class="fa-fw fas fa-pen"></i></a></div><div class="topbar-button topbar-button-print" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/05-vue-starter/10-routeguard/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></div><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/05-vue-starter/09-auth/index.html title="Authentication (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/05-vue-starter/11-accessing-api/index.html title="Accessing API (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more><div class="topbar-button topbar-button-embed" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/05-vue-starter/10-routeguard/embed.html title="Embeddable Version"><i class="fa-fw fas fa-expand-arrows-alt"></i></a></div><div class="topbar-button topbar-button-tele" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/05-vue-starter/10-routeguard/tele.html title="Teleprompter View"><i class="fa-fw fas fa-tv"></i></a></div></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable x-examples" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=route-guards>Route Guards</h1><a href="https://www.youtube.com/watch?v=sK_-Cyn89T4">YouTube Video</a><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>In this video, the new <code>api.js</code> file was accidentally created in the <code>router</code> folder. It should be moved to the <code>configs</code> folder, which is shown in the next video.</p></div></details><h2 id=automatically-logging-in>Automatically Logging In</h2><p>One thing we may quickly realize as we use our application as it currently stands is that the user has to click the &ldquo;Login&rdquo; button twice to actually get logged into the system. That seems a bit counterintuitive, so we should take a minute to try and fix that.</p><p>Effectively, we want our application to try and request a token on behalf of the user behind the scenes as soon as the page is loaded. If a token can be received, we know the user is actually logged in and we can update the user interface accordingly. There are several approaches to do this:</p><ul><li>We can place this code in our top-level <code>App.vue</code> file - this will ensure it runs when any part of the web application is loaded</li><li>We can place it in a <a href=https://router.vuejs.org/guide/advanced/navigation-guards.html rel=external target=_blank>Navigation Guard</a> inside of our Vue Router. This will allow us to make sure the user is logged in, and we can even automatically redirect the user if they try to access something that requires them to log in first</li></ul><p>So, let&rsquo;s add a global navigation guard to our router, ensuring that we only have a single place that requests a token when the user first lands on the page.</p><h2 id=router-navigation-guards>Router Navigation Guards</h2><p>To do this, we need to edit the <code>src/router/index.js</code> to add a special <code>beforeEach</code> function to the router:</p><div class=tab-panel data-tab-group=2067d492cfe1b08f2e67c6df63b15f25><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcrouterindexjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2067d492cfe1b08f2e67c6df63b15f25","srcrouterindexjs")'>
<span class=tab-nav-text>src/router/index.js</span></button></div><div class=tab-content-container><div data-tab-item=srcrouterindexjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @file Vue Router for the application
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @exports router a Vue Router
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Libraries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createRouter</span>, <span style=color:#a6e22e>createWebHistory</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue-router&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Import Stores
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useTokenStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/stores/Token&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Views
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>HomeView</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../views/HomeView.vue&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createRouter</span>({
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Configure History Mode
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>history</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>createWebHistory</span>(<span style=color:#66d9ef>import</span>.<span style=color:#a6e22e>meta</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>BASE_URL</span>),
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Configure routes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>routes</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;home&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>component</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>HomeView</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>path</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/about&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;about&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#75715e>// route level code-splitting
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// this generates a separate chunk (About.[hash].js) for this route
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// which is lazy-loaded when the route is visited.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>component</span><span style=color:#f92672>:</span> () =&gt; <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;../views/AboutView.vue&#39;</span>),
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>//Global Route Guard
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>beforeEach</span>(<span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>to</span>) =&gt; {
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#75715e>// Load Token Store
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tokenStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useTokenStore</span>();
</span></span><span style=display:flex;background-color:#3c3d38><span>
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#75715e>// Allow access to &#39;home&#39; and &#39;about&#39; routes automatically
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>noLoginRequired</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;home&#39;</span>, <span style=color:#e6db74>&#39;about&#39;</span>]
</span></span><span style=display:flex;background-color:#3c3d38><span>
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>noLoginRequired</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>to</span>.<span style=color:#a6e22e>name</span>)) {
</span></span><span style=display:flex;background-color:#3c3d38><span>    <span style=color:#75715e>// If there is no token already
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex;background-color:#3c3d38><span>      <span style=color:#75715e>// Request a token in the background 
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>      <span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>getToken</span>()
</span></span><span style=display:flex;background-color:#3c3d38><span>    }
</span></span><span style=display:flex;background-color:#3c3d38><span>
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#75715e>// For all other routes
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex;background-color:#3c3d38><span>    <span style=color:#75715e>// If there is no token already
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex;background-color:#3c3d38><span>      <span style=color:#75715e>// Request a token and redirect if not logged in 
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span>      <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>getToken</span>(<span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex;background-color:#3c3d38><span>    }
</span></span><span style=display:flex;background-color:#3c3d38><span>  }
</span></span><span style=display:flex;background-color:#3c3d38><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>router</span></span></span></code></pre></div></div></div></div></div><p>In this navigation guard, we have identified two routes, <code>'home'</code> and <code>'about'</code> that don&rsquo;t require the user to log in first. So, if the route matches either of those, we request a token in the background if we don&rsquo;t already have one, but we don&rsquo;t <code>await</code> that function since we don&rsquo;t need it in order to complete the process. However, for all other routes that we&rsquo;ll create later in this project, we will <code>await</code> on the <code>tokenStore.getToken()</code> function to ensure that the user has a valid token available before allowing the application to load the next page. As we continue to add features to our application, we&rsquo;ll see that this is a very powerful way to keep track of our user and ensure they are always properly authenticated.</p><h2 id=axios-interceptors>Axios Interceptors</h2><p>We can also simplify one other part of our application by automatically configuring Axios with a few additional settings that will automatically inject the <code>Authorization: Bearer</code> header into each request, as well as silently requesting a new JWT token if ours appears to have expired.</p><p>For this, we&rsquo;ll create a new folder called <code>src/configs</code> and place a new file <code>api.js</code> inside of that folder with the following content:</p><div class=tab-panel data-tab-group=736260d4c1ef6bebb0e41a68ac5c7609><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcconfigsapijs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("736260d4c1ef6bebb0e41a68ac5c7609","srcconfigsapijs")'>
<span class=tab-nav-text>src/configs/api.js</span></button></div><div class=tab-content-container><div data-tab-item=srcconfigsapijs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @file Axios Configuration and Interceptors
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Libraries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Stores
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useTokenStore</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@/stores/Token&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Axios Instance Setup
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>api</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>create</span>({
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Accept</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;application/json&#39;</span>,
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Add Interceptors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>setupAxios</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Configure Requests
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>config</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// If we are not trying to get a token or API versions, send the token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>url</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;/auth/token&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>url</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;/api&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tokenStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useTokenStore</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>token</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>[<span style=color:#e6db74>&#39;Authorization&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Bearer &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>token</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// If we receive any errors, reject with the error
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    (<span style=color:#a6e22e>error</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Configure Response
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>api</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>use</span>(
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Do not modify the response
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    (<span style=color:#a6e22e>res</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>res</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Gracefully handle errors
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>err</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// Store original request config
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>config</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>config</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// If we are not trying to request a token but we get an error message
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>url</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;/auth/token&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// If the error is a 401 unauthorized, we might have a bad token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>401</span>) {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// Prevent infinite loops by tracking retries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>_retry</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>_retry</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>// Try to request a new token
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tokenStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useTokenStore</span>();
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>getToken</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              <span style=color:#75715e>// Retry the original request
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>api</span>(<span style=color:#a6e22e>config</span>)
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>error</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// This is a retry, so force an authentication
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tokenStore</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useTokenStore</span>();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>tokenStore</span>.<span style=color:#a6e22e>getToken</span>(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#75715e>// If we can&#39;t handle it, return the error
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span> Promise.<span style=color:#a6e22e>reject</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>api</span>, <span style=color:#a6e22e>setupAxios</span> }</span></span></code></pre></div></div></div></div></div><p>This file configures an Axios instance to only accept <code>application/json</code> requests, which makes sense for our application. Then, in the <code>setupAxios</code> function, it will add some basic interceptors to modify any requests sent from this instance as well as responses received:</p><ul><li>If we try to request any URL other than <code>/auth/token</code> and <code>/api</code>, we&rsquo;ll assume that the user is accessing a route that requires a valid bearer token. So, we can automatically inject that into our request.</li><li>When we receive an error as a response, we&rsquo;ll check to see if it is an HTTP 401 Unauthorized error. If it comes from any URL except the <code>/auth/token</code> URL, we can assume that we might have an invalid token. So, we&rsquo;ll quickly try to request one in the background, and then retry the original request once. If it fails a second time, we&rsquo;ll redirect the user back to the login page so they can re-authenticate with the system.</li></ul><p>To use these interceptors, we must first enable them in the <code>src/main.js</code> file:</p><div class=tab-panel data-tab-group=328b82ca49086b0d8e97b7c76306514a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcmainjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("328b82ca49086b0d8e97b7c76306514a","srcmainjs")'>
<span class=tab-nav-text>src/main.js</span></button></div><div class=tab-content-container><div data-tab-item=srcmainjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>/**
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @file Main Vue application
</span></span></span><span style=display:flex><span><span style=color:#75715e> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e> */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Libraries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createApp</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createPinia</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;pinia&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>PrimeVue</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;primevue/config&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Aura</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@primeuix/themes/aura&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Tooltip</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;primevue/tooltip&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import CSS
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;./assets/main.css&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Vue App
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>App</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./App.vue&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Import Configurations
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>router</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./router&#39;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>setupAxios</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./configs/api&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create Vue App
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>app</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createApp</span>(<span style=color:#a6e22e>App</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Install Libraries
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>createPinia</span>())
</span></span><span style=display:flex><span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>router</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>PrimeVue</span>, {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Theme Configuration
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>theme</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>preset</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Aura</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>darkModeSelector</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;.app-dark-mode&#39;</span>,
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Install Directives
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>directive</span>(<span style=color:#e6db74>&#39;tooltip&#39;</span>, <span style=color:#a6e22e>Tooltip</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e>// Setup Interceptors
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#75715e></span><span style=color:#a6e22e>setupAxios</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Mount Vue App on page
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>mount</span>(<span style=color:#e6db74>&#39;#app&#39;</span>)</span></span></code></pre></div></div></div></div></div><p>Now, anytime we want to request data from a protected route, we can use the <code>api</code> instance of Axios that we configured!</p><footer class=footline></footer></article></div></main><div class=git-footer><p class=theme-version-footer>8.0.0</p><p>Last modified by:
<i class='fa-fw fas fa-user'></i> Russell Feldhausen
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis526/commit/afd035a8f2cc9f8006f8fff543a247a17e0015fb>Apr 5, 2025</a></p></div></div><script src=/cis526/js/clipboard/clipboard.min.js?1768424848 defer></script><script src=/cis526/js/perfect-scrollbar/perfect-scrollbar.min.js?1768424848 defer></script><script src=/cis526/js/theme.min.js?1768424848 defer></script></body></html>