<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="Handling User Authentication The time has come for us to finally handle user authentication on our frontend application. There are several different pieces that need to work together seamlessly for this to work properly, so let’s explore what that looks like and see what it takes to get our users properly authenticated so they can access secure data in our application.
Pinia Store First, since we want the user to be able to request a JWT that can be used throughout our application, it would make the most sense to store that token in a Pinia store, instead of storing it directly in any individual component."><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Authentication :: CIS 526 Textbook"><meta name=twitter:description content="Handling User Authentication The time has come for us to finally handle user authentication on our frontend application. There are several different pieces that need to work together seamlessly for this to work properly, so let’s explore what that looks like and see what it takes to get our users properly authenticated so they can access secure data in our application.
Pinia Store First, since we want the user to be able to request a JWT that can be used throughout our application, it would make the most sense to store that token in a Pinia store, instead of storing it directly in any individual component."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/05-vue-starter/09-auth/embed.html"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Authentication :: CIS 526 Textbook"><meta property="og:description" content="Handling User Authentication The time has come for us to finally handle user authentication on our frontend application. There are several different pieces that need to work together seamlessly for this to work properly, so let’s explore what that looks like and see what it takes to get our users properly authenticated so they can access secure data in our application.
Pinia Store First, since we want the user to be able to request a JWT that can be used throughout our application, it would make the most sense to store that token in a Pinia store, instead of storing it directly in any individual component."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-04-22T09:50:32-05:00"><meta itemprop=name content="Authentication :: CIS 526 Textbook"><meta itemprop=description content="Handling User Authentication The time has come for us to finally handle user authentication on our frontend application. There are several different pieces that need to work together seamlessly for this to work properly, so let’s explore what that looks like and see what it takes to get our users properly authenticated so they can access secure data in our application.
Pinia Store First, since we want the user to be able to request a JWT that can be used throughout our application, it would make the most sense to store that token in a Pinia store, instead of storing it directly in any individual component."><meta itemprop=dateModified content="2025-04-22T09:50:32-05:00"><meta itemprop=wordCount content="2309"><title>Authentication :: CIS 526 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis526/x-examples/05-vue-starter/09-auth/ rel=canonical type=text/html title="Authentication :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/09-auth/index.xml rel=alternate type=application/rss+xml title="Authentication :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/09-auth/index.print.html rel=alternate type=text/html title="Authentication :: CIS 526 Textbook"><link href=/cis526/x-examples/05-vue-starter/09-auth/tele.html rel=alternate type=text/html title="Authentication :: CIS 526 Textbook"><link href=/cis526/css/fontawesome-all.min.css?1745343908 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fontawesome-all.min.css?1745343908 rel=stylesheet></noscript><link href=/cis526/css/nucleus.css?1745343908 rel=stylesheet><link href=/cis526/css/auto-complete.css?1745343908 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/auto-complete.css?1745343908 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar.min.css?1745343908 rel=stylesheet><link href=/cis526/css/fonts.css?1745343908 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fonts.css?1745343908 rel=stylesheet></noscript><link href=/cis526/css/theme.css?1745343908 rel=stylesheet><link href=/cis526/css/theme-light-theme.css?1745343908 rel=stylesheet id=R-variant-style><link href=/cis526/css/chroma-relearn-light.css?1745343908 rel=stylesheet id=R-variant-chroma-style><link href=/cis526/css/variant.css?1745343908 rel=stylesheet><link href=/cis526/css/print.css?1745343908 rel=stylesheet media=print><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.index_js_url="/cis526/index.search.js",window.variants&&variants.init(["light-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis526/css/custom.css?1745343908 rel=stylesheet></head><body class="mobile-support embed disableInlineCopyToClipboard" data-url=/cis526/x-examples/05-vue-starter/09-auth/embed.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/TyXq29cEFGQ style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><h2 id=handling-user-authentication>Handling User Authentication</h2><p>The time has come for us to finally handle user authentication on our frontend application. There are several different pieces that need to work together seamlessly for this to work properly, so let&rsquo;s explore what that looks like and see what it takes to get our users properly authenticated so they can access secure data in our application.</p><h2 id=pinia-store>Pinia Store</h2><p>First, since we want the user to be able to request a JWT that can be used throughout our application, it would make the most sense to store that token in a <a href=https://pinia.vuejs.org/ rel=external target=_blank>Pinia</a> store, instead of storing it directly in any individual component. This way we can easily access the token anywhere we need it in our application, and Pinia will handle making sure it is accessible and updated as needed.</p><p>First, we&rsquo;ll need to install a library that we can use to decode a JWT and read the contents. Thankfully, we can easily use the <a href=https://www.npmjs.com/package/jwt-decode rel=external target=_blank>jwt-decode</a> library available on <code>npm</code> for this task:</p><div class=tab-panel data-tab-group=8be75ea13040a43a8de3f905977076de><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8be75ea13040a43a8de3f905977076de","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ npm install jwt-decode</span></span></code></pre></div></div></div></div></div><p>So, let&rsquo;s create a new store called <code>Token.js</code> in the <code>src/stores</code> folder with the following code:</p><div class=tab-panel data-tab-group=843246c5cef28bfbd3383af2a7e30dd6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srcstorestokenjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("843246c5cef28bfbd3383af2a7e30dd6","srcstorestokenjs")'>
<span class=tab-nav-text>src/stores/Token.js</span></button></div><div class=tab-content-container><div data-tab-item=srcstorestokenjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * @file JWT Token Store
</span></span></span><span class=line><span class=cl><span class=cm> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import Libraries
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>computed</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;vue&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;pinia&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>jwtDecode</span> <span class=p>}</span>  <span class=nx>from</span> <span class=s2>&#34;jwt-decode&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s2>&#34;axios&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define Store
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=nx>useTokenStore</span> <span class=o>=</span> <span class=nx>defineStore</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// State properties
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Getters
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>username</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>?</span> <span class=nx>jwtDecode</span><span class=p>(</span><span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>)[</span><span class=s1>&#39;username&#39;</span><span class=p>]</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>has_role</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=nx>role</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>?</span> <span class=nx>jwtDecode</span><span class=p>(</span><span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>)[</span><span class=s1>&#39;roles&#39;</span><span class=p>].</span><span class=nx>some</span><span class=p>((</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>role</span> <span class=o>==</span> <span class=nx>role</span><span class=p>)</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Actions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * Get a token for the user. 
</span></span></span><span class=line><span class=cl><span class=cm>   * 
</span></span></span><span class=line><span class=cl><span class=cm>   * If this fails, redirect to authentication page if parameter is true
</span></span></span><span class=line><span class=cl><span class=cm>   * 
</span></span></span><span class=line><span class=cl><span class=cm>   * @param redirect if true, redirect user to login page on failure
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=kd>function</span> <span class=nx>getToken</span><span class=p>(</span><span class=nx>redirect</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/auth/token&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>withCredentials</span><span class=o>:</span> <span class=kc>true</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>token</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>      <span class=c1>// If the response is a 401, the user is not logged in
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>response</span> <span class=o>&amp;&amp;</span> <span class=nx>error</span><span class=p>.</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>401</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get user not logged in&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>redirect</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get redirecting to login page&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/auth/cas&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get error&#39;</span> <span class=o>+</span> <span class=nx>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * Log the user out and clear the token
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>logout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/auth/logout&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Return all state, getters, and actions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>{</span><span class=nx>token</span><span class=p>,</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>has_role</span><span class=p>,</span> <span class=nx>getToken</span><span class=p>,</span> <span class=nx>logout</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span></span></span></code></pre></div></div></div></div></div><p>Let&rsquo;s take a look at each part of this Pinia store to understand how it works.</p><ul><li><code>export const useTokenStore = defineStore('token', () => {</code> - this first line creates a store with the unique name of <code>token</code> and exports a function that is used to make the store available in any component. We&rsquo;ll use this function later on this page to access the token in the store.</li><li><code>const token = ref('')</code> - next, we have a section that defines the state variables we actually want to keep in this Pinia store. Each of these are reactive state variables, just like we&rsquo;ve worked with before. In this store, we&rsquo;re just going to store the JWT we receive from our RESTful API backend server in the <code>token</code> variable here.</li><li><code>const username = computed(() =>...</code> - following the state, we have a couple of <a href=https://vuejs.org/guide/essentials/computed.html rel=external target=_blank>Computed Properties</a> that act as getters for our store. The first one will decode the JWT and extra the user&rsquo;s username for us to use in our application.</li><li><code>const has_role = computed(() =>...</code> - this getter will allow us to check if the user&rsquo;s token has a given role listed. This will help us make various parts of the application visible to the user, depending on which roles they have. This getter is unique in that it is an anonymous function that <em>returns</em> an anonymous function!</li><li><code>async function getToken(redirect = false)</code> - finally, we have a couple of actions, which are functions that can be called as part of the store, typically to retrieve the state from the server or perform some other operation on the state. The <code>getToken</code> function will use the Axios library to try and retrieve a token from the server. We have to include the <code>{withCredentials: true}</code> to direct Axios to also send along any cookies available in the browser for this request. If we receive a response, we store it in the <code>token</code> state for this store, showing that the user is correctly logged in. If not, we check and see if the response is an HTTP 401 response, letting us know that the user is not correctly logged in. If not, we can optionally redirect the user to the login page, or we can just silently fail. We&rsquo;ll see how both options are useful a bit later on this page. This function is written using <code>async/await</code> so we can optionally choose to <code>await</code> this function if we want to make sure a user is logged in before doing any other actions.</li><li><code>function logout()</code> - of course, the <code>logout</code> function does exactly what it says - it simply removes the token and then redirects the user to the logout route on the backend server. This is important to do, because it will tell the backend server to clear the cookie and also redirect us to the CAS server to make sure all of our sessions are closed.</li></ul><p>Finally, at the bottom, we have to remember to return every single state, getter, or action that is part of this Pinia store.</p><h2 id=user-profile-component>User Profile Component</h2><p>Now that we&rsquo;ve created a Pinia store to handle our JWT for our user, we can create a Vue component to work with the store to make it easy for the user to log in, log out, and see their information.</p><p>For this, we&rsquo;re going to create a new Vue component called <code>UserProfile.vue</code> and store it in the <code>src/components/layout</code> folder. It will contain the following content:</p><div class=tab-panel data-tab-group=6bb5138ee122a83630b9b32aa80cae5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("6bb5138ee122a83630b9b32aa80cae5d","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>setup</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * @file User Profile menu option
</span></span></span><span class=line><span class=cl><span class=cm> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import Libraries
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>storeToRefs</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;pinia&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Avatar</span><span class=p>,</span> <span class=nx>Menu</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;primevue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>useRouter</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue-router&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>router</span> <span class=o>=</span> <span class=nx>useRouter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Stores
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useTokenStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@/stores/Token&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tokenStore</span> <span class=o>=</span> <span class=nx>useTokenStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>token</span><span class=p>,</span> <span class=nx>username</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>storeToRefs</span><span class=p>(</span><span class=nx>tokenStore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Declare State
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>items</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>label</span><span class=o>:</span> <span class=nx>username</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=s1>&#39;pi pi-cog&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>command</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;profile&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>label</span><span class=o>:</span> <span class=s1>&#39;Logout&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=s1>&#39;pi pi-sign-out&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>command</span><span class=o>:</span> <span class=nx>tokenStore</span><span class=p>.</span><span class=nx>logout</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Menu Popup State
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>menu</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Menu Toggle Button Handler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>toggle</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>menu</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>toggle</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>If</span> <span class=nx>the</span> <span class=nx>token</span> <span class=nx>is</span> <span class=nx>empty</span><span class=p>,</span> <span class=nx>show</span> <span class=nx>the</span> <span class=nx>login</span> <span class=nx>button</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;token.length == 0&#34; class=&#34;p-menubar-item-content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-link&#34;</span> <span class=nt>@click</span><span class=s>=&#34;tokenStore.getToken(true)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-icon pi pi-sign-in&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menu-item-label&#34;</span><span class=p>&gt;</span><span class=nx>Login</span><span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>Otherwise</span><span class=p>,</span> <span class=nx>assume</span> <span class=nx>the</span> <span class=nx>user</span> <span class=nx>is</span> <span class=nx>logged</span> <span class=k>in</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>v</span><span class=nt>-else</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span>
</span></span><span class=line><span class=cl>        <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-link&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>id</span><span class=o>=</span><span class=s>&#34;user-icon&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nt>@click</span><span class=s>=&#34;toggle&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>aria</span><span class=nt>-haspopup</span><span class=err>=&#34;</span><span class=na>true</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>aria</span><span class=nt>-controls</span><span class=err>=&#34;</span><span class=na>profile_menu</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>Avatar</span> <span class=na>icon</span><span class=o>=</span><span class=s>&#34;pi pi-user&#34;</span> <span class=na>shape</span><span class=o>=</span><span class=s>&#34;circle&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Menu</span> <span class=na>ref</span><span class=o>=</span><span class=s>&#34;menu&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;profile_menu&#34;</span> <span class=nt>:model</span><span class=o>=</span><span class=s>&#34;items&#34;</span> <span class=nt>:popup</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>user</span><span class=o>-</span><span class=nx>icon</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>padding</span><span class=o>:</span> <span class=mi>0</span><span class=nx>px</span> <span class=mi>12</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><p>As we can see, our components are slowly becoming more and more complex, but we can easily break down this component into several parts to see how it works.</p><div class=tab-panel data-tab-group=c4f7aeeff0508bed6fc89ed1329ebad7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c4f7aeeff0508bed6fc89ed1329ebad7","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c1>// Stores
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>useTokenStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;@/stores/Token&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tokenStore</span> <span class=o>=</span> <span class=nx>useTokenStore</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>token</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>storeToRefs</span><span class=p>(</span><span class=nx>tokenStore</span><span class=p>)</span></span></span></code></pre></div></div></div></div></div><p>First, these three lines in the <code>&lt;script setup></code> portion will load our <code>token</code> store we created earlier. We first import it, then we call the <code>useTokenStore</code> function to make it accessible. Finally, we are using the <code>storeToRefs</code> function to extract any state and getters from the store and make them direct reactive state variables we can use in our component.</p><div class=tab-panel data-tab-group=645c40388b1e6155c2dc3b7a05ae25a3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("645c40388b1e6155c2dc3b7a05ae25a3","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c1>// Declare State
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>items</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>label</span><span class=o>:</span> <span class=s1>&#39;Profile&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=s1>&#39;pi pi-cog&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>command</span><span class=o>:</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>router</span><span class=p>.</span><span class=nx>push</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;profile&#39;</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>label</span><span class=o>:</span> <span class=s1>&#39;Logout&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>icon</span><span class=o>:</span> <span class=s1>&#39;pi pi-sign-out&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>command</span><span class=o>:</span> <span class=nx>tokenStore</span><span class=p>.</span><span class=nx>logout</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>])</span></span></span></code></pre></div></div></div></div></div><p>Next, we are setting up the menu items that will live in the submenu that is available when a user is logged on. These use the same menu item format that we used previously in our top-level menu bar.</p><div class=tab-panel data-tab-group=c008f3a68cdc75adb0b19ba5db6cead4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("c008f3a68cdc75adb0b19ba5db6cead4","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c1>// Menu Popup State
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>menu</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Menu Toggle Button Handler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>toggle</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>menu</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>toggle</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Finally, we have a reactive state variable and a click handler function to enable our popup menu to appear and hide as users click on the profile button.</p><p>Now, let&rsquo;s break down the content in the <code>&lt;template></code> section as well.</p><div class=tab-panel data-tab-group=f2f93c3c9cece17ca68b3dc6683d4217><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f2f93c3c9cece17ca68b3dc6683d4217","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>If</span> <span class=nx>the</span> <span class=nx>token</span> <span class=nx>is</span> <span class=nx>empty</span><span class=p>,</span> <span class=nx>show</span> <span class=nx>the</span> <span class=nx>login</span> <span class=nx>button</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=nt>v-if</span><span class=o>=</span><span class=s>&#34;token.length == 0&#34; class=&#34;p-menubar-item-content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-link&#34;</span> <span class=nt>@click</span><span class=s>=&#34;tokenStore.getToken(true)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-icon pi pi-sign-in&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>span</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menu-item-label&#34;</span><span class=p>&gt;</span><span class=nx>Login</span><span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><p>Our template consists of two different parts. First, if the <code>token</code> store has an empty token, we can assume that the user is not logged in. In that case, instead of showing any user profile information, we should just show a login button for the user to click. This button is styled using some PrimeVue CSS classes to match other buttons available in the top-level menu bar.</p><div class=tab-panel data-tab-group=f7f8883fe27b58208fab46a712587a64><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("f7f8883fe27b58208fab46a712587a64","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl>    <span class=c>&lt;!--</span> <span class=nx>Otherwise</span><span class=p>,</span> <span class=nx>assume</span> <span class=nx>the</span> <span class=nx>user</span> <span class=nx>is</span> <span class=nx>logged</span> <span class=k>in</span> <span class=o>--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>v</span><span class=nt>-else</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-content&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>a</span>
</span></span><span class=line><span class=cl>        <span class=na>class</span><span class=o>=</span><span class=s>&#34;p-menubar-item-link&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>id</span><span class=o>=</span><span class=s>&#34;user-icon&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nt>@click</span><span class=s>=&#34;toggle&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>aria</span><span class=nt>-haspopup</span><span class=err>=&#34;</span><span class=na>true</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>aria</span><span class=nt>-controls</span><span class=err>=&#34;</span><span class=na>profile_menu</span><span class=err>&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>Avatar</span> <span class=na>icon</span><span class=o>=</span><span class=s>&#34;pi pi-user&#34;</span> <span class=na>shape</span><span class=o>=</span><span class=s>&#34;circle&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>Menu</span> <span class=na>ref</span><span class=o>=</span><span class=s>&#34;menu&#34;</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;profile_menu&#34;</span> <span class=nt>:model</span><span class=o>=</span><span class=s>&#34;items&#34;</span> <span class=nt>:popup</span><span class=o>=</span><span class=s>&#34;true&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><p>However, if the user is logged in, we instead can show a clickable link that will open a submenu with a couple of options. To display the user&rsquo;s profile information, we are using a <a href=https://primevue.org/avatar/ rel=external target=_blank>PrimeVue Avatar</a> component with a default user icon, but we can easily replace that with a user&rsquo;s profile image if one exists in our application. We are also using a <a href=https://primevue.org/menu/ rel=external target=_blank>PrimeVue Menu</a> component to create a small popup menu if the user clicks on their profile icon. That menu includes options to view the user&rsquo;s profile,and also to log out of the application by calling the <code>logout</code> method in the <code>token</code> store.</p><p>We also see our first instance of a scoped CSS directive in this component:</p><div class=tab-panel data-tab-group=35718dc29c71e8185442c11f486cc6db><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayoutuserprofilevue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("35718dc29c71e8185442c11f486cc6db","srccomponentslayoutuserprofilevue")'>
<span class=tab-nav-text>src/components/layout/UserProfile.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayoutuserprofilevue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>style</span> <span class=na>scoped</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=nx>user</span><span class=o>-</span><span class=nx>icon</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>padding</span><span class=o>:</span> <span class=mi>0</span><span class=nx>px</span> <span class=mi>12</span><span class=nx>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><p>In effect, the Avatar component from PrimeVue is a bit taller than the rest of the items in the top-level menu bar. By default, the <code>p-menuvar-item-content</code> class has a lot of padding above and below the element, but we&rsquo;ve chosen to remove that padding by overriding the <code>padding</code> CSS directive on the <code>&lt;a></code> element with the ID <code>#user-icon</code>. This is a very powerful way to make little tweaks to the overall look and feel of our application to keep it consistent.</p><h2 id=integrating-the-user-profile-component>Integrating the User Profile Component</h2><p>Now we can add our new <code>UserProfile</code> component to our <code>TopMenu</code> component to make it visible in our application:</p><div class=tab-panel data-tab-group=afccbb48e4d48ecf9a0c33741265ed1b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=srccomponentslayouttopmenuvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("afccbb48e4d48ecf9a0c33741265ed1b","srccomponentslayouttopmenuvue")'>
<span class=tab-nav-text>src/components/layout/TopMenu.vue</span></button></div><div class=tab-content-container><div data-tab-item=srccomponentslayouttopmenuvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=c1>// -=-=- other code omitted here -=-=-
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Import Components
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=nx>Menubar</span> <span class=nx>from</span> <span class=s1>&#39;primevue/menubar&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>ThemeToggle</span> <span class=nx>from</span> <span class=s1>&#39;./ThemeToggle.vue&#39;</span>
</span></span><span class="line hl"><span class=cl><span class=kr>import</span> <span class=nx>UserProfile</span> <span class=nx>from</span> <span class=s1>&#39;./UserProfile.vue&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// -=-=- other code omitted here -=-=-
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>Menubar</span> <span class=nt>:model</span><span class=o>=</span><span class=s>&#34;items&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>template</span> <span class=err>#</span><span class=na>start</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://placehold.co/40x40&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;Placeholder Logo&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>template</span> <span class=err>#</span><span class=na>end</span><span class=p>&gt;</span>
</span></span><span class="line hl"><span class=cl>        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;flex items-center gap-1&#34;</span><span class=p>&gt;</span>
</span></span><span class="line hl"><span class=cl>          <span class=p>&lt;</span><span class=nt>ThemeToggle</span> <span class=p>/&gt;</span>
</span></span><span class="line hl"><span class=cl>          <span class=p>&lt;</span><span class=nt>UserProfile</span> <span class=p>/&gt;</span>
</span></span><span class="line hl"><span class=cl>        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>Menubar</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><p>As we&rsquo;ve already seen before, we are simply importing the component into our file in the <code>&lt;script setup></code> section, and then adding it like any other HTML element in the <code>&lt;template></code> section. To help with layout, we&rsquo;ve wrapped the items in the <code>&lt;template #end></code> slot in a <code>&lt;div></code> of their own, and applied a few CSS classes from Tailwind to handle <a href=https://tailwindcss.com/docs/flex rel=external target=_blank>Flex Layout</a>, <a href=https://tailwindcss.com/docs/align-items rel=external target=_blank>Item Alignment</a>, and <a href=https://tailwindcss.com/docs/gap rel=external target=_blank>Gap Spacing</a>.</p><h2 id=fixing-the-cas-redirect>Fixing the CAS Redirect</h2><p>Finally, before we can test our authentication system, we must make one change to our website&rsquo;s configuration. Right now, our CAS authentication system is set to redirect users back to port <code>3000</code>, which is where our backend server is running. However, we now want users to be sent back to our frontend, which is running on port <code>5173</code>. So, in our <code>server</code> folder, we need to update one entry in our <code>.env</code> file:</p><div class=tab-panel data-tab-group=51b469bd3e71bd7783aa1c91daff2650><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=env class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("51b469bd3e71bd7783aa1c91daff2650","env")'>
<span class=tab-nav-text>.env</span></button></div><div class=tab-content-container><div data-tab-item=env class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=c1># -=-=- other settings omitted here -=-=-</span>
</span></span><span class=line><span class=cl><span class=nv>CAS_SERVICE_URL</span><span class=o>=</span>https://<span class=nv>$CODESPACE_NAME</span>-5173.<span class=nv>$GITHUB_CODESPACES_PORT_FORWARDING_DOMAIN</span></span></span></code></pre></div></div></div></div></div><p>Now, instead of referencing the <code>$PORT</code> setting, we have simply hard-coded the port <code>5173</code> used by Vite for now. Once we&rsquo;ve changed this setting, we must remember to manually restart our backend server by either stopping and restarting it in the terminal, or by typing <code>rs</code> in the running terminal window so Nodemon will restart it.</p><h2 id=testing-authentication>Testing Authentication</h2><p>At this point, we are finally ready to test our authentication setup. So, we&rsquo;ll need to make sure both our frontend and backend applications are running. Then, we can load our frontend application and try to click on the login button. If it works correctly, it should redirect us to the CAS server to log in. Once we have logged in, we&rsquo;ll be sent back to our frontend application, but the login button will still be visible. This time, however, if we click it, our frontend will be able to successfully get a token from the backend (since we are already logged in and have a valid cookie), and our frontend application will switch to show the user&rsquo;s profile option in the menu.</p><p><a href=#R-image-17864dcea7f533efbcc2f544f2125a3d class=lightbox-link><img alt="Vue Authentication" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis526/images/examples/05/vue_auth.gif style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17864dcea7f533efbcc2f544f2125a3d><img alt="Vue Authentication" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis526/images/examples/05/vue_auth.gif></a></p><p>If everything is working correctly, our website should act like the example animation above! Now we just have to add a few more features to streamline this process a bit and actually request data from the server.</p><h2 id=authentication-process>Authentication Process</h2><p>Let&rsquo;s take a step back to examine the complexity of the authentication process for our application as it stands currently:</p><p><a href=#R-image-4acb8d6c6bf6b0460f32269b3245db97 class=lightbox-link><img alt="Vue Auth Process" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis526/images/examples/05/vue_cas_auth.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4acb8d6c6bf6b0460f32269b3245db97><img alt="Vue Auth Process" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis526/images/examples/05/vue_cas_auth.png></a></p><p>As we can see, there are lots of steps involved! It is always good to create diagrams like this in mind when developing an application - they can often be very helpful when we have to debug a complicated process like authentication.</p><footer class=footline></footer></article></div></main></div><script src=/cis526/js/clipboard.min.js?1745343908 defer></script><script src=/cis526/js/perfect-scrollbar.min.js?1745343908 defer></script><script src=/cis526/js/theme.js?1745343908 defer></script><script src=/cis526/js/embed-iframe.js?1745343908 defer></script></body></html>