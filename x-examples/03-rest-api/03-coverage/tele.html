<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=robots content="noindex, nofollow, noarchive, noimageindex"><meta name=description content="YouTube Video Code Coverage It is often helpful to examine the code coverage of our unit tests. Thankfully, there is an easy way to enable that in our project using the c8 library. So, we can start by installing it:
​ terminal $ npm install --save-dev c8 Once it is installed, we can simply add it to a new script in the package.json file that will run our tests with code coverage:"><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Code Coverage :: CIS 526 Textbook"><meta name=twitter:description content="YouTube Video Code Coverage It is often helpful to examine the code coverage of our unit tests. Thankfully, there is an easy way to enable that in our project using the c8 library. So, we can start by installing it:
​ terminal $ npm install --save-dev c8 Once it is installed, we can simply add it to a new script in the package.json file that will run our tests with code coverage:"><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/03-rest-api/03-coverage/"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Code Coverage :: CIS 526 Textbook"><meta property="og:description" content="YouTube Video Code Coverage It is often helpful to examine the code coverage of our unit tests. Thankfully, there is an easy way to enable that in our project using the c8 library. So, we can start by installing it:
​ terminal $ npm install --save-dev c8 Once it is installed, we can simply add it to a new script in the package.json file that will run our tests with code coverage:"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-02-14T14:34:54-06:00"><meta itemprop=name content="Code Coverage :: CIS 526 Textbook"><meta itemprop=description content="YouTube Video Code Coverage It is often helpful to examine the code coverage of our unit tests. Thankfully, there is an easy way to enable that in our project using the c8 library. So, we can start by installing it:
​ terminal $ npm install --save-dev c8 Once it is installed, we can simply add it to a new script in the package.json file that will run our tests with code coverage:"><meta itemprop=dateModified content="2025-02-14T14:34:54-06:00"><meta itemprop=wordCount content="858"><title>Code Coverage :: CIS 526 Textbook</title>
<link href=/cis526/css/fontawesome-all.min.css?1739918255 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fontawesome-all.min.css?1739918255 rel=stylesheet></noscript><link href=/cis526/css/nucleus.css?1739918255 rel=stylesheet><link href=/cis526/css/auto-complete.css?1739918255 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/auto-complete.css?1739918255 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar.min.css?1739918255 rel=stylesheet><link href=/cis526/css/fonts.css?1739918255 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fonts.css?1739918255 rel=stylesheet></noscript><link href=/cis526/css/theme.css?1739918255 rel=stylesheet><link href=/cis526/css/theme-auto.css?1739918255 rel=stylesheet id=R-variant-style><link href=/cis526/css/chroma-auto.css?1739918255 rel=stylesheet id=R-variant-chroma-style><link href=/cis526/css/variant.css?1739918255 rel=stylesheet><link href=/cis526/css/print.css?1739918255 rel=stylesheet media=print><script src=/cis526/js/variant.js?1739918255></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.index_js_url="/cis526/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis526/css/custom.css?1739918255 rel=stylesheet></head><body class="mobile-support tele disableInlineCopyToClipboard" data-url=/cis526/x-examples/03-rest-api/03-coverage/><div id=tele class="tele mirror"><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=code-coverage>Code Coverage</h1><a href="https://www.youtube.com/watch?v=id">YouTube Video</a><h2 id=code-coverage>Code Coverage</h2><p>It is often helpful to examine the <a href=https://en.wikipedia.org/wiki/Code_coverage rel=external target=_blank>code coverage</a> of our unit tests. Thankfully, there is an easy way to enable that in our project using the <a href=https://www.npmjs.com/package/c8 rel=external target=_blank>c8</a> library. So, we can start by installing it:</p><div class=tab-panel data-tab-group=245b016bb1ca73dcbae0ec958622124a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("245b016bb1ca73dcbae0ec958622124a","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ npm install --save-dev c8</span></span></code></pre></div></div></div></div></div><p>Once it is installed, we can simply add it to a new script in the <code>package.json</code> file that will run our tests with code coverage:</p><div class=tab-panel data-tab-group=efbf61e17d2cf08a7fc18b769a86a2ca><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=packagejson class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("efbf61e17d2cf08a7fc18b769a86a2ca","packagejson")'>
<span class=tab-nav-text>package.json</span></button></div><div class=tab-content-container><div data-tab-item=packagejson class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=err>...</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;start&#34;</span><span class=p>:</span> <span class=s2>&#34;LOG_LEVEL=http node ./bin/www&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;dev&#34;</span><span class=p>:</span> <span class=s2>&#34;nodemon ./bin/www&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;lint&#34;</span><span class=p>:</span> <span class=s2>&#34;npx eslint --fix .&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;format&#34;</span><span class=p>:</span> <span class=s2>&#34;npx prettier . --write&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;test&#34;</span><span class=p>:</span> <span class=s2>&#34;mocha --require test/hooks.js --recursive --parallel --timeout 2000 --exit&#34;</span><span class=p>,</span>
</span></span><span class="line hl"><span class=cl>    <span class=nt>&#34;cov&#34;</span><span class=p>:</span> <span class=s2>&#34;c8 --reporter=html --reporter=text mocha --require test/hooks.js --recursive --parallel --timeout 2000 --exit&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=err>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>All we have to do is add the <code>c8</code> command with a few options in front of our existing <code>mocha</code> command.</p><p>Now, we can run our tests with code coverage using this script:</p><div class=tab-panel data-tab-group=735f0f7d4fab6b955dbdd0cb04018227><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("735f0f7d4fab6b955dbdd0cb04018227","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ npm run cov</span></span></code></pre></div></div></div></div></div><p>This time, we&rsquo;ll see a bunch of additional output on the terminal</p><div class=tab-panel data-tab-group=015939e76d2093658206b2c3c2fa6edd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("015939e76d2093658206b2c3c2fa6edd","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>&gt; lost-communities-solution@0.0.1 cov
&gt; c8 --reporter=html --reporter=text mocha --require test/hooks.js --recursive --parallel --timeout 2000 --exit

[dotenvx@1.34.0] injecting env (6) from .env.test

[dotenvx@1.34.0] injecting env (0) from .env.test
[dotenvx@1.34.0] injecting env (0) from .env

  /api
    GET /
      ✔ should list all API versions


  1 passing (1s)

------------------------|---------|----------|---------|---------|-------------------------------------------
File                    | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                         
------------------------|---------|----------|---------|---------|-------------------------------------------
All files               |   93.53 |    83.33 |   55.55 |   93.53 |                                           
 server                 |   88.52 |       50 |     100 |   88.52 |                                           
  app.js                |   88.52 |       50 |     100 |   88.52 | 53-59                                     
 server/configs         |   91.86 |    47.36 |     100 |   91.86 |                                           
  database.js           |     100 |      100 |     100 |     100 |                                           
  logger.js             |   85.56 |    30.76 |     100 |   85.56 | 24-25,27-28,30-31,33-34,36-37,39-40,42-43 
  migrations.js         |     100 |      100 |     100 |     100 |                                           
  openapi.js            |   92.85 |    66.66 |     100 |   92.85 | 19-21                                     
  seeds.js              |     100 |      100 |     100 |     100 |                                           
 server/middlewares     |     100 |      100 |     100 |     100 |                                           
  request-logger.js     |     100 |      100 |     100 |     100 |                                           
 server/migrations      |   96.07 |      100 |      50 |   96.07 |                                           
  00_users.js           |   95.55 |      100 |      50 |   95.55 | 44-45                                     
  01_roles.js           |   94.91 |      100 |      50 |   94.91 | 57-59                                     
  02_counties.js        |   96.61 |      100 |      50 |   96.61 | 58-59                                     
  03_communities.js     |   96.61 |      100 |      50 |   96.61 | 58-59                                     
  04_metadata.js        |   96.66 |      100 |      50 |   96.66 | 88-90                                     
  05_documents.js       |   95.71 |      100 |      50 |   95.71 | 68-70                                     
 server/models          |     100 |      100 |     100 |     100 |                                           
  community.js          |     100 |      100 |     100 |     100 |                                           
  county.js             |     100 |      100 |     100 |     100 |                                           
  document.js           |     100 |      100 |     100 |     100 |                                           
  metadata.js           |     100 |      100 |     100 |     100 |                                           
  metadata_community.js |     100 |      100 |     100 |     100 |                                           
  metadata_document.js  |     100 |      100 |     100 |     100 |                                           
  models.js             |     100 |      100 |     100 |     100 |                                           
  role.js               |     100 |      100 |     100 |     100 |                                           
  user.js               |     100 |      100 |     100 |     100 |                                           
  user_role.js          |     100 |      100 |     100 |     100 |                                           
 server/routes          |   68.72 |      100 |     100 |   68.72 |                                           
  api.js                |     100 |      100 |     100 |     100 |                                           
  index.js              |   97.43 |      100 |     100 |   97.43 | 36                                        
  users.js              |    46.8 |      100 |     100 |    46.8 | 52-62,66-73,77-91,95-105,109-138          
 server/routes/api/v1   |   87.71 |      100 |     100 |   87.71 |                                           
  roles.js              |   87.71 |      100 |     100 |   87.71 | 48-54                                     
 server/seeds           |   95.09 |      100 |      50 |   95.09 |                                           
  00_users.js           |   96.36 |      100 |      50 |   96.36 | 54-55                                     
  01_roles.js           |   97.36 |      100 |      50 |   97.36 | 112-114                                   
  02_counties.js        |   95.83 |      100 |      50 |   95.83 | 47-48                                     
  03_communities.js     |   95.65 |      100 |      50 |   95.65 | 45-46                                     
  04_metadata.js        |   89.39 |      100 |      50 |   89.39 | 60-66                                     
  05_documents.js       |   94.82 |      100 |      50 |   94.82 | 56-58</code></pre></div></div></div></div></div><p>Right away we see that a large part of our application achieves 100% code coverage with a single unit test! This highlights both how tightly interconnected all parts of our application are (such that a single unit test exercises much of the code) but also that code coverage can be a very poor metric for unit test quality (seeing this result we might suspect our application is already well tested with just a single unit test).</p><p>We have also enabled the <code>html</code> reporter, so we can see similar results in a <code>coverage</code> folder that appears inside of our <code>server</code> folder. We can use various VS Code Extensions such as <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.live-server" rel=external target=_blank>Live Preview</a> to view that file in our web browser.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Port Conflict</div><div class=box-content><p>The Live Preview extension defaults to port 3000, so we recommend digging into the settings and changing the default port to something else before using it.</p></div></div><p><a href=#R-image-1754061d8cc317210ed600042355ab93 class=lightbox-link><img alt="Coverage Example" class="border lazy lightbox noshadow figure-image" loading=lazy src=/cis526/images/examples/03/coverage_1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1754061d8cc317210ed600042355ab93><img alt="Coverage Example" class="border lazy lightbox noshadow lightbox-image" loading=lazy src=/cis526/images/examples/03/coverage_1.png></a></p><p>In either case, we can see that we&rsquo;ve already reached 100% coverage on our <code>routes/api.js</code> file. However, as we&rsquo;ll see in the next section, that doesn&rsquo;t always mean that we are done writing our unit tests.</p><footer class=footline></footer></article></div></main></div></div><script src=/cis526/js/clipboard.min.js?1739918255 defer></script><script src=/cis526/js/perfect-scrollbar.min.js?1739918255 defer></script><script src=/cis526/js/theme.js?1739918255 defer></script><script src=/cis526/js/tele-scroll.js?1739918255 defer></script></body></html>