<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="This page lists all of the errors found and updates I have made to the basic project since this was released.
Client Update Token Store In my Vue code, I was often using tokenStore.token.length > 0 to determine if a user was logged in. This is a bit fragile - better to just make a computed value for this:
​ client/src/stores/Token.js // Getters const loggedIn = computed(() => token.value.length > 0 ) This requires changing several other places in ths code where this is used - mainly I just searched for token."><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Errata :: CIS 526 Textbook"><meta name=twitter:description content="This page lists all of the errors found and updates I have made to the basic project since this was released.
Client Update Token Store In my Vue code, I was often using tokenStore.token.length > 0 to determine if a user was logged in. This is a bit fragile - better to just make a computed value for this:
​ client/src/stores/Token.js // Getters const loggedIn = computed(() => token.value.length > 0 ) This requires changing several other places in ths code where this is used - mainly I just searched for token."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/08-errata/"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Errata :: CIS 526 Textbook"><meta property="og:description" content="This page lists all of the errors found and updates I have made to the basic project since this was released.
Client Update Token Store In my Vue code, I was often using tokenStore.token.length > 0 to determine if a user was logged in. This is a bit fragile - better to just make a computed value for this:
​ client/src/stores/Token.js // Getters const loggedIn = computed(() => token.value.length > 0 ) This requires changing several other places in ths code where this is used - mainly I just searched for token."><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta itemprop=name content="Errata :: CIS 526 Textbook"><meta itemprop=description content="This page lists all of the errors found and updates I have made to the basic project since this was released.
Client Update Token Store In my Vue code, I was often using tokenStore.token.length > 0 to determine if a user was logged in. This is a bit fragile - better to just make a computed value for this:
​ client/src/stores/Token.js // Getters const loggedIn = computed(() => token.value.length > 0 ) This requires changing several other places in ths code where this is used - mainly I just searched for token."><meta itemprop=dateModified content="2025-06-15T11:41:50-05:00"><meta itemprop=wordCount content="656"><title>Errata :: CIS 526 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis526/x-examples/08-errata/ rel=canonical type=text/html title="Errata :: CIS 526 Textbook"><link href=/cis526/x-examples/08-errata/index.xml rel=alternate type=application/rss+xml title="Errata :: CIS 526 Textbook"><link href=/cis526/x-examples/08-errata/index.print.html rel=alternate type=text/html title="Errata :: CIS 526 Textbook"><link href=/cis526/x-examples/08-errata/embed.html rel=alternate type=text/html title="Errata :: CIS 526 Textbook"><link href=/cis526/css/fontawesome-all.min.css?1750005760 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fontawesome-all.min.css?1750005760 rel=stylesheet></noscript><link href=/cis526/css/nucleus.css?1750005760 rel=stylesheet><link href=/cis526/css/auto-complete.css?1750005760 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/auto-complete.css?1750005760 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar.min.css?1750005760 rel=stylesheet><link href=/cis526/css/fonts.css?1750005760 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fonts.css?1750005760 rel=stylesheet></noscript><link href=/cis526/css/theme.css?1750005760 rel=stylesheet><link href=/cis526/css/theme-auto.css?1750005760 rel=stylesheet id=R-variant-style><link href=/cis526/css/chroma-auto.css?1750005760 rel=stylesheet id=R-variant-chroma-style><link href=/cis526/css/variant.css?1750005760 rel=stylesheet><link href=/cis526/css/print.css?1750005760 rel=stylesheet media=print><script src=/cis526/js/variant.js?1750005760></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.index_js_url="/cis526/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis526/css/custom.css?1750005760 rel=stylesheet></head><body class="mobile-support tele disableInlineCopyToClipboard" data-url=/cis526/x-examples/08-errata/><div id=tele class="tele mirror"><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=errata>Errata</h1><p>This page lists all of the errors found and updates I have made to the basic project since this was released.</p><h2 id=client>Client</h2><h3 id=update-token-store>Update Token Store</h3><p>In my Vue code, I was often using <code>tokenStore.token.length > 0</code> to determine if a user was logged in. This is a bit fragile - better to just make a computed value for this:</p><div class=tab-panel data-tab-group=306f803e7d0b747c606904bb72edbb9b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=clientsrcstorestokenjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("306f803e7d0b747c606904bb72edbb9b","clientsrcstorestokenjs")'>
<span class=tab-nav-text>client/src/stores/Token.js</span></button></div><div class=tab-content-container><div data-tab-item=clientsrcstorestokenjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl>  <span class=c1>// Getters
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>loggedIn</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>    <span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span></span></span></code></pre></div></div></div></div></div><p>This requires changing several other places in ths code where this is used - mainly I just searched for <code>token.length</code> and went from there.</p><p>I also chose to update it to store the decoded value directly as a state property, just to avoid decoding it multiple times. Finally, I fixed a bug where users with no role would cause issues. Here is the fully updated token store.</p><div class=tab-panel data-tab-group=22d17cd0f0c45090e40c28f3de952a39><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=clientsrcstorestokenjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("22d17cd0f0c45090e40c28f3de952a39","clientsrcstorestokenjs")'>
<span class=tab-nav-text>client/src/stores/Token.js</span></button></div><div class=tab-content-container><div data-tab-item=clientsrcstorestokenjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * @file JWT Token Store
</span></span></span><span class=line><span class=cl><span class=cm> * @author Russell Feldhausen &lt;russfeld@ksu.edu&gt;
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import Libraries
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>import</span> <span class=p>{</span> <span class=nx>ref</span><span class=p>,</span> <span class=nx>computed</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;vue&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>defineStore</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;pinia&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>jwtDecode</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;jwt-decode&#39;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>axios</span> <span class=nx>from</span> <span class=s1>&#39;axios&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define Store
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>export</span> <span class=kr>const</span> <span class=nx>useTokenStore</span> <span class=o>=</span> <span class=nx>defineStore</span><span class=p>(</span><span class=s1>&#39;token&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// State properties
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>token</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>decoded</span> <span class=o>=</span> <span class=nx>ref</span><span class=p>({})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Getters
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>loggedIn</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span> 
</span></span><span class=line><span class=cl>    <span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>length</span> <span class=o>&gt;</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>username</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(()</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>username</span> <span class=o>?</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>username</span>  <span class=o>:</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>email</span> <span class=o>?</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>email</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>has_role</span> <span class=o>=</span> <span class=nx>computed</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>(</span><span class=nx>role</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>roles</span> <span class=o>?</span> <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span><span class=p>.</span><span class=nx>roles</span><span class=p>.</span><span class=nx>some</span><span class=p>((</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>role</span> <span class=o>==</span> <span class=nx>role</span><span class=p>)</span> <span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Actions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * Get a token for the user.
</span></span></span><span class=line><span class=cl><span class=cm>   *
</span></span></span><span class=line><span class=cl><span class=cm>   * If this fails, redirect to authentication page if parameter is true
</span></span></span><span class=line><span class=cl><span class=cm>   *
</span></span></span><span class=line><span class=cl><span class=cm>   * @param redirect if true, redirect user to login page on failure
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=kd>function</span> <span class=nx>getToken</span><span class=p>(</span><span class=nx>redirect</span> <span class=o>=</span> <span class=kc>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>axios</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/auth/token&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>withCredentials</span><span class=o>:</span> <span class=kc>true</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>      <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>response</span><span class=p>.</span><span class=nx>data</span><span class=p>.</span><span class=nx>token</span>
</span></span><span class=line><span class=cl>      <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=nx>jwtDecode</span><span class=p>(</span><span class=nx>token</span><span class=p>.</span><span class=nx>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>      <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>      <span class=c1>// If the response is a 401, the user is not logged in
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>response</span> <span class=o>&amp;&amp;</span> <span class=nx>error</span><span class=p>.</span><span class=nx>response</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>401</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get user not logged in&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>redirect</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get redirecting to login page&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>          <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/auth/cas&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;token:get error&#39;</span> <span class=o>+</span> <span class=nx>error</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>   * Log the user out and clear the token
</span></span></span><span class=line><span class=cl><span class=cm>   */</span>
</span></span><span class=line><span class=cl>  <span class=kd>function</span> <span class=nx>logout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>token</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nx>decoded</span><span class=p>.</span><span class=nx>value</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s1>&#39;/auth/logout&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Return all state, getters, and actions
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=p>{</span> <span class=nx>token</span><span class=p>,</span> <span class=nx>loggedIn</span><span class=p>,</span> <span class=nx>username</span><span class=p>,</span> <span class=nx>has_role</span><span class=p>,</span> <span class=nx>getToken</span><span class=p>,</span> <span class=nx>logout</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span></span></span></code></pre></div></div></div></div></div><h3 id=switch-from-date-fns-to-dayjs>Switch from date-fns to Day.js</h3><p>The <a href=https://date-fns.org/ rel=external target=_blank>date-fns</a> library has an issue where an invalid date will cause an uncaught exception in the browser, which crashes the Vue application. This can happen when the date is rendered <em>before</em> the data is loaded, as would be the case anytime the data is loaded asynchronously when visiting the page. This was causing all sorts of strange errors in my code upon a refresh of specific pages.</p><p>I swapped to using <a href=https://day.js.org/en/ rel=external target=_blank>Day.js</a> instead, which provides many of the same features as <code>date-fns</code> but <strong>without</strong> unhandled exceptions. I especially use the <a href=https://day.js.org/docs/en/display/from-now rel=external target=_blank>Time from now</a> feature in many places, such as my <code>UsersList.vue</code> component:</p><div class=tab-panel data-tab-group=4d699b9b617fd4b98e84059a893ca3d6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=clientsrccomponentsusersuserslistvue class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4d699b9b617fd4b98e84059a893ca3d6","clientsrccomponentsusersuserslistvue")'>
<span class=tab-nav-text>client/src/components/users/UsersList.vue</span></button></div><div class=tab-content-container><div data-tab-item=clientsrccomponentsusersuserslistvue class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-vue data-lang=vue><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Column</span> <span class=na>field</span><span class=o>=</span><span class=s>&#34;createdAt&#34;</span> <span class=na>header</span><span class=o>=</span><span class=s>&#34;Created&#34;</span> <span class=na>sortable</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>template</span> <span class=err>#</span><span class=na>body</span><span class=o>=</span><span class=s>&#34;{ data }&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>span</span> <span class=na>v</span><span class=nt>-tooltip</span><span class=na>.bottom</span><span class=err>=&#34;</span><span class=na>new</span> <span class=na>Date</span><span class=err>(</span><span class=na>data.createdAt</span><span class=err>)</span><span class=na>.toLocaleString</span><span class=err>()&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=p>{{</span> <span class=nx>dayjs</span><span class=p>(</span><span class=nx>data</span><span class=p>.</span><span class=nx>createdAt</span><span class=p>).</span><span class=nx>fromNow</span><span class=p>()</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>template</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Column</span><span class=p>&gt;</span></span></span></code></pre></div></div></div></div></div><h2 id=server>Server</h2><h3 id=use-default-express-error-handlers>Use Default Express Error Handlers</h3><p>In my code, I added a <code>try...catch</code> block to each route handler. This can be good practice, but it is also inefficient. I have since removed all of them and switched to using this global error handler at the very end of my <code>app.js</code> code:</p><div class=tab-panel data-tab-group=79fa97abf02b80d83c3bc14df0d745c8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=serverappjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("79fa97abf02b80d83c3bc14df0d745c8","serverappjs")'>
<span class=tab-nav-text>server/app.js</span></button></div><div class=tab-content-container><div data-tab-item=serverappjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// Default Error Handler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>((</span><span class=nx>err</span><span class=p>,</span> <span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// If error already sent, disregard
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>headersSent</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>next</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Handle Validation Errors
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>if</span> <span class=p>(</span><span class=nx>err</span> <span class=k>instanceof</span> <span class=nx>ValidationError</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>handleValidationError</span><span class=p>(</span><span class=nx>err</span><span class=p>,</span> <span class=nx>res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>logger</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>status</span><span class=p>(</span><span class=mi>500</span><span class=p>).</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>});</span></span></span></code></pre></div></div></div></div></div><p>This greatly shortens and simplifies the code for each route, and makes coverage testing a bit more straightforward (since each route no longer has an error path that cannot be easily tested)</p><footer class=footline></footer></article></div></main></div></div><script src=/cis526/js/clipboard.min.js?1750005760 defer></script><script src=/cis526/js/perfect-scrollbar.min.js?1750005760 defer></script><script src=/cis526/js/theme.js?1750005760 defer></script><script src=/cis526/js/tele-scroll.js?1750005760 defer></script></body></html>