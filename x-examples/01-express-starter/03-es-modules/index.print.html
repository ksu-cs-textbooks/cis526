<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.148.1"><meta name=generator content="Relearn 8.0.0"><meta name=description content="YouTube Video CommonJS vs ES Modules By default, the Express application generator creates an application using the CommonJS module format. This is the original way that JavaScript modules were packaged. However, many libraries and frameworks have been moving to the new ECMAScript module format (commonly referred to as ES modules), which is current official standard way of packaging JavaScript modules.
Since we want to build an industry-grade application, it would be best to update our application to use the new ES module format. This format will become more and more common over time, and many dependencies on npm have already started to shift to only supporting the ES module format. So, let’s take the time now to update our application to use that new format before we go any further."><meta name=author content="Nathan Bean & Russell Feldhausen"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta name=twitter:title content="Convert to ES Modules :: CIS 526 Textbook"><meta name=twitter:description content="YouTube Video CommonJS vs ES Modules By default, the Express application generator creates an application using the CommonJS module format. This is the original way that JavaScript modules were packaged. However, many libraries and frameworks have been moving to the new ECMAScript module format (commonly referred to as ES modules), which is current official standard way of packaging JavaScript modules.
Since we want to build an industry-grade application, it would be best to update our application to use the new ES module format. This format will become more and more common over time, and many dependencies on npm have already started to shift to only supporting the ES module format. So, let’s take the time now to update our application to use that new format before we go any further."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/01-express-starter/03-es-modules/index.html"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Convert to ES Modules :: CIS 526 Textbook"><meta property="og:description" content="YouTube Video CommonJS vs ES Modules By default, the Express application generator creates an application using the CommonJS module format. This is the original way that JavaScript modules were packaged. However, many libraries and frameworks have been moving to the new ECMAScript module format (commonly referred to as ES modules), which is current official standard way of packaging JavaScript modules.
Since we want to build an industry-grade application, it would be best to update our application to use the new ES module format. This format will become more and more common over time, and many dependencies on npm have already started to shift to only supporting the ES module format. So, let’s take the time now to update our application to use that new format before we go any further."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-03-06T15:49:16-06:00"><meta property="og:image" content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><meta itemprop=name content="Convert to ES Modules :: CIS 526 Textbook"><meta itemprop=description content="YouTube Video CommonJS vs ES Modules By default, the Express application generator creates an application using the CommonJS module format. This is the original way that JavaScript modules were packaged. However, many libraries and frameworks have been moving to the new ECMAScript module format (commonly referred to as ES modules), which is current official standard way of packaging JavaScript modules.
Since we want to build an industry-grade application, it would be best to update our application to use the new ES module format. This format will become more and more common over time, and many dependencies on npm have already started to shift to only supporting the ES module format. So, let’s take the time now to update our application to use that new format before we go any further."><meta itemprop=dateModified content="2025-03-06T15:49:16-06:00"><meta itemprop=wordCount content="752"><meta itemprop=image content="https://textbooks.cs.ksu.edu/cis526/images/hero.png"><title>Convert to ES Modules :: CIS 526 Textbook</title><link href=https://textbooks.cs.ksu.edu/cis526/x-examples/01-express-starter/03-es-modules/index.html rel=canonical type=text/html title="Convert to ES Modules :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/03-es-modules/index.xml rel=alternate type=application/rss+xml title="Convert to ES Modules :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/03-es-modules/tele.html rel=alternate type=text/html title="Convert to ES Modules :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/03-es-modules/embed.html rel=alternate type=text/html title="Convert to ES Modules :: CIS 526 Textbook"><link href=/cis526/css/auto-complete/auto-complete.min.css?1755561291 rel=stylesheet><script src=/cis526/js/auto-complete/auto-complete.min.js?1755561291 defer></script><script src=/cis526/js/search-lunr.min.js?1755561291 defer></script><script src=/cis526/js/search.min.js?1755561291 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/cis526/searchindex.en.js?1755561291"</script><script src=/cis526/js/lunr/lunr.min.js?1755561291 defer></script><script src=/cis526/js/lunr/lunr.stemmer.support.min.js?1755561291 defer></script><script src=/cis526/js/lunr/lunr.multi.min.js?1755561291 defer></script><script src=/cis526/js/lunr/lunr.en.min.js?1755561291 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1755561291 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/fonts/fontawesome/css/fontawesome-all.min.css?1755561291 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar/perfect-scrollbar.min.css?1755561291 rel=stylesheet><link href=/cis526/css/theme.min.css?1755561291 rel=stylesheet><link href=/cis526/css/format-print.min.css?1755561291 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/x-examples/01-express-starter/03-es-modules/index.html",window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!1,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["light-theme"],window.relearn.customvariantname="my-custom-variant",window.relearn.writeVariant=!1,window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.writeVariant&&window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><link href=/cis526/css/custom.css?1755561291 rel=stylesheet></head><body class="mobile-support embed print" data-url=/cis526/x-examples/01-express-starter/03-es-modules/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><div id=R-main-overlay></div><main id=R-body-inner class="highlightable x-examples" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=convert-to-es-modules>Convert to ES Modules</h1><a href="https://www.youtube.com/watch?v=6dDn8qBPTgs">YouTube Video</a><h2 id=commonjs-vs-es-modules>CommonJS vs ES Modules</h2><p>By default, the Express application generator creates an application using the <a href=https://nodejs.org/api/modules.html#modules-commonjs-modules rel=external target=_blank>CommonJS module format</a>. This is the original way that JavaScript modules were packaged. However, many libraries and frameworks have been moving to the new <a href=https://nodejs.org/api/esm.html rel=external target=_blank>ECMAScript module format</a> (commonly referred to as ES modules), which is current official standard way of packaging JavaScript modules.</p><p>Since we want to build an industry-grade application, it would be best to update our application to use the new ES module format. This format will become more and more common over time, and many dependencies on npm have already started to shift to only supporting the ES module format. So, let&rsquo;s take the time now to update our application to use that new format before we go any further.</p><h2 id=enabling-es-module-support>Enabling ES Module Support</h2><p>To enable ES module support in our application, we must simply add <code>"type": "module",</code> to the <code>package.json</code> file:</p><div class=tab-panel data-tab-group=b9ec35ef95b7c8d0ba680a976178fdc5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=packagejson class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b9ec35ef95b7c8d0ba680a976178fdc5","packagejson")'>
<span class=tab-nav-text>package.json</span></button></div><div class=tab-content-container><div data-tab-item=packagejson class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;example-project&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.0.1&#34;</span>,
</span></span><span style=display:flex;background-color:#3c3d38><span>  <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;module&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;private&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;start&#34;</span>: <span style=color:#e6db74>&#34;node ./bin/www&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;cookie-parser&#34;</span>: <span style=color:#e6db74>&#34;~1.4.7&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;debug&#34;</span>: <span style=color:#e6db74>&#34;~4.4.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;express&#34;</span>: <span style=color:#e6db74>&#34;~4.21.2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;morgan&#34;</span>: <span style=color:#e6db74>&#34;~1.10.0&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div></div></div><p>Now, let&rsquo;s try to run our application:</p><div class=tab-panel data-tab-group=dd6905d5ee5892c97091341bf5299a19><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("dd6905d5ee5892c97091341bf5299a19","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ npm start</span></span></code></pre></div></div></div></div></div><p>When we do, we&rsquo;ll get some errors:</p><div class=tab-panel data-tab-group=2f40560e7178cccd04e195b9543e98ea><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("2f40560e7178cccd04e195b9543e98ea","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0><code>&gt; example-project@0.0.1 start
&gt; node ./bin/www

file:///workspaces/example-project/server/bin/www:7
var app = require(&#39;../app&#39;);
          ^

ReferenceError: require is not defined in ES module scope, you can use import instead
    at file:///workspaces/example-project/server/bin/www:7:11
    at ModuleJob.run (node:internal/modules/esm/module_job:271:25)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:547:26)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:116:5)

Node.js v22.12.0</code></pre></div></div></div></div></div><p>By changing that one line in <code>package.json</code>, the Node.js runtime is trying to load our project using ES modules instead of CommonJS modules, and it causes all sorts of errors. Thankfully, most of them are easy to fix! In most cases, we are simply making two updates:</p><ol><li>Replacing <code>require</code> statements with <code>import</code> statements</li><li>Replacing <code>module.exports</code> statements with <code>export default</code> statements.</li></ol><p>Let&rsquo;s go file by file and make these updates. We&rsquo;ll only show the lines that are commented out and their replacements directly below - you&rsquo;ll need to look carefully at each file, find the commented line, and replace it with the new line.</p><ul><li><code>bin/www</code></li></ul><div class=tab-panel data-tab-group=5cb24351bd86ba3a4e0bceaf765b3e11><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=binwww class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5cb24351bd86ba3a4e0bceaf765b3e11","binwww")'>
<span class=tab-nav-text>bin/www</span></button></div><div class=tab-content-container><div data-tab-item=binwww class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// var app = require(&#39;../app&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>app</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;../app.js&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var debug = require(&#39;debug&#39;)(&#39;server:server&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>debugLibrary</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;debug&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>debug</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>debugLibrary</span>(<span style=color:#e6db74>&#39;server:server&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var http = require(&#39;http&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>http</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;http&#39;</span>;</span></span></code></pre></div></div></div></div></div><ul><li><code>app.js</code></li></ul><div class=tab-panel data-tab-group=9b5ea3f284c1a006eaf058512e7f14c5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=appjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9b5ea3f284c1a006eaf058512e7f14c5","appjs")'>
<span class=tab-nav-text>app.js</span></button></div><div class=tab-content-container><div data-tab-item=appjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// var express = require(&#39;express&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>express</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;express&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var path = require(&#39;path&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>path</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;path&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var cookieParser = require(&#39;cookie-parser&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>cookieParser</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;cookie-parser&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var logger = require(&#39;morgan&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>logger</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;morgan&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var indexRouter = require(&#39;./routes/index&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>indexRouter</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./routes/index.js&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var usersRouter = require(&#39;./routes/users&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>usersRouter</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./routes/users.js&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>//module.exports = app;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>app</span>;</span></span></code></pre></div></div></div></div></div><ul><li><code>routes/index.js</code> and <code>routes/users.js</code></li></ul><div class=tab-panel data-tab-group=e5fd74fad8e307c0b8f2f2d7c7677d14><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=routesindexjs-amp-routesusersjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("e5fd74fad8e307c0b8f2f2d7c7677d14","routesindexjs-amp-routesusersjs")'>
<span class=tab-nav-text>routes/index.js & routes/users.js</span></button></div><div class=tab-content-container><div data-tab-item=routesindexjs-amp-routesusersjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// var express = require(&#39;express&#39;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>express</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;express&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// var router = express.Router();
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>express</span>.<span style=color:#a6e22e>Router</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// -=-=- other code omitted here -=-=-
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// module.exports = router;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>router</span>;</span></span></code></pre></div></div></div></div></div><p>At this point, let&rsquo;s test our application again to see if we&rsquo;ve updated everything correctly:</p><div class=tab-panel data-tab-group=b9288c3680129612b743ea092e069e38><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("b9288c3680129612b743ea092e069e38","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ npm start</span></span></code></pre></div></div></div></div></div><p>Now, we should get an error message similar to this:</p><div class=tab-panel data-tab-group=08ea88b158b6f899f8557ad353907fd8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("08ea88b158b6f899f8557ad353907fd8","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0><code>file:///workspaces/example-project/server/app.js:25
app.use(express.static(path.join(__dirname, &#39;public&#39;)));
                                 ^

ReferenceError: __dirname is not defined in ES module scope
    at file:///workspaces/example-project/server/app.js:25:34
    at ModuleJob.run (node:internal/modules/esm/module_job:271:25)
    at async onImport.tracePromise.__proto__ (node:internal/modules/esm/loader:547:26)
    at async asyncRunEntryPointWithESMLoader (node:internal/modules/run_main:116:5)

Node.js v22.12.0</code></pre></div></div></div></div></div><p>This is a bit trickier to debug, but a quick Google search usually leads to the correct answer. In this case, the <code>__dirname</code> variable is a global variable that is defined when Node.js is running a CommonJS module, as discussed in the <a href=https://nodejs.org/docs/latest/api/modules.html#__dirname rel=external target=_blank>documentation</a>. However, when Node.js is running an ES module, many of these global variables have been relocated to the <code>import.meta</code> property, as shown in the <a href=https://nodejs.org/api/esm.html#importmetadirname rel=external target=_blank>documentation</a>. So, we can just replace <code>__dirname</code> with the <code>import.meta.dirname</code> variable in <code>app.js</code>:</p><div class=tab-panel data-tab-group=df59855af61ef4b5a00dbb18634e69ca><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=appjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("df59855af61ef4b5a00dbb18634e69ca","appjs")'>
<span class=tab-nav-text>app.js</span></button></div><div class=tab-content-container><div data-tab-item=appjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>//app.use(express.static(path.join(__dirname, &#39;public&#39;)));
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>express</span>.<span style=color:#66d9ef>static</span>(<span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>join</span>(<span style=color:#66d9ef>import</span>.<span style=color:#a6e22e>meta</span>.<span style=color:#a6e22e>dirname</span>, <span style=color:#e6db74>&#39;public&#39;</span>)));</span></span></code></pre></div></div></div></div></div><p>Let&rsquo;s try to run our application again - it should be able to start this time:</p><div class=tab-panel data-tab-group=ebe1696e7d7efcf1d0fdf0c4831e27a0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("ebe1696e7d7efcf1d0fdf0c4831e27a0","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ npm start</span></span></code></pre></div></div></div></div></div><p>Updating a Node.js application to use ES modules is not terribly difficult, especially if it is done early in development. However, since we&rsquo;ve made this change, we&rsquo;ll have to be careful as we continue to develop our application. Many online tutorials, documentation, and references assume that any Node.js and Express application is still using CommonJS modules, so we may have to translate any code we find to match our new ES module setup.</p><p>This is a good point to <strong>commit and push</strong> our work!</p><h2 id=references>References</h2><ul><li><a href=https://electerious.medium.com/from-commonjs-to-es-modules-how-to-modernize-your-node-js-app-ad8cdd4fb662 rel=external target=_blank>From CommonJS to ES Modules: How to modernize your Node.js app</a></li></ul><footer class=footline></footer></article></div></main></div><script src=/cis526/js/clipboard/clipboard.min.js?1755561291 defer></script><script src=/cis526/js/perfect-scrollbar/perfect-scrollbar.min.js?1755561291 defer></script><script src=/cis526/js/theme.min.js?1755561291 defer></script><script src=/cis526/js/embed-iframe.min.js?1755561291 defer></script></body></html>