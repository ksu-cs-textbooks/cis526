<!doctype html><html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.128.0"><meta name=generator content="Relearn 6.0.0"><meta name=description content="YouTube Video Environment Variables As discussed earlier, an environment variable is a value present in memory in the operating system environment where a process is running. They contain important information about the system where the application is running, but they can also be configured by the user or system administrator to provide information and configuration to any processes running in that environment. This is especially used when working with containers like the dev container we built for this project."><meta name=author content="Nathan Bean"><meta name=twitter:card content="summary"><meta name=twitter:title content="Environment :: CIS 526 Textbook"><meta name=twitter:description content="YouTube Video Environment Variables As discussed earlier, an environment variable is a value present in memory in the operating system environment where a process is running. They contain important information about the system where the application is running, but they can also be configured by the user or system administrator to provide information and configuration to any processes running in that environment. This is especially used when working with containers like the dev container we built for this project."><meta property="og:url" content="https://textbooks.cs.ksu.edu/cis526/x-examples/01-express-starter/07-environment/"><meta property="og:site_name" content="CIS 526 Textbook"><meta property="og:title" content="Environment :: CIS 526 Textbook"><meta property="og:description" content="YouTube Video Environment Variables As discussed earlier, an environment variable is a value present in memory in the operating system environment where a process is running. They contain important information about the system where the application is running, but they can also be configured by the user or system administrator to provide information and configuration to any processes running in that environment. This is especially used when working with containers like the dev container we built for this project."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="Example Projects"><meta property="article:modified_time" content="2025-03-06T15:49:16-06:00"><meta itemprop=name content="Environment :: CIS 526 Textbook"><meta itemprop=description content="YouTube Video Environment Variables As discussed earlier, an environment variable is a value present in memory in the operating system environment where a process is running. They contain important information about the system where the application is running, but they can also be configured by the user or system administrator to provide information and configuration to any processes running in that environment. This is especially used when working with containers like the dev container we built for this project."><meta itemprop=dateModified content="2025-03-06T15:49:16-06:00"><meta itemprop=wordCount content="1483"><title>Environment :: CIS 526 Textbook</title>
<link href=https://textbooks.cs.ksu.edu/cis526/x-examples/01-express-starter/07-environment/ rel=canonical type=text/html title="Environment :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/07-environment/index.xml rel=alternate type=application/rss+xml title="Environment :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/07-environment/tele.html rel=alternate type=text/html title="Environment :: CIS 526 Textbook"><link href=/cis526/x-examples/01-express-starter/07-environment/embed.html rel=alternate type=text/html title="Environment :: CIS 526 Textbook"><link href=/cis526/css/fontawesome-all.min.css?1743777220 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fontawesome-all.min.css?1743777220 rel=stylesheet></noscript><link href=/cis526/css/nucleus.css?1743777220 rel=stylesheet><link href=/cis526/css/auto-complete.css?1743777220 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/auto-complete.css?1743777220 rel=stylesheet></noscript><link href=/cis526/css/perfect-scrollbar.min.css?1743777220 rel=stylesheet><link href=/cis526/css/fonts.css?1743777220 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/cis526/css/fonts.css?1743777220 rel=stylesheet></noscript><link href=/cis526/css/theme.css?1743777220 rel=stylesheet><link href=/cis526/css/theme-auto.css?1743777220 rel=stylesheet id=R-variant-style><link href=/cis526/css/chroma-auto.css?1743777220 rel=stylesheet id=R-variant-chroma-style><link href=/cis526/css/variant.css?1743777220 rel=stylesheet><link href=/cis526/css/print.css?1743777220 rel=stylesheet media=print><link href=/cis526/css/format-print.css?1743777220 rel=stylesheet><script src=/cis526/js/variant.js?1743777220></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../..",window.relearn.relBaseUri="../../../..",window.relearn.absBaseUri="https://textbooks.cs.ksu.edu/cis526",window.index_js_url="/cis526/index.search.js",window.variants&&variants.init(["auto","light-theme","dark-theme"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><link href=/cis526/css/custom.css?1743777220 rel=stylesheet></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/cis526/x-examples/01-express-starter/07-environment/><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis526/x-examples/><span itemprop=name>Example Projects</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/cis526/x-examples/01-express-starter/><span itemprop=name>Express Starter Project</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Environment</span><meta itemprop=position content="3"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/01-express-starter/06-other-libraries/ title="Other Libraries (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/cis526/x-examples/01-express-starter/08-open-api/ title="OpenAPI Documentation (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=environment>Environment</h1><a href="https://www.youtube.com/watch?v=RwurcrpXW7g">YouTube Video</a><h2 id=environment-variables>Environment Variables</h2><p>As discussed earlier, an <a href=https://en.wikipedia.org/wiki/Environment_variable rel=external target=_blank><strong>environment variable</strong></a> is a value present in memory in the operating system environment where a process is running. They contain important information about the system where the application is running, but they can also be configured by the user or system administrator to provide information and configuration to any processes running in that environment. This is especially used when working with <strong>containers</strong> like the dev container we built for this project.</p><p>To explore this, we can use the <code>printenv</code> command in any Linux terminal:</p><div class=tab-panel data-tab-group=fa0b72c813faee48263c9dc252289d3d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("fa0b72c813faee48263c9dc252289d3d","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ printenv</span></span></code></pre></div></div></div></div></div><p>When we run that command in our GitHub codespace, we&rsquo;ll see output containing lines similar to this (many lines have been omitted as they contain secure information):</p><div class=tab-panel data-tab-group=8fa6e82ccb5e91fe8d77e923e90f3dcd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8fa6e82ccb5e91fe8d77e923e90f3dcd","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>SHELL=/bin/bash
GITHUB_USER=russfeld
CODESPACE_NAME=laughing-computing-machine-jj5j9p97vx435jqj
HOSTNAME=codespaces-f1a983
RepositoryName=example-project
CODESPACES=true
YARN_VERSION=1.22.22
PWD=/workspaces/example-project/server
ContainerVersion=13
GITHUB_CODESPACES_PORT_FORWARDING_DOMAIN=app.github.dev
USER=node
NODE_VERSION=22.12.0
OLDPWD=/workspaces/example-project
TERM_PROGRAM=vscode</code></pre></div></div></div></div></div><p>As we can see, the environment contains many useful variables, including a <code>CODESPACES</code> variable showing that the application is running in GitHub Codespaces. We can also find our <code>GITHUB_USER</code>, <code>CODESPACE_NAME</code> and even the <code>NODE_VERSION</code> all in the environment.</p><h2 id=configuring-the-environment>Configuring the Environment</h2><p>Because many web applications eventually run in a containerized environment anyway, it is very common practice to configure those applications through the use of environment variables. Thankfully, we can more easily control and configure our application through the use of a special library <a href=https://dotenvx.com/ rel=external target=_blank>dotenvx</a> that allows us to load a set of environment variables from a file named <code>.env</code>.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> dotenv</div><div class=box-content><p>The <code>dotenvx</code> library is a newer version of the <a href=https://www.npmjs.com/package/dotenv rel=external target=_blank>dotenv</a> library that has been used for this purpose for many years. <code>dotenvx</code> was developed by the same developer, and is often recommended as a new, modern replacement to <code>dotenv</code> for most users. It includes features that allow us to create multiple environments and even encrypt values. So, for this project we&rsquo;ll use the newer library to take advantage of some of those features.</p></div></div><p>To begin, let&rsquo;s install <code>dotenvx</code> using <code>npm</code>:</p><div class=tab-panel data-tab-group=70e29a6dcd41864571ad27e2a8f7ae6f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("70e29a6dcd41864571ad27e2a8f7ae6f","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ npm install @dotenvx/dotenvx</span></span></code></pre></div></div></div></div></div><p>Next, we&rsquo;ll need to import that library as early as possible in our application, since we want to make sure that the environment is properly loaded before any other configuration files are referenced, since they may require environment variables to work properly. In this case, we want to do that as the very first thing in <code>app.js</code>:</p><div class=tab-panel data-tab-group=5e79b9b6b683edc6b8c2038fff1596cf><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=appjs class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5e79b9b6b683edc6b8c2038fff1596cf","appjs")'>
<span class=tab-nav-text>app.js</span></button></div><div class=tab-content-container><div data-tab-item=appjs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class="line hl"><span class=cl><span class=kr>import</span> <span class=s1>&#39;@dotenvx/dotenvx/config&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>express</span> <span class=nx>from</span> <span class=s1>&#39;express&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>path</span> <span class=nx>from</span> <span class=s1>&#39;path&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>cookieParser</span> <span class=nx>from</span> <span class=s1>&#39;cookie-parser&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>compression</span> <span class=nx>from</span> <span class=s1>&#39;compression&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>helmet</span> <span class=nx>from</span> <span class=s1>&#39;helmet&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>requestLogger</span> <span class=nx>from</span> <span class=s1>&#39;./middlewares/request-logger.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// -=-=- other code omitted here -=-=-
</span></span></span></code></pre></div></div></div></div></div><p>Now, when we run our application, we should get a helpful message letting us know that our environment file is missing:</p><div class=tab-panel data-tab-group=bdb54683d254e99258cd17f6f13afec5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("bdb54683d254e99258cd17f6f13afec5","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>&gt; example-project@0.0.1 dev
&gt; LOG_LEVEL=debug nodemon ./bin/www

[nodemon] 3.1.9
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,cjs,json
[nodemon] starting `node ./bin/www`
[MISSING_ENV_FILE] missing .env file (/workspaces/example-project/server/.env)
[MISSING_ENV_FILE] https://github.com/dotenvx/dotenvx/issues/484
[dotenvx@1.34.0] injecting env (0)
[2025-01-25 08:15:56.135 PM] info:      Listening on port 3000</code></pre></div></div></div></div></div><p>This is one of the many benefits that comes from using the newer <code>dotenvx</code> library - it will helpfully remind us when we are running without an environment file, just in case we forgot to create one.</p><p>So, now let&rsquo;s create the <code>.env</code> file in the <code>server</code> folder of our application, and add an environment variable to that file:</p><div class=tab-panel data-tab-group=940b153c69d98af3d1be7b24b557b214><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=env class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("940b153c69d98af3d1be7b24b557b214","env")'>
<span class=tab-nav-text>.env</span></button></div><div class=tab-content-container><div data-tab-item=env class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=nv>LOG_LEVEL</span><span class=o>=</span>error</span></span></code></pre></div></div></div></div></div><p>This should set the logging level of our application to <strong>error</strong>, meaning that only errors will be logged to the terminal. So, let&rsquo;s run our application and see what it does:</p><div class=tab-panel data-tab-group=aaf2629adbb10d64151f7ffb06229729><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=terminal class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("aaf2629adbb10d64151f7ffb06229729","terminal")'>
<span class=tab-nav-text>terminal</span></button></div><div class=tab-content-container><div data-tab-item=terminal class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ npm run dev</span></span></code></pre></div></div></div></div></div><p>However, when we do, we notice that we are still getting <strong>http</strong> logging in the output:</p><div class=tab-panel data-tab-group=4300d392b5f45349fbc8b6ec44d88535><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("4300d392b5f45349fbc8b6ec44d88535","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>&gt; example-project@0.0.1 dev
&gt; LOG_LEVEL=debug nodemon ./bin/www

[nodemon] 3.1.9
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,cjs,json
[nodemon] starting `node ./bin/www`
[dotenvx@1.34.0] injecting env (0) from .env
[2025-01-25 08:20:17.438 PM] info:      Listening on port 3000
[2025-01-25 08:23:56.896 PM] http:      GET / 304 3.405 ms -</code></pre></div></div></div></div></div><p>This is because we are already setting the <code>LOG_LEVEL</code> environment variable directly in our <code>package.json</code> file:</p><div class=tab-panel data-tab-group=0d13ecb1156a3393603464fca1f5eaee><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=packagejson class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("0d13ecb1156a3393603464fca1f5eaee","packagejson")'>
<span class=tab-nav-text>package.json</span></button></div><div class=tab-content-container><div data-tab-item=packagejson class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;example-project&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;0.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;module&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;private&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class="line hl"><span class=cl>    <span class=nt>&#34;start&#34;</span><span class=p>:</span> <span class=s2>&#34;LOG_LEVEL=http node ./bin/www&#34;</span><span class=p>,</span>
</span></span><span class="line hl"><span class=cl>    <span class=nt>&#34;dev&#34;</span><span class=p>:</span> <span class=s2>&#34;LOG_LEVEL=debug nodemon ./bin/www&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=err>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>This is actually a great feature! The <code>dotenvx</code> library will not override any existing environment variables - so, if the environment is already configured, or we want to override anything that may be present in our <code>.env</code> file, we can just set it in the environment before running our application, and those values will take precedence!</p><p>For now, let&rsquo;s go ahead and remove that variable from the <code>dev</code> script in our <code>package.json</code> file:</p><div class=tab-panel data-tab-group=3bd01b4d8bd865c9afd5d17425aa916f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=packagejson class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3bd01b4d8bd865c9afd5d17425aa916f","packagejson")'>
<span class=tab-nav-text>package.json</span></button></div><div class=tab-content-container><div data-tab-item=packagejson class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;example-project&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;0.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;module&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;private&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;scripts&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;start&#34;</span><span class=p>:</span> <span class=s2>&#34;LOG_LEVEL=http node ./bin/www&#34;</span><span class=p>,</span>
</span></span><span class="line hl"><span class=cl>    <span class=nt>&#34;dev&#34;</span><span class=p>:</span> <span class=s2>&#34;nodemon ./bin/www&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=err>...</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Now, when we run our program, we should not see any logging output (unless we can somehow cause the server to raise an error, which is unlikely right now):</p><div class=tab-panel data-tab-group=9e4f5e2165f06182265ad35409da51f2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9e4f5e2165f06182265ad35409da51f2","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>&gt; example-project@0.0.1 dev
&gt; nodemon ./bin/www

[nodemon] 3.1.9
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,cjs,json
[nodemon] starting `node ./bin/www`
[dotenvx@1.34.0] injecting env (1) from .env</code></pre></div></div></div></div></div><p>Finally, let&rsquo;s go ahead and set the value in our <code>.env</code> file back to the <code>debug</code> setting:</p><div class=tab-panel data-tab-group=9e980be5b33bcd67c9f4c5f596186969><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=env class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("9e980be5b33bcd67c9f4c5f596186969","env")'>
<span class=tab-nav-text>.env</span></button></div><div class=tab-content-container><div data-tab-item=env class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=nv>LOG_LEVEL</span><span class=o>=</span>debug</span></span></code></pre></div></div></div></div></div><p>Now, when we run our application, we can see that it is following that configuration:</p><div class=tab-panel data-tab-group=5b06fd491d9f53bc1811849b01f234f7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("5b06fd491d9f53bc1811849b01f234f7","output")'>
<span class=tab-nav-text>output</span></button></div><div class=tab-content-container><div data-tab-item=output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0><code>&gt; example-project@0.0.1 dev
&gt; nodemon ./bin/www

[nodemon] 3.1.9
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): *.*
[nodemon] watching extensions: js,mjs,cjs,json
[nodemon] starting `node ./bin/www`
[dotenvx@1.34.0] injecting env (1) from .env
[2025-01-25 08:28:54.587 PM] info:      Listening on port 3000
[2025-01-25 08:28:58.625 PM] http:      GET / 200 3.475 ms - -</code></pre></div></div></div></div></div><p>Great! We now have a powerful way to configure our application using a <code>.env</code> file.</p><h2 id=other-environment-variables>Other Environment Variables</h2><p>Right now, our program only uses one other environment variable, which can be found in the <code>bin/www</code> file:</p><div class=tab-panel data-tab-group=73dea1e42c48cff0f2253ebbf125f7af><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=binwww class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("73dea1e42c48cff0f2253ebbf125f7af","binwww")'>
<span class=tab-nav-text>bin/www</span></button></div><div class=tab-content-container><div data-tab-item=binwww class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=ch>#!/usr/bin/env node
</span></span></span><span class=line><span class=cl><span class=ch></span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>app</span> <span class=nx>from</span> <span class=s1>&#39;../app.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>logger</span> <span class=nx>from</span> <span class=s1>&#39;../configs/logger.js&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Get port from environment and store in Express.
</span></span></span><span class=line><span class=cl><span class=cm> */</span>
</span></span><span class="line hl"><span class=cl><span class=kd>var</span> <span class=nx>port</span> <span class=o>=</span> <span class=nx>normalizePort</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>PORT</span> <span class=o>||</span> <span class=s1>&#39;3000&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=s1>&#39;port&#39;</span><span class=p>,</span> <span class=nx>port</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// -=-=- other code omitted here -=-=-
</span></span></span></code></pre></div></div></div></div></div><p>The code <code>process.env.PORT || '3000'</code> is a commonly used shorthand in JavaScript to check for the presence of a variable. Basically, if <code>process.env.PORT</code> is set, then that code will resolve to that value. If not, then the or operator <code>||</code> will use the second option, which is the value <code>'3000'</code> that is just hard-coded into our application.</p><p>So, we can set that value explicitly in our <code>.env</code> file:</p><div class=tab-panel data-tab-group=14ea5401cfe1a28f6ae1a45756fcb0c3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=env class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("14ea5401cfe1a28f6ae1a45756fcb0c3","env")'>
<span class=tab-nav-text>.env</span></button></div><div class=tab-content-container><div data-tab-item=env class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=nv>LOG_LEVEL</span><span class=o>=</span>debug
</span></span><span class=line><span class=cl><span class=nv>PORT</span><span class=o>=</span><span class=m>3000</span></span></span></code></pre></div></div></div></div></div><p>In general, it is always good practice to explicitly list all configurable values in the <code>.env</code> file when developing an application, since it helps us keep track of them.</p><p>However, each value should also have a <strong>logical default value</strong> if no configuration is provided. Ideally, our application should be able to run correctly with minimal configuration, or it should at least provide clear errors to the user when a configuration value is not provided. For example, we can look back at the <code>level()</code> function in <code>configs/logger.js</code> to see that it will set the logging level to <code>http</code> if it cannot find an appropriate <code>LOG_LEVEL</code> environment variable.</p><h2 id=environment-variable-security>Environment Variable Security</h2><p>Storing the configuration for our application in a <code>.env</code> file is a great option, and it is even included as item 3 of the <a href=https://12factor.net/config rel=external target=_blank>twelve-factor methodology</a> for developing modern web applications.</p><p>Unfortunately, this can present one <strong>major security flaw</strong> - often, the information stored in the <code>.env</code> file is very sensitive, since it may include database passwords, encryption keys, and more. So, we want to make absolutely sure that our <code>.env</code> file is never committed to git or GitHub, and it should never be shared between developers.</p><p>We can enforce this by ensuring that our <code>.gitignore</code> file inside of our <code>server</code> folder includes a line that prevents us from accidentally committing the <code>.env</code> file. Thankfully, both the <code>.gitignore</code> produced by the Express application generator, as well as the one in the GitHub <a href=https://github.com/github/gitignore/blob/main/Node.gitignore rel=external target=_blank>gitignore</a> repository both already include that line.</p><p>Instead, it is common practice to create a second file called <code>.env.example</code> (or similar) that contains a list of all configurable environment variables, along with safe default values for each. So, for this application, we might create a <code>.env.example</code> file that looks like this:</p><div class=tab-panel data-tab-group=8f8671172dee8eedd0ac08ef2cc58501><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=envexample class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("8f8671172dee8eedd0ac08ef2cc58501","envexample")'>
<span class=tab-nav-text>.env.example</span></button></div><div class=tab-content-container><div data-tab-item=envexample class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-env data-lang=env><span class=line><span class=cl><span class=nv>LOG_LEVEL</span><span class=o>=</span>http
</span></span><span class=line><span class=cl><span class=nv>PORT</span><span class=o>=</span><span class=m>3000</span></span></span></code></pre></div></div></div></div></div><p>This file can safely be committed to git and stored in GitHub. When a new developer or user clones our project, they can easily copy the <code>.env.example</code> file to <code>.env</code> and update it to match their desired configuration.</p><p>As we continue to add environment variables to our <code>.env</code> file, we should also make sure the <code>.env.example</code> file is kept up to date.</p><p>This is a good point to <strong>commit and push</strong> our work, but be extra sure that our <code>.env</code> file <strong>DOES NOT</strong> get committed to git!</p><footer class=footline></footer></article></div></main><div class=git-footer><p class=theme-version-footer>6.0.0</p><p>Last modified by:
<i class='fas fa-user'></i> Russell Feldhausen
<i class='fas fa-calendar'></i> <a href=https://github.com/ksu-cs-textbooks/cis526/commit/ba3ec6041b56eecd5391e3895459e8a5445e45cc>Mar 6, 2025</a></p></div></div><script src=/cis526/js/clipboard.min.js?1743777220 defer></script><script src=/cis526/js/perfect-scrollbar.min.js?1743777220 defer></script><script src=/cis526/js/theme.js?1743777220 defer></script></body></html>