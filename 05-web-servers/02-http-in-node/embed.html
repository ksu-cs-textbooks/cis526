




	
	
		

	
	
		

	
	
		

	
	
		

	
	
		
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		

	
	
		
		
		

	
	
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		

	
	
		

	
	
		
		
		
		
		
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.101.0">
    <meta name="generator" content="Relearn 5.2.0+tip">
    <meta name="description" content="CIS 526 Textbook">
    <meta name="author" content="Nathan Bean">
    <title>HTTP in Node :: CIS 526 Textbook</title>
    <link href="https://ksu-cs-textbooks.github.io/cis526/05-web-servers/02-http-in-node/" rel="canonical" type="text/html" title="CIS 526 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis526/05-web-servers/02-http-in-node/index.xml" rel="alternate" type="application/rss+xml" title="CIS 526 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis526/05-web-servers/02-http-in-node/index.print.html" rel="alternate" type="text/html" title="CIS 526 Textbook">
    <link href="https://ksu-cs-textbooks.github.io/cis526/05-web-servers/02-http-in-node/tele.html" rel="alternate" type="text/html" title="CIS 526 Textbook">
    <!-- https://github.com/filamentgroup/loadCSS/blob/master/README.md#how-to-use -->
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/fontawesome-all.min.css?1679423977" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis526/css/fontawesome-all.min.css?1679423977" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/featherlight.min.css?1679423977" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis526/css/featherlight.min.css?1679423977" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/auto-complete.css?1679423977" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis526/css/auto-complete.css?1679423977" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/perfect-scrollbar.min.css?1679423977" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/nucleus.css?1679423977" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/fonts.css?1679423977" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="https://ksu-cs-textbooks.github.io/cis526/css/fonts.css?1679423977" rel="stylesheet"></noscript>
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/theme.css?1679423977" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/theme-light-theme.css?1679423977" rel="stylesheet" id="variant-style">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/ie.css?1679423977" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/variant.css?1679423977" rel="stylesheet">
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/print.css?1679423977" rel="stylesheet" media="print">
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/variant.js?1679423977"></script>
    <script>
      // hack to let hugo tell us how to get to the root when using relativeURLs, it needs to be called *url= for it to do its magic:
      // https://github.com/gohugoio/hugo/blob/145b3fcce35fbac25c7033c91c1b7ae6d1179da8/transform/urlreplacers/absurlreplacer.go#L72
      var index_url="https://ksu-cs-textbooks.github.io/cis526/index.json";
      var root_url="https://ksu-cs-textbooks.github.io/cis526/";
      var baseUri=root_url.replace(/\/$/, '');
      // translations
      window.T_Copy_to_clipboard = 'Copy to clipboard';
      window.T_Copied_to_clipboard = 'Copied to clipboard!';
      window.T_Copy_link_to_clipboard = 'Copy link to clipboard';
      window.T_Link_copied_to_clipboard = 'Copied link to clipboard!';
      // some further base stuff
      var baseUriFull='https:\/\/ksu-cs-textbooks.github.io\/cis526/';
      window.variants && variants.init( [ 'light-theme', 'dark-theme' ] );
    </script>
    
    <link href="https://ksu-cs-textbooks.github.io/cis526/css/custom.css?1679423977" rel="stylesheet">
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/jquery.min.js?1679423977" defer></script>

  </head>
  <body class="mobile-support embed disableInlineCopyToClipboard" data-url="https://ksu-cs-textbooks.github.io/cis526/05-web-servers/02-http-in-node/embed.html">
    <div id="body" class="default-animation">
      
      
      
      <main id="body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <div id="head-tags">
          </div>
          <article class="default">
    
    
    
<p>Node was written primarily to provide tools to develop web servers.  So it should come as no surprise that it supports HTTP through a built-in library, the 

<a href="https://nodejs.org/api/http.html" target="_blank" rel="noopener">http module</a>.  This module provides support for creating <em>both</em> web servers and web clients, as well as working with http requests and responses.  Let&rsquo;s start by examining the latter.</p>
<h2 id="node-http-request">Node HTTP Request</h2>
<p>Remember that a HTTP request is nothing more than a stream of text formatted according to the HTTP standards, as we discussed in 

<a href="https://ksu-cs-textbooks.github.io/cis526/02-http/03-request-format/">Chapter 2</a>.  Node makes this information easier to work with in your server code by parsing it into an object, an instance of 

<a href="https://nodejs.org/api/http.html#http_class_http_incomingmessage" target="_blank" rel="noopener">http.IncomingMessage</a>.  Its properties expose the data of the request, and include:</p>
<ul>
<li>

<a href="https://nodejs.org/api/http.html#http_message_headers" target="_blank" rel="noopener">message.headers</a> - the request headers as a JavaScript object, with the keys corresponding to the HTTP header key, and the values corresponding to the HTTP header values.</li>
<li>

<a href="https://nodejs.org/api/http.html#http_message_method" target="_blank" rel="noopener">message.method</a> - request method, i.e. <code>'GET'</code>, <code>'POST'</code>, <code>'PUT'</code>, <code>'PATCH'</code>, or <code>'DELETE'</code></li>
<li>

<a href="https://nodejs.org/api/http.html#http_message_url" target="_blank" rel="noopener">message.url</a> - the URL string provided through the request.  Note that this URL does not contain the protocol and host information (those were set during the connection opening process)</li>
</ul>
<p>You typically won&rsquo;t create an <code>http.IncomingMessage</code>, rather it will be provided to you by an instance of <code>http.Server</code>, which we&rsquo;ll talk about shortly.</p>
<h2 id="node-http-response">Node HTTP Response</h2>
<p>The HTTP response is also nothing more than a stream of text formatted according to the HTTP standards, as laid out in 

<a href="https://ksu-cs-textbooks.github.io/cis526/02-http/08-response-format/">Chapter 2</a>.  Node also wraps the response with an object, an instance of 

<a href="https://nodejs.org/api/http.html#http_class_http_serverresponse" target="_blank" rel="noopener">http.ServerResponse</a>.  However, this object is used to <em>build</em> the response (which is the primary job of a web server).  This process proceeds in several steps:</p>
<ol>
<li>Setting the status code &amp; message</li>
<li>Setting the headers</li>
<li>Setting the body</li>
<li>Setting the trailers</li>
<li>Sending the response</li>
</ol>
<p>Not all of these steps are required for all responses, with the exception of the sending of the response.  We&rsquo;ll discuss the process of generating a response in more detail later.  As with the <code>http.IncomingMessage</code>, you won&rsquo;t directly create <code>http.ServerResponse</code> objects, instead they will be created by an instance of <code>http.Server</code>, which we&rsquo;ll look at next.</p>
<h2 id="node-http-server">Node HTTP Server</h2>
<p>The 

<a href="https://nodejs.org/api/http.html#http_class_http_server" target="_blank" rel="noopener">http.Server</a> class embodies the basic operating core of a webserver, which you can build upon to create your own web server implementations.  Instances of <code>http.Server</code> are created with the factory method 

<a href="https://nodejs.org/api/http.html#http_http_createserver_options_requestlistener" target="_blank" rel="noopener">http.createServer()</a>.  This method takes two parameters, the first is an optional JavaScript object with options for the server, and the second (or first, if the <code>options</code> parameter is omitted) is a callback function to invoke every time the server receives a request.  As you might expect, the method returns the created <code>http.Server</code> instance.</p>
<p>The callback function always takes two parameters.  The first is an instance of <code>http.IncomingMessage</code> (often assigned to a variable named <code>req</code>) that represents the request the server has received, and the second is an instance of <code>http.ServerResponse</code> (often assigned to available named <code>res</code>) that represents the response the server will send back to the client, once you have set all its properties.  This callback is often called the <em>request handler</em>, for it decides what to do with incoming requests.  Each incoming request is handled <em>asynchronously</em>, much like any event.</p>
<p>Once the server has been created, it needs to be told to listen for incoming requests.  It will do so on a specific 

<a href="https://en.wikipedia.org/wiki/Port_%28computer_networking%29" target="_blank" rel="noopener">port</a>. This port is represented by a number between 0 and 65535.  You can think of your computer as an apartment complex, and each port number corresponding to an apartment number where a specific program &ldquo;lives&rdquo;.  Thus, to send a message to that particular program, you would address your letter to the apartment address using the apartment number.  In this analogy, the apartment address is the <em>host address</em>, i.e. the IP address of your computer, and the specific apartment is the <em>port</em>.  Certain port numbers are commonly used by specific applications or families of applications, i.e. web servers typically use port 80 for HTTP and port 443 for HTTPS connections.  However, when you are developing a webserver, you&rsquo;ll typically use a non-standard port, often an address 3000 and up.</p>
<p>Thus, to start your webserver running on port 3000, you would invoke [server.Listen()] with that port as the first argument.  An optional second argument is a callback function invoked once the server is up and running - it is usually used to log a message saying the server is running.</p>
<h3 id="an-example-server">An Example Server</h3>
<p>A quick example of a server that only responds with the message &ldquo;Hello web!&rdquo; would be:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">http</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;http&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">createServer</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">end</span>(<span style="color:#e6db74">&#34;Hello web!&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#ae81ff">3000</span>, () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Server listening at port 3000&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Once the server is running, you can visit 

<a href="http://localhost:3000" target="_blank" rel="noopener">http://localhost:3000</a> on the same computer to see the phrase &ldquo;Hello web!&rdquo; printed in your browser.</p>
<p>The <code>localhost</code> hostname is a special <em>loopback</em> host, which indicates instead of looking for a computer on the web, you&rsquo;re wanting to access the computer you&rsquo;re currently on.  The <code>:3000</code> specifies the browser should make the request to the non-standard port of <code>3000</code>.  If we instead used port <code>80</code>, we could omit the port in the URL, as by default the browser will use port <code>80</code> for http requests.</p>

            <footer class="footline">
            </footer>
          </article>
        </div>
      </main>
    </div>
    
    
    
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/clipboard.min.js?1679423977" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/perfect-scrollbar.min.js?1679423977" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/featherlight.min.js?1679423977" defer></script>
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/theme.js?1679423977" defer></script>
    
    <script src="https://ksu-cs-textbooks.github.io/cis526/js/embed-iframe.js?1679423977 defer"></script>
    
  </body>
</html>
